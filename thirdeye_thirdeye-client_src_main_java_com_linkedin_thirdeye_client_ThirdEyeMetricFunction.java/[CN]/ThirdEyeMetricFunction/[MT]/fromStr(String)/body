{
  Matcher matcher=METRIC_FUNCTION_AGG_REGEX.matcher(metricFunction);
  if (matcher.matches()) {
    String size=matcher.group(1);
    String unit=matcher.group(2).toUpperCase();
    String metrics=matcher.group(3);
    TimeGranularity timeGranularity=new TimeGranularity(Integer.valueOf(size),TimeUnit.valueOf(unit));
    List<String> expressionStrs=splitMetrics(metrics);
    return new ThirdEyeMetricFunction(timeGranularity,expressionStrs);
  }
 else {
    throw new IllegalArgumentException("Metric function must match pattern " + METRIC_FUNCTION_AGG_REGEX);
  }
}
