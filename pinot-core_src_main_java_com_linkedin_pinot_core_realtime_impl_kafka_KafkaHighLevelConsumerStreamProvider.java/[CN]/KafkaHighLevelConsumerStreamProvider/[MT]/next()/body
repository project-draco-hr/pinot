{
  if (kafkaIterator.hasNext()) {
    try {
      GenericRow row=decoder.decode(kafkaIterator.next().message());
      kafkaEventsConsumedCount.inc();
      globalKafkaEventsConsumedCount.inc();
      final long now=System.currentTimeMillis();
      final long currentCount=kafkaEventsConsumedCount.count();
      if (now - lastLogTime > 60000 || currentCount - lastCount >= 100000) {
        if (lastCount == 0) {
          INSTANCE_LOGGER.info("Consumed {} events from kafka",currentCount);
        }
 else {
          INSTANCE_LOGGER.info("Consumed {} events from kafka (rate:{}/s)",currentCount - lastCount,(float)(currentCount - lastCount) * 1000 / (now - lastLogTime));
        }
        lastCount=currentCount;
        lastLogTime=now;
      }
      return row;
    }
 catch (    Exception e) {
      INSTANCE_LOGGER.warn("Caught exception while consuming events",e);
      kafkaEventsFailedCount.inc();
      globalKafkaEventsFailedCount.inc();
    }
  }
  return null;
}
