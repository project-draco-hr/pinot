{
  if (mergeConfig == null) {
    mergeConfig=new AnomalyMergeConfig();
  }
  if (functionId == null) {
    throw new IllegalArgumentException("Function id can't be null");
  }
  List<RawAnomalyResultDTO> anomalies;
  if (!StringUtils.isEmpty(dimensions)) {
    anomalies=resultDAO.findAllByTimeFunctionIdAndDimensions(mergeConfig.getStartTime(),mergeConfig.getEndTime(),functionId,dimensions);
  }
 else {
    anomalies=resultDAO.findAllByTimeAndFunctionId(mergeConfig.getStartTime(),mergeConfig.getEndTime(),functionId);
  }
  return AnomalyTimeBasedSummarizer.mergeAnomalies(anomalies,mergeConfig.getMergeDuration(),mergeConfig.getSequentialAllowedGap());
}
