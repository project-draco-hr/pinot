{
  for (  Integer bucket : buckets) {
    int idx=seekBucket(buffer,bucket);
    buffer.clear();
    buffer.position(idx);
    int currentBucket;
    int[] currentDimensions=new int[targetDimensions.length];
    while (buffer.position() < buffer.limit()) {
      currentBucket=buffer.getInt();
      if (currentBucket != bucket) {
        break;
      }
      boolean dimensionsOk=true;
      for (int i=0; i < dimensionNames.size(); i++) {
        currentDimensions[i]=buffer.getInt();
        if (targetDimensions[i] != StarTreeConstants.STAR_VALUE && targetDimensions[i] != currentDimensions[i]) {
          dimensionsOk=false;
        }
      }
      buffer.getLong();
      for (int i=0; i < metricNames.size(); i++) {
        long metricValue=buffer.getLong();
        if (dimensionsOk) {
          sums[i]+=metricValue;
        }
      }
    }
  }
}
