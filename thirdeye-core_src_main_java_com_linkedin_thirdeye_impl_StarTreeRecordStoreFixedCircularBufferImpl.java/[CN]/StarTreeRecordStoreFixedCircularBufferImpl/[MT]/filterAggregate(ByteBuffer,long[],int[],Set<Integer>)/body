{
  buffer.clear();
  int[] currentDimensions=new int[targetDimensions.length];
  while (buffer.position() < buffer.limit()) {
    boolean bucketOk=buckets.contains(buffer.getInt());
    boolean dimensionsOk=true;
    for (int i=0; i < dimensionNames.size(); i++) {
      currentDimensions[i]=buffer.getInt();
      if (targetDimensions[i] != StarTreeConstants.STAR_VALUE && targetDimensions[i] != currentDimensions[i]) {
        dimensionsOk=false;
      }
    }
    buffer.getLong();
    for (int i=0; i < metricNames.size(); i++) {
      long metricValue=buffer.getLong();
      if (bucketOk && dimensionsOk) {
        sums[i]+=metricValue;
      }
    }
  }
}
