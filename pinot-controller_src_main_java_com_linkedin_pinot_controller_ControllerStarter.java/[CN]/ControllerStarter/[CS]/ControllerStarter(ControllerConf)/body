{
  config=conf;
  component=new Component();
  controllerRestApp=new ControllerRestApplication(config.getQueryConsole());
  helixResourceManager=new PinotHelixResourceManager(config);
  retentionManager=new RetentionManager(helixResourceManager,config.getRetentionControllerFrequencyInSeconds());
  _metricsRegistry=new MetricsRegistry();
  ValidationMetrics validationMetrics=new ValidationMetrics(_metricsRegistry);
  validationManager=new ValidationManager(validationMetrics,helixResourceManager,config);
  MetricsHelper.initializeMetrics(config.subset("pinot.controller.metrics"));
  MetricsHelper.registerMetricsRegistry(_metricsRegistry);
  _controllerMetrics=new ControllerMetrics(_metricsRegistry);
  _controllerMetrics.initializeGlobalMeters();
  realtimeSegmentsManager=new PinotRealtimeSegmentManager(helixResourceManager,_controllerMetrics);
}
