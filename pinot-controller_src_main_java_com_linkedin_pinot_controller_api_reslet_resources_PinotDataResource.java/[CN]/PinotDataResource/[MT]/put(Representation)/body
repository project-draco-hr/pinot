{
  StringRepresentation presentation=null;
  try {
    final DataResource resource=mapper.readValue(ByteStreams.toByteArray(entity.getStream()),DataResource.class);
    if (resource.isDataResourceUpdate()) {
      presentation=new StringRepresentation(manager.handleUpdateDataResource(resource).toJSON().toString());
    }
 else     if (resource.isDataResourceConfigUpdate()) {
      presentation=new StringRepresentation(manager.handleUpdateDataResourceConfig(resource).toJSON().toString());
    }
 else     if (resource.isBrokerResourceUpdate()) {
      presentation=new StringRepresentation(manager.handleUpdateBrokerResource(resource).toJSON().toString());
    }
 else     if (resource.isDataTableAdd()) {
      presentation=new StringRepresentation(manager.handleAddTableToDataResource(resource).toJSON().toString());
    }
 else     if (resource.isDataTableRemove()) {
      presentation=new StringRepresentation(manager.handleRemoveTableFromDataResource(resource).toJSON().toString());
    }
 else {
      throw new RuntimeException("Not an updated request");
    }
  }
 catch (  final Exception e) {
    presentation=exceptionToStringRepresentation(e);
    logger.error("Caught exception while processing put request",e);
    setStatus(Status.SERVER_ERROR_INTERNAL);
  }
  return presentation;
}
