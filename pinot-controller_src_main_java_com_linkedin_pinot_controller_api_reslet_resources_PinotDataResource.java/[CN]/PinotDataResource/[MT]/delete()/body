{
  StringRepresentation presentation=null;
  try {
    final String resourceName=(String)getRequest().getAttributes().get("resourceName");
    final String tableName=(String)getRequest().getAttributes().get("tableName");
    String resourceRealtimeName=BrokerRequestUtils.getRealtimeResourceNameForResource(resourceName);
    String offlineResourceName=BrokerRequestUtils.getOfflineResourceNameForResource(resourceName);
    if (tableName == null) {
      String respString="";
      if (ZKMetadataProvider.getOfflineResourceZKMetadata(manager.getPropertyStore(),offlineResourceName) != null) {
        PinotResourceManagerResponse offlineResp=manager.deleteResource(offlineResourceName);
        respString+=offlineResp.toJSON().toString() + "\n";
      }
      if (ZKMetadataProvider.getRealtimeResourceZKMetadata(manager.getPropertyStore(),resourceRealtimeName) != null) {
        PinotResourceManagerResponse realtimeResp=manager.deleteResource(resourceRealtimeName);
        respString+=realtimeResp.toJSON().toString() + "\n";
      }
      if (respString.length() < 1) {
        respString="No related resource found.\n";
      }
      presentation=new StringRepresentation(respString);
    }
 else {
      String respString="";
      if (ZKMetadataProvider.getOfflineResourceZKMetadata(manager.getPropertyStore(),offlineResourceName) != null) {
        PinotResourceManagerResponse offlineResp=manager.handleRemoveTableFromDataResource(createTableDeletionDataResource(resourceName,tableName,ResourceType.OFFLINE.toString()));
        respString+=offlineResp.toJSON().toString() + "\n";
      }
      if (ZKMetadataProvider.getRealtimeResourceZKMetadata(manager.getPropertyStore(),resourceRealtimeName) != null) {
        PinotResourceManagerResponse realtimeResp=manager.handleRemoveTableFromDataResource(createTableDeletionDataResource(resourceName,tableName,ResourceType.REALTIME.toString()));
        respString+=realtimeResp.toJSON().toString() + "\n";
      }
      if (respString.length() < 1) {
        respString="No related resource found.\n";
      }
      presentation=new StringRepresentation(respString);
    }
  }
 catch (  final Exception e) {
    presentation=exceptionToStringRepresentation(e);
    logger.error("Caught exception while processing delete request",e);
    setStatus(Status.SERVER_ERROR_INTERNAL);
  }
  return presentation;
}
