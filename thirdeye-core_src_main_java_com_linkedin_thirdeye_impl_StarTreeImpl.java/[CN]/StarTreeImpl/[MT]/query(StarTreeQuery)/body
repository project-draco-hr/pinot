{
  StarTreeNode node=find(root,query);
  if (node == null) {
    throw new IllegalArgumentException("No star tree node for query " + query);
  }
  int[] sums=node.getRecordStore().getMetricSums(query);
  StarTreeRecordImpl.Builder result=new StarTreeRecordImpl.Builder();
  result.setDimensionValues(query.getDimensionValues());
  int idx=0;
  for (  String metricName : config.getMetricNames()) {
    result.setMetricValue(metricName,sums[idx++]);
  }
  return result.build();
}
