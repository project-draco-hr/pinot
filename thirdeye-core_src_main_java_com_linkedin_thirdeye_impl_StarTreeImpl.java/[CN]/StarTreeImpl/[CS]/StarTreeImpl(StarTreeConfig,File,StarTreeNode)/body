{
  this.config=config;
  this.maxRecordStoreEntries=config.getMaxRecordStoreEntries();
  this.root=root;
  this.dataDir=dataDir;
  try {
    this.recordStoreFactory=(StarTreeRecordStoreFactory)Class.forName(config.getRecordStoreFactoryClass()).newInstance();
    this.recordStoreFactory.init(dataDir,config.getDimensionNames(),config.getMetricNames(),config.getMetricTypes(),config.getRecordStoreFactoryConfig());
  }
 catch (  Exception e) {
    throw new IllegalStateException(e);
  }
}
