{
  this.config=config;
  this.maxRecordStoreEntries=config.getSplit().getThreshold();
  this.root=root;
  this.dataDir=dataDir;
  this.metricSchema=MetricSchema.fromMetricSpecs(config.getMetrics());
  try {
    this.recordStoreFactory=(StarTreeRecordStoreFactory)Class.forName(config.getRecordStoreFactoryClass()).newInstance();
    this.recordStoreFactory.init(dataDir,config,config.getRecordStoreFactoryConfig());
  }
 catch (  Exception e) {
    throw new IllegalStateException(e);
  }
}
