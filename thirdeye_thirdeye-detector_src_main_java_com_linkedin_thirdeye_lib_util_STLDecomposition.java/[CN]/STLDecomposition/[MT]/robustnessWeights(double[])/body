{
  double[] absRemainder=new double[remainder.length];
  for (int i=0; i < remainder.length; i++) {
    absRemainder[i]=Math.abs(remainder[i]);
  }
  DescriptiveStatistics stats=new DescriptiveStatistics(absRemainder);
  double h=6 * stats.getPercentile(50);
  double[] robustness=new double[remainder.length];
  for (int i=0; i < remainder.length; i++) {
    robustness[i]=biSquareWeight(absRemainder[i] / h);
  }
  return robustness;
}
