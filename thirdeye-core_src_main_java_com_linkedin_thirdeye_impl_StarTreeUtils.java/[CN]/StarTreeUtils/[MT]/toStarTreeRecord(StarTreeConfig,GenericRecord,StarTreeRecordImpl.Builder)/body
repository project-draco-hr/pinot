{
  for (  String dimensionName : config.getDimensionNames()) {
    Object dimensionValue=record.get(dimensionName);
    if (dimensionValue == null) {
      throw new IllegalStateException("Record has no value for dimension " + dimensionName);
    }
    builder.setDimensionValue(dimensionName,dimensionValue.toString());
  }
  for (int i=0; i < config.getMetricNames().size(); i++) {
    String metricName=config.getMetricNames().get(i);
    Object metricValue=record.get(metricName);
    if (metricValue == null) {
      metricValue=0L;
    }
    builder.setMetricValue(metricName,((Number)metricValue).intValue());
    builder.setMetricType(metricName,config.getMetricTypes().get(i));
  }
  Object time=record.get(config.getTime().getColumnName());
  if (time == null) {
    throw new IllegalStateException("Record does not have time column " + config.getTime().getColumnName() + ": "+ record);
  }
  builder.setTime(((Number)time).longValue());
}
