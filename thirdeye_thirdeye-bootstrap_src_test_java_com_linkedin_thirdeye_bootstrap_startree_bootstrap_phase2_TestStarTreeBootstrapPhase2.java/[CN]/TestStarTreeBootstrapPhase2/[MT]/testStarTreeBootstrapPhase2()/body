{
  generateAndSerializeStarTree();
  String starTreeOutputPath=mapDriver.getConfiguration().get(StarTreeGenerationConstants.STAR_TREE_GEN_OUTPUT_PATH.toString());
  String collectionName=starTreeBootstrapConfig.getCollectionName();
  Path pathToTree=new Path(starTreeOutputPath + "/" + "tree.bin");
  FileSystem dfs=FileSystem.get(mapDriver.getConfiguration());
  InputStream is=dfs.open(pathToTree);
  StarTreeNode starTreeRootNode=StarTreePersistanceUtil.loadStarTree(is);
  List<Pair<BytesWritable,BytesWritable>> inputRecords=generateTestDataMapper(starTreeRootNode);
  mapDriver.addAll(inputRecords);
  List<Pair<BytesWritable,BytesWritable>> result=mapDriver.run();
  Assert.assertEquals(6,result.size());
  List<Pair<BytesWritable,List<BytesWritable>>> input=generateTestDataReducer(starTreeRootNode);
  reduceDriver.addAll(input);
  result=reduceDriver.run();
}
