{
  LOG.info("BEGIN\t{}: ONLINE -> OFFLINE",message.getPartitionId());
  String collection=message.getResourceName();
  StarTree starTree=starTreeManager.getStarTree(collection);
  if (starTree == null) {
    throw new IllegalStateException("No star tree for " + collection + " but was in ONLINE state");
  }
  int partitionId=Integer.valueOf(PartitionId.stripResourceId(message.getPartitionName()));
  Set<UUID> targetIds=getLeafIds(collection,partitionId,context);
  disableRecordStores(starTree.getRoot(),starTree.getConfig(),targetIds);
  LOG.info("END\t{}: ONLINE -> OFFLINE",message.getPartitionId());
}
