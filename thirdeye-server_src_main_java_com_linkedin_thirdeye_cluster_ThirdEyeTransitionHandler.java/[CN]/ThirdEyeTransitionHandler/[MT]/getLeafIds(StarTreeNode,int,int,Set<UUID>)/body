{
  if (node.isLeaf()) {
    if (partitionId == StarTreeUtils.getPartitionId(node.getId(),numPartitions)) {
      collector.add(node.getId());
    }
  }
 else {
    for (    StarTreeNode child : node.getChildren()) {
      getLeafIds(child,partitionId,numPartitions,collector);
    }
    getLeafIds(node.getOtherNode(),partitionId,numPartitions,collector);
    getLeafIds(node.getStarNode(),partitionId,numPartitions,collector);
  }
}
