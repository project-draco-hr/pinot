{
  Properties properties=System.getProperties();
  Configuration configuration=new Configuration();
  configuration.set("fs.default.name","");
  Object val=properties.get("fs.defaultFS");
  if (val != null) {
    configuration.set("fs.default.name",val.toString());
  }
  Path path=new Path(args[0]);
  FileSystem fs=FileSystem.get(configuration);
  if (fs.isDirectory(path)) {
    FileStatus[] listStatus=fs.listStatus(path);
    for (    FileStatus fileStatus : listStatus) {
      processFile(fileStatus.getPath());
    }
  }
 else {
    processFile(path);
  }
}
