{
  List<ThirdEyeTimeSeries> result=new ArrayList<ThirdEyeTimeSeries>(original.size());
  for (  Map.Entry<DimensionKey,MetricTimeSeries> entry : original.entrySet()) {
    MetricTimeSeries timeSeries=MetricTimeSeriesUtils.aggregate(entry.getValue(),timeWindow);
    List<Long> times=new ArrayList<Long>(timeSeries.getTimeWindowSet());
    Collections.sort(times);
    for (    String metricName : metricNames) {
      ThirdEyeTimeSeries resultPart=new ThirdEyeTimeSeries();
      resultPart.setDimensionValues(QueryUtils.convertDimensionKey(config.getDimensions(),entry.getKey()));
      resultPart.setLabel(metricName);
      for (      long time : times) {
        resultPart.addRecord(time,entry.getValue().get(time,metricName));
      }
      result.add(resultPart);
    }
  }
  return result;
}
