{
  lock.writeLock().lock();
  try {
    collections.clear();
    for (    IdealState idealState : idealStates) {
      collections.put(idealState.getResourceName(),idealState.getNumPartitions());
    }
    for (    String collection : starTrees.keySet()) {
      if (!collections.containsKey(collection)) {
        starTrees.remove(collection);
      }
    }
  }
  finally {
    lock.writeLock().unlock();
  }
}
