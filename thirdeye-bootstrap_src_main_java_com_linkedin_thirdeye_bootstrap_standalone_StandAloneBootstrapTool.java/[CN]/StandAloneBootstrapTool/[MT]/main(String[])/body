{
  if (args.length < 5) {
    throw new IllegalArgumentException("usage: collection config.json fileType outputDir inputFile ...");
  }
  String collection=args[0];
  String configJson=args[1];
  String fileType=args[2];
  String outputDir=args[3];
  String[] inputFiles=Arrays.copyOfRange(args,4,args.length);
  StarTreeConfig config=StarTreeConfig.fromJson(OBJECT_MAPPER.readTree(new File(configJson)));
  List<Iterable<StarTreeRecord>> recordStreams=new ArrayList<Iterable<StarTreeRecord>>();
  if ("avro".equals(fileType)) {
    for (    String inputFile : inputFiles) {
      recordStreams.add(new StarTreeRecordStreamAvroFileImpl(new File(inputFile),config.getDimensionNames(),config.getMetricNames(),config.getTimeColumnName()));
    }
  }
 else   if ("tsv".equals(fileType)) {
    for (    String inputFile : inputFiles) {
      recordStreams.add(new StarTreeRecordStreamTextStreamImpl(new FileInputStream(inputFile),config.getDimensionNames(),config.getMetricNames(),"\t"));
    }
  }
 else {
    throw new IllegalArgumentException("Invalid file type " + fileType);
  }
  new StandAloneBootstrapTool(collection,config,recordStreams,new File(outputDir)).run();
}
