{
  final IndexSegmentImpl heapSegment=(IndexSegmentImpl)ColumnarSegmentLoader.load(INDEX_DIR,ReadMode.heap);
  final IndexSegmentImpl mmapSegment=(IndexSegmentImpl)ColumnarSegmentLoader.load(INDEX_DIR,ReadMode.mmap);
  final Map<String,ColumnMetadata> metadataMap=((SegmentMetadataImpl)mmapSegment.getSegmentMetadata()).getColumnMetadataMap();
  for (  final String column : metadataMap.keySet()) {
    final DictionaryReader heapDictionary=heapSegment.getDictionaryFor(column);
    final DictionaryReader mmapDictionary=mmapSegment.getDictionaryFor(column);
    final Set<Object> uniques=uniqueEntries.get(column);
    final List<Object> list=Arrays.asList(uniques.toArray());
    Collections.shuffle(list);
    for (    final Object entry : list) {
      AssertJUnit.assertEquals(heapDictionary.indexOf(entry),mmapDictionary.indexOf(entry));
      if (!column.equals("pageKey")) {
        AssertJUnit.assertEquals(heapDictionary.indexOf(entry) < 0,false);
        AssertJUnit.assertEquals(mmapDictionary.indexOf(entry) < 0,false);
      }
    }
  }
}
