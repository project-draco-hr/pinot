{
  IntermediateResultsBlock resultBlock=new IntermediateResultsBlock(aggregationFunctions,mergedResults,true);
  List<ProcessingException> exceptions=null;
  long numDocsScanned=0;
  long totalRawDocs=0;
  for (int i=0; i < blocks.length; i++) {
    numDocsScanned+=blocks[i].getNumDocsScanned();
    totalRawDocs+=blocks[i].getTotalRawDocs();
    List<ProcessingException> blockExceptions=blocks[i].getExceptions();
    if (blockExceptions != null) {
      if (exceptions == null) {
        exceptions=blockExceptions;
      }
 else {
        exceptions.addAll(blockExceptions);
      }
    }
  }
  resultBlock.setNumDocsScanned(numDocsScanned);
  resultBlock.setTotalRawDocs(totalRawDocs);
  resultBlock.setExceptionsList(exceptions);
  trimToSize(_brokerRequest,resultBlock);
  return resultBlock;
}
