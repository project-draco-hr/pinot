{
  if (node.isLeaf()) {
    if (node.getRecordStore() == null) {
      throw new IllegalStateException("Node " + node.getId() + " does not have record store. Has tree been opened?");
    }
    stats.countRecords(node.getRecordStore().getRecordCountEstimate());
    stats.updateMinTime(node.getRecordStore().getMinTime());
    stats.updateMaxTime(node.getRecordStore().getMaxTime());
    stats.countNode();
    stats.countLeaf();
  }
 else {
    stats.countNode();
    for (    StarTreeNode child : node.getChildren()) {
      getStats(child,stats);
    }
    getStats(node.getOtherNode(),stats);
    getStats(node.getStarNode(),stats);
  }
}
