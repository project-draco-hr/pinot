{
  if (node.isLeaf()) {
    if (node.getRecordStore() != null) {
      node.getRecordStore().close();
    }
 else {
      throw new IllegalStateException("Cannot close null record store for leaf node " + node.getId());
    }
  }
 else {
    for (    StarTreeNode child : node.getChildren()) {
      close(child);
    }
    close(node.getOtherNode());
    close(node.getStarNode());
  }
}
