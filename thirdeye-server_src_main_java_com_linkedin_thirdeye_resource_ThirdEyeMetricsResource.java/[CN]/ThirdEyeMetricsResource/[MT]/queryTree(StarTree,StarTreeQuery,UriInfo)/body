{
  List<StarTreeQuery> queries=StarTreeUtils.expandQueries(starTree,baseQuery);
  queries=StarTreeUtils.filterQueries(queries,uriInfo.getQueryParameters());
  List<ThirdEyeMetrics> metricsResults=new ArrayList<ThirdEyeMetrics>();
  for (  StarTreeQuery query : queries) {
    StarTreeRecord record=starTree.getAggregate(query);
    ThirdEyeMetrics result=new ThirdEyeMetrics();
    result.setDimensionValues(record.getDimensionValues());
    result.setMetricValues(record.getMetricValues());
    metricsResults.add(result);
  }
  return metricsResults;
}
