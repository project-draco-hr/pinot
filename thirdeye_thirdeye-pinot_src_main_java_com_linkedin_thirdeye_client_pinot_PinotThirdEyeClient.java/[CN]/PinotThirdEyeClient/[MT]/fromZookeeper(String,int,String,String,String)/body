{
  ZkClient zkClient=new ZkClient(zkUrl);
  zkClient.setZkSerializer(new ZNRecordSerializer());
  zkClient.waitUntilConnected();
  ZKHelixAdmin helixAdmin=new ZKHelixAdmin(zkClient);
  List<String> thirdeyeBrokerList=helixAdmin.getInstancesInClusterWithTag(clusterName,tag);
  LOG.info("Found brokers:{} with tag:{}",thirdeyeBrokerList,tag);
  if (thirdeyeBrokerList.size() == 0) {
    throw new RuntimeException("No brokers available with tag:" + tag);
  }
  String[] thirdeyeBrokers=new String[thirdeyeBrokerList.size()];
  for (int i=0; i < thirdeyeBrokerList.size(); i++) {
    String instanceName=thirdeyeBrokerList.get(i);
    InstanceConfig instanceConfig=helixAdmin.getInstanceConfig(clusterName,instanceName);
    thirdeyeBrokers[i]=instanceConfig.getHostName().replaceAll(BROKER_PREFIX,"") + ":" + instanceConfig.getPort();
  }
  LOG.info("Created PinotThirdEyeClient to zookeeper: {}",zkUrl);
  return new PinotThirdEyeClient(controllerHost,controllerPort);
}
