{
  Map<String,ThirdEyeKafkaStats> stats=kafkaConsumerManager.getStats();
  StringBuilder errorMessage=new StringBuilder();
  for (  Map.Entry<String,ThirdEyeKafkaStats> entry : stats.entrySet()) {
    long currentTimeMillis=System.currentTimeMillis();
    long dataTimeMillis=entry.getValue().getDataTimeMillis().get();
    if (currentTimeMillis - dataTimeMillis > MINIMUM_ACCEPTABLE_DATA_LAG_MILLIS) {
      errorMessage.append("collection=").append(entry.getKey()).append(" currentTimeMillis=").append(currentTimeMillis).append(" dataTimeMillis=").append(dataTimeMillis).append(" difference of ").append(currentTimeMillis - dataTimeMillis).append(" is greater than acceptable data lag of ").append(MINIMUM_ACCEPTABLE_DATA_LAG_MILLIS).append("\n");
    }
  }
  if (errorMessage.length() > 0) {
    return Result.unhealthy(errorMessage.toString());
  }
  return Result.healthy();
}
