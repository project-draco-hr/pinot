{
  IntraPeriod intraPeriod=ViewUtils.getIntraPeriod(metricFunction);
  List<FunnelTable> funnelViews=new ArrayList<FunnelTable>();
  boolean defaultFunnelSelected=false;
  if (selectedFunnels != null && selectedFunnels.length() > 0) {
    String[] funnels=selectedFunnels.split(",");
    if (funnels.length == 0) {
      return null;
    }
    for (    String funnel : funnels) {
      if (DEFAULT_FUNNEL_NAME.equals(funnel)) {
        defaultFunnelSelected=true;
      }
      LOG.info("adding funnel views for collection, {}, with funnel name {}",collection,funnel);
      FunnelSpec spec=funnelSpecsMap.get(collection).getFunnels().get(funnel);
      funnelViews.add(getFunnelDataFor(collection,metricFunction,spec,baselineMillis,currentMillis,intraPeriod,dimensionValues));
    }
  }
  if (!defaultFunnelSelected) {
    LOG.info("adding primary funnel views for collection, {}",collection);
    FunnelSpec defaultSpec=funnelSpecsMap.get(collection).getFunnels().get(DEFAULT_FUNNEL_NAME);
    funnelViews.add(getFunnelDataFor(collection,metricFunction,defaultSpec,baselineMillis,currentMillis,intraPeriod,dimensionValues));
  }
  return funnelViews;
}
