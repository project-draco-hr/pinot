{
  int maxGroupKeys=1;
  for (  String column : groupBy.getColumns()) {
    DataSource dataSource=indexSegment.getDataSource(column);
    DataSourceMetadata dataSourceMetadata=dataSource.getDataSourceMetadata();
    if (!dataSourceMetadata.isSingleValue()) {
      return Integer.MAX_VALUE;
    }
    int cardinality=dataSourceMetadata.cardinality();
    if (cardinality <= 0) {
      LOGGER.error("Zero/Negative cardinality for column {} in segment {}",column,indexSegment.getSegmentName());
      cardinality=1;
    }
    if (maxGroupKeys > (Integer.MAX_VALUE / cardinality)) {
      return Integer.MAX_VALUE;
    }
    maxGroupKeys*=cardinality;
  }
  return maxGroupKeys;
}
