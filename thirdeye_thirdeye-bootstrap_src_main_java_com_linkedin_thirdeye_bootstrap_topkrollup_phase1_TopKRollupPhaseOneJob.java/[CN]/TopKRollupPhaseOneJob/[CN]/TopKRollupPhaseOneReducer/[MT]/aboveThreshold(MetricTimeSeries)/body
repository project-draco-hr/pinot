{
  Map<String,Long> metricValues=new HashMap<String,Long>();
  for (  MetricSpec metricSpec : starTreeConfig.getMetrics()) {
    metricValues.put(metricSpec.getName(),0L);
  }
  for (  Long time : aggregateSeries.getTimeWindowSet()) {
    for (    MetricSpec metricSpec : starTreeConfig.getMetrics()) {
      String metricName=metricSpec.getName();
      long metricValue=aggregateSeries.get(time,metricName).longValue();
      metricValues.put(metricName,metricValues.get(metricName) + metricValue);
    }
  }
  boolean aboveThreshold=true;
  for (  MetricSpec metricSpec : starTreeConfig.getMetrics()) {
    String metricName=metricSpec.getName();
    long metricValue=metricValues.get(metricName);
    long metricSum=metricSums.get(metricName);
    double metricThreshold=metricThresholds.get(metricName);
    LOGGER.info("metricValue : {} metricSum : {}",metricValue,metricSum);
    if (metricValue < (metricThreshold / 100) * metricSum) {
      aboveThreshold=false;
      break;
    }
  }
  return aboveThreshold;
}
