{
  ExecutorService executorService=environment.lifecycle().executorService("starTreeManager").minThreads(Runtime.getRuntime().availableProcessors()).maxThreads(Runtime.getRuntime().availableProcessors()).build();
  final StarTreeManager manager=new StarTreeManagerImpl(executorService);
  environment.jersey().register(new ThirdEyeMetricsResource(manager));
  environment.jersey().register(new ThirdEyeDimensionsResource(manager));
  environment.jersey().register(new ThirdEyeCollectionsResource(manager));
  environment.jersey().register(new ThirdEyeTimeSeriesResource(manager));
  environment.healthChecks().register(NAME,new ThirdEyeHealthCheck());
  environment.admin().addTask(new ThirdEyeRestoreTask(manager,new File(config.getRootDir())));
  environment.admin().addTask(new ThirdEyeCreateTask(manager));
  environment.admin().addTask(new ThirdEyeDumpTreeTask(manager));
  environment.admin().addTask(new ThirdEyeDumpBufferTask(manager));
  environment.admin().addTask(new ThirdEyeBulkLoadTask(executorService,manager,new File(config.getRootDir()),new File(config.getTmpDir())));
  environment.lifecycle().addLifeCycleListener(new ThirdEyeLifeCycleListener(manager));
}
