{
  setup();
  KafkaHighLevelConsumerStreamProvider streamProvider=new KafkaHighLevelConsumerStreamProvider();
  streamProvider.init(config);
  streamProvider.start();
  final RealtimeSegmentImpl realtimeSegment=new RealtimeSegmentImpl(schema);
  Timer timer=new Timer(true);
  timer.schedule(new TimerTask(){
    @Override public void run(){
      System.out.println("numDocsIndexed : " + realtimeSegment.getRawDocumentCount() + " docIds so far : "+ realtimeSegment.getAggregateDocumentCount());
    }
  }
,5000,5000);
  int counter=0;
  long start=System.currentTimeMillis();
  while (counter <= 1000) {
    realtimeSegment.index(streamProvider.next());
    counter++;
  }
  System.out.println("time taken : " + (System.currentTimeMillis() - start));
  streamProvider.shutdown();
  timer.cancel();
}
