{
  MetricTimeSeries aggregateSeries=store.get(id);
  if (aggregateSeries == null) {
    store.putIfAbsent(id,new MetricTimeSeries(metricSchema));
    aggregateSeries=store.get(id);
  }
  aggregateSeries.aggregate(timeSeries);
  for (  Long time : timeSeries.getTimeWindowSet()) {
    setIfLess(minTime,time);
    setIfGreater(maxTime,time);
  }
}
