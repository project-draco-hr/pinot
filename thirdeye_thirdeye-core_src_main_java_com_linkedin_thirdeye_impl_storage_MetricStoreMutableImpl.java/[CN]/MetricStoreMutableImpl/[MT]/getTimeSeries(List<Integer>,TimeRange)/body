{
  MetricTimeSeries timeSeries=new MetricTimeSeries(metricSchema);
  for (  Integer id : logicalOffsets) {
    MetricTimeSeries incrementalSeries=store.get(id);
    if (incrementalSeries != null) {
      if (timeRange != null) {
        timeSeries.aggregate(incrementalSeries,timeRange);
      }
 else {
        timeSeries.aggregate(incrementalSeries);
      }
    }
  }
  return timeSeries;
}
