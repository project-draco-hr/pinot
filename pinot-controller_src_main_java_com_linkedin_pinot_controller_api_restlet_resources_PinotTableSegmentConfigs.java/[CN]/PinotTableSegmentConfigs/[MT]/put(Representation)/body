{
  final String tableName=(String)getRequest().getAttributes().get("tableName");
  if (tableName == null) {
    return new StringRepresentation("tableName is not present");
  }
  AbstractTableConfig config=null;
  try {
    config=AbstractTableConfig.init(entity.getText());
    manager.updateSegmentsValidationAndRetentionConfigFor(config.getTableName(),TableType.valueOf(config.getTableType()),config.getValidationConfig());
    return new StringRepresentation("done");
  }
 catch (  final Exception e) {
    LOGGER.error("errpr updating segments configs for table {}",config.getTableName(),e);
    return PinotSegmentUploadRestletResource.exceptionToStringRepresentation(e);
  }
}
