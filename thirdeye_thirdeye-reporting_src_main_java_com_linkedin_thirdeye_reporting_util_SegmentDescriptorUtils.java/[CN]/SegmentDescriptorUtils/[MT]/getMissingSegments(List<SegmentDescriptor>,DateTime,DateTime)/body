{
  List<TimeRange> missingRanges=new ArrayList<TimeRange>();
  long startHour=startDate.getMillis();
  long endHour=endDate.getMillis();
  LOGGER.info(startHour + " " + endHour);
  LOGGER.info("Start : " + startDate + " End : "+ endDate);
  int start=-1;
  for (int i=0; i < segmentDescriptors.size(); i++) {
    if (segmentDescriptors.get(i).includesTime(startHour)) {
      start=i;
      break;
    }
  }
  if (start == -1) {
    missingRanges.add(new TimeRange(startHour,endHour));
  }
 else {
    Long previousEnd=null;
    Long currentEnd=null;
    long currentStart;
    while (start < segmentDescriptors.size()) {
      currentStart=segmentDescriptors.get(start).getStartWallTime().getMillis();
      currentEnd=segmentDescriptors.get(start).getEndWallTime().getMillis();
      if (previousEnd != null && currentStart != previousEnd) {
        missingRanges.add(new TimeRange(previousEnd,currentStart));
      }
      previousEnd=currentEnd;
      if (endHour <= currentEnd) {
        break;
      }
      start++;
    }
    if (currentEnd < endHour) {
      missingRanges.add(new TimeRange(currentEnd,endHour));
    }
  }
  return missingRanges;
}
