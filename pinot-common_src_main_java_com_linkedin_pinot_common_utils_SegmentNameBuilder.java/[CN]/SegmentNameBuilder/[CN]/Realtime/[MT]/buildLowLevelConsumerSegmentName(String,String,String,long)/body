{
  DateTime dateTime=new DateTime(millisSinceEpoch,DateTimeZone.UTC);
  String date=dateTime.toString("yyyy-MM-DD'T'HHmmss.SSS'Z'");
  if (isValidSegmentComponent(tableName) && isValidSegmentComponent(partitionId) && isValidSegmentComponent(sequenceNumber)&& isValidSegmentComponent(date)) {
    return StringUtils.join(Lists.newArrayList(tableName,partitionId,sequenceNumber,date),"__");
  }
 else {
    throw new IllegalArgumentException("Invalid table name (" + tableName + "), partition range ("+ partitionId+ "), sequence number ("+ sequenceNumber+ ") or date ("+ date+ ")");
  }
}
