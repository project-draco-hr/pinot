{
  FileOutputStream indexFileOutputStream=null;
  try {
    byte[] indexBytes=OBJECT_MAPPER.writeValueAsBytes(forwardIndex);
    File indexFile=new File(outputDir,nodeId + StarTreeConstants.INDEX_FILE_SUFFIX);
    if (!indexFile.createNewFile()) {
      throw new IOException(indexFile + " already exists");
    }
    indexFileOutputStream=new FileOutputStream(indexFile);
    IOUtils.copy(new ByteArrayInputStream(indexBytes),indexFileOutputStream);
  }
  finally {
    if (indexFileOutputStream != null) {
      indexFileOutputStream.close();
    }
  }
}
