{
  List<GenericRow> outputRows=new ArrayList<>();
  PinotSegmentRecordReader pinotSegmentRecordReader=new PinotSegmentRecordReader(segmentIndexDir);
  pinotSegmentRecordReader.init();
  while (pinotSegmentRecordReader.hasNext()) {
    outputRows.add(pinotSegmentRecordReader.next());
  }
  pinotSegmentRecordReader.close();
  Assert.assertEquals(outputRows.size(),rows.size(),"Number of rows returned by PinotSegmentRecordReader is incorrect");
  for (int i=0; i < outputRows.size(); i++) {
    GenericRow outputRow=outputRows.get(i);
    GenericRow row=rows.get(i);
    Assert.assertEquals(outputRow.getValue("d1"),row.getValue("d1"));
    Assert.assertEquals(outputRow.getValue("d2"),row.getValue("d2"));
    Assert.assertEquals(outputRow.getValue("m1"),row.getValue("m1"));
    Assert.assertEquals(outputRow.getValue("m2"),row.getValue("m2"));
    Assert.assertEquals(outputRow.getValue("t"),row.getValue("t"));
  }
}
