{
  anomalyFunctionDAO.save(spec);
  Assert.assertNotNull(spec.getId());
  AnomalyResult result=getAnomalyResult();
  result.setFunction(spec);
  anomalyResultDAO.save(result);
  AnomalyResult resultRet=anomalyResultDAO.findById(result.getId());
  Assert.assertEquals(resultRet.getFunction(),spec);
  anomalyResultId=result.getId();
  List<AnomalyResult> rawResults=new ArrayList<>();
  rawResults.add(result);
  AnomalyMergeConfig mergeConfig=new AnomalyMergeConfig();
  List<AnomalyMergedResult> mergedResults=AnomalySummaryGenerator.mergeAnomalies(rawResults,mergeConfig);
  Assert.assertEquals(mergedResults.get(0).getStartTime(),result.getStartTimeUtc());
  Assert.assertEquals(mergedResults.get(0).getEndTime(),result.getEndTimeUtc());
  Assert.assertEquals(mergedResults.get(0).getAnomalyResults().get(0),result);
  mergedResultDAO.save(mergedResults.get(0));
  mergedResultId=mergedResults.get(0).getId();
  Assert.assertNotNull(mergedResultId);
}
