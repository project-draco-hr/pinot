{
  List<MetricType> types=new ArrayList<>(metricNames.size());
  for (  String name : metricNames) {
    types.add(timeSeries.getSchema().getMetricType(name));
  }
  MetricSchema schema=new MetricSchema(metricNames,types);
  MetricTimeSeries converted=ThirdEyeFunctionUtils.copyBlankSeriesSame(schema.getNames(),schema);
  long inputSize=config.getTime().getBucket().getSize();
  TimeUnit inputUnit=config.getTime().getBucket().getUnit();
  for (  Long time : timeSeries.getTimeWindowSet()) {
    long convertedTime=outputUnit.convert(time * inputSize,inputUnit) / outputSize;
    for (    String name : metricNames) {
      converted.increment(convertedTime,name,timeSeries.get(time,name));
    }
  }
  return converted;
}
