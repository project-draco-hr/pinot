{
  for (  Map.Entry<String,List<String>> entry : isEntryMap.entrySet()) {
    final String segmentId=entry.getKey();
    final Map<String,String> stateMap=state.getInstanceStateMap(segmentId);
    if (stateMap != null) {
      stateMap.clear();
    }
    for (    String instanceName : entry.getValue()) {
      state.setPartitionState(segmentId,instanceName,PinotHelixSegmentOnlineOfflineStateModelGenerator.CONSUMING_STATE);
    }
  }
  return state;
}
