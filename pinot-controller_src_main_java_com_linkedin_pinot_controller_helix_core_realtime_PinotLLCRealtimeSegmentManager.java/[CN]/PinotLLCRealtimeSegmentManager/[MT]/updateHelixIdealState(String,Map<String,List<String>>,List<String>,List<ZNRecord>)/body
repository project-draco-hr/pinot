{
  _propertyStore.createChildren(paths,records,AccessOption.PERSISTENT);
  LOGGER.info("Added {} segments to propertyStore for table {}",paths.size(),realtimeTableName);
  HelixHelper.updateIdealState(_helixManager,realtimeTableName,new Function<IdealState,IdealState>(){
    @Override public IdealState apply(    IdealState idealState){
      return addOrUpdateRealtimeSegmentInIdealState(idealState,idealStateEntries);
    }
  }
,RetryPolicies.exponentialBackoffRetryPolicy(5,500L,2.0f));
  LOGGER.info("Updated IDEALSTATE for {} segments for table {}",paths.size(),realtimeTableName);
}
