{
  Connection conn=null;
  PreparedStatement preparedStmt=null;
  try {
    conn=dbConfig.getConnection();
    preparedStmt=conn.prepareStatement(buildAnomlayTableInsertStmt(dbConfig.getAnomalyTableName()));
    preparedStmt.setInt(1,row.getFunctionId());
    preparedStmt.setString(2,row.getFunctionDescription());
    preparedStmt.setString(3,row.getFunctionName());
    preparedStmt.setString(4,row.getCollection());
    SimpleDateFormat sdf=new SimpleDateFormat(dbConfig.getDateFormat());
    sdf.setTimeZone(TimeZone.getTimeZone("UTC"));
    String dateString=sdf.format(row.getTimeWindow());
    preparedStmt.setString(5,dateString);
    preparedStmt.setInt(6,row.getNonStarCount());
    preparedStmt.setString(7,row.getDimensions());
    preparedStmt.setString(8,serializeMetrics(row.getMetrics()));
    preparedStmt.setDouble(9,row.getAnomalyScore());
    preparedStmt.setDouble(10,row.getAnomalyVolume());
    preparedStmt.setString(11,row.getProperties());
    preparedStmt.executeUpdate();
  }
 catch (  SQLException e) {
    LOGGER.error("unable to insert row",e);
  }
 finally {
    try {
      if (conn != null) {
        conn.close();
      }
      if (preparedStmt != null) {
        preparedStmt.close();
      }
    }
 catch (    SQLException e) {
      LOGGER.error("close exception",e);
    }
  }
}
