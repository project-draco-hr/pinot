{
  Connection conn=null;
  PreparedStatement preparedStmt=null;
  try {
    conn=dbConfig.getConnection();
    preparedStmt=conn.prepareStatement(buildAnomlayTableInsertStmt(dbConfig.getAnomalyTableName()));
    preparedStmt.setString(1,row.getFunctionTable());
    preparedStmt.setInt(2,row.getFunctionId());
    preparedStmt.setString(3,row.getFunctionDescription());
    preparedStmt.setString(4,row.getFunctionName());
    preparedStmt.setString(5,row.getCollection());
    preparedStmt.setLong(6,row.getTimeWindow());
    preparedStmt.setInt(7,row.getNonStarCount());
    preparedStmt.setString(8,row.getDimensions());
    preparedStmt.setDouble(9,row.getDimensionsContribution());
    preparedStmt.setString(10,serializeMetrics(row.getMetrics()));
    preparedStmt.setDouble(11,row.getAnomalyScore());
    preparedStmt.setDouble(12,row.getAnomalyVolume());
    StringWriter writer=new StringWriter();
    row.getProperties().store(new PrintWriter(writer),"ResultProperties");
    preparedStmt.setString(13,writer.getBuffer().toString());
    preparedStmt.executeUpdate();
  }
 catch (  SQLException|JsonProcessingException e) {
    LOGGER.error("unable to insert row",e);
  }
 finally {
    try {
      if (conn != null) {
        conn.close();
      }
      if (preparedStmt != null) {
        preparedStmt.close();
      }
    }
 catch (    SQLException e) {
      LOGGER.error("close exception",e);
    }
  }
}
