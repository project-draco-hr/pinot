{
  _retentionManager.stop();
  for (  String segmentId : _pinotHelixResourceManager.getAllSegmentsForResource(TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(_testTableName))) {
    _pinotHelixResourceManager.deleteSegment(TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(_testTableName),segmentId);
  }
  while (_helixZkManager.getHelixPropertyStore().getChildNames(ZKMetadataProvider.constructPropertyStorePathForResource(TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(_testTableName)),AccessOption.PERSISTENT).size() > 0) {
    Thread.sleep(1000);
  }
}
