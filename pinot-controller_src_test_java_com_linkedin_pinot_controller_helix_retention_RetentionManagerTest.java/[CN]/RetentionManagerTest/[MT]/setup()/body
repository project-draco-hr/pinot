{
  ZkTestUtils.startLocalZkServer();
  _zkClient=new ZkClient(ZK_STR);
  _pinotHelixResourceManager=new PinotHelixResourceManager(ZK_STR,HELIX_CLUSTER_NAME,CONTROLLER_INSTANCE_NAME,null);
  _pinotHelixResourceManager.start();
  ControllerRequestBuilderUtil.addFakeDataInstancesToAutoJoinHelixCluster(HELIX_CLUSTER_NAME,ZK_STR,2);
  ControllerRequestBuilderUtil.addFakeBrokerInstancesToAutoJoinHelixCluster(HELIX_CLUSTER_NAME,ZK_STR,2);
  _helixAdmin=_pinotHelixResourceManager.getHelixAdmin();
  _helixZkManager=_pinotHelixResourceManager.getHelixZkManager();
  Tenant brokerTenant=new TenantBuilder("testBroker").setRole(TenantRole.BROKER).setTotalInstances(5).setOfflineInstances(-1).setRealtimeInstances(-1).build();
  _pinotHelixResourceManager.createBrokerTenant(brokerTenant);
  Tenant serverTenant=new TenantBuilder("testServer").setRole(TenantRole.BROKER).setTotalInstances(4).setOfflineInstances(2).setRealtimeInstances(2).build();
  _pinotHelixResourceManager.createBrokerTenant(serverTenant);
  String OfflineTableConfigJson=ControllerRequestBuilderUtil.buildCreateOfflineTableJSON(_testTableName,"testServer","testBroker",2).toString();
  AbstractTableConfig offlineTableConfig=AbstractTableConfig.init(OfflineTableConfigJson);
  _pinotHelixResourceManager.addTable(offlineTableConfig);
}
