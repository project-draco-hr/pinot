{
  String sql=SqlUtils.getThirdEyeSql(request);
  LOG.debug("Generated SQL {}",sql);
  HttpGet req=new HttpGet(QUERY_ENDPOINT + URLEncoder.encode(sql,UTF_8));
  LOG.info("Executing sql request: {}",req);
  CloseableHttpResponse res=httpClient.execute(httpHost,req);
  try {
    if (res.getStatusLine().getStatusCode() != 200) {
      throw new IllegalStateException(res.getStatusLine().toString());
    }
    InputStream content=res.getEntity().getContent();
    ThirdEyeRawResponse rawResponse=OBJECT_MAPPER.readValue(content,ThirdEyeRawResponse.class);
    return rawResponse;
  }
  finally {
    if (res.getEntity() != null) {
      EntityUtils.consume(res.getEntity());
    }
    res.close();
  }
}
