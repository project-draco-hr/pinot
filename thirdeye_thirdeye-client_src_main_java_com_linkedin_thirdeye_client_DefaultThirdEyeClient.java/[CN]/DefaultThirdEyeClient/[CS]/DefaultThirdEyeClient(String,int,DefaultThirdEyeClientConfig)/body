{
  LOG.info("Initializing client for {}:{} with config {}",hostname,port,config);
  this.config=config;
  this.httpHost=new HttpHost(hostname,port);
  this.httpClient=HttpClients.createDefault();
  CacheBuilder builder=CacheBuilder.newBuilder();
  if (config.isExpireAfterAccess()) {
    builder.expireAfterAccess(config.getExpirationTime(),config.getExpirationUnit());
  }
 else {
    builder.expireAfterWrite(config.getExpirationTime(),config.getExpirationUnit());
  }
  this.resultCache=builder.build(new ResultCacheLoader());
  this.rawResultCache=builder.build(new RawResultCacheLoader());
  this.schemaCache=CacheBuilder.newBuilder().expireAfterWrite(DEFAULT_CACHE_EXPIRATION_DURATION,TimeUnit.SECONDS).build(new SchemaCacheLoader());
  this.starTreeConfigCache=CacheBuilder.newBuilder().expireAfterWrite(DEFAULT_CACHE_EXPIRATION_DURATION,TimeUnit.SECONDS).build(new StarTreeConfigCacheLoader());
  this.segmentDescriptorCache=CacheBuilder.newBuilder().expireAfterAccess(DEFAULT_CACHE_EXPIRATION_DURATION,TimeUnit.MINUTES).build(new SegmentDescriptorCacheLoader());
  this.collectionsSupplier=buildCollectionsSupplier();
  LOG.info("Created DefaultThirdEyeClient to {}",httpHost);
}
