{
  StarTreeQuery baseQuery=UriUtils.createQueryBuilder(starTree,uriInfo).setTimeRange(timeRange).build(starTree.getConfig());
  int dimensionIndex=-1;
  for (int i=0; i < starTree.getConfig().getDimensions().size(); i++) {
    if (starTree.getConfig().getDimensions().get(i).getName().equals(dimensionName)) {
      baseQuery.getDimensionKey().getDimensionValues()[i]=StarTreeConstants.ALL;
      dimensionIndex=i;
      break;
    }
  }
  if (dimensionIndex < 0) {
    throw new NotFoundException("No dimension " + dimensionName);
  }
  List<StarTreeQuery> queries=StarTreeUtils.expandQueries(starTree,baseQuery);
  queries=StarTreeUtils.filterQueries(starTree.getConfig(),queries,uriInfo.getQueryParameters());
  Map<String,MetricTimeSeries> result=new HashMap<String,MetricTimeSeries>();
  for (  StarTreeQuery query : queries) {
    MetricTimeSeries timeSeries=starTree.getTimeSeries(query);
    result.put(query.getDimensionKey().getDimensionValues()[dimensionIndex],timeSeries);
  }
  return result;
}
