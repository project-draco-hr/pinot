{
  StarTreeQuery baseQuery=UriUtils.createQueryBuilder(starTree,uriInfo).setTimeRange(timeRange).build(starTree.getConfig());
  int dimensionIndex=-1;
  for (int i=0; i < starTree.getConfig().getDimensions().size(); i++) {
    if (starTree.getConfig().getDimensions().get(i).getName().equals(dimensionName)) {
      baseQuery.getDimensionKey().getDimensionValues()[i]=StarTreeConstants.ALL;
      dimensionIndex=i;
      break;
    }
  }
  if (dimensionIndex < 0) {
    throw new NotFoundException("No dimension " + dimensionName);
  }
  List<StarTreeQuery> queries=StarTreeUtils.expandQueries(starTree,baseQuery);
  queries=StarTreeUtils.filterQueries(starTree.getConfig(),queries,uriInfo.getQueryParameters());
  Map<StarTreeQuery,Future<MetricTimeSeries>> futures=new HashMap<StarTreeQuery,Future<MetricTimeSeries>>(queries.size());
  for (  final StarTreeQuery query : queries) {
    futures.put(query,parallelQueryExecutor.submit(new Callable<MetricTimeSeries>(){
      @Override public MetricTimeSeries call() throws Exception {
        return starTree.getTimeSeries(query);
      }
    }
));
  }
  Map<String,MetricTimeSeries> result=new HashMap<String,MetricTimeSeries>();
  for (  Map.Entry<StarTreeQuery,Future<MetricTimeSeries>> entry : futures.entrySet()) {
    result.put(entry.getKey().getDimensionKey().getDimensionValues()[dimensionIndex],entry.getValue().get());
  }
  return result;
}
