{
  String[][] indexMetadataArray=new String[][]{new String[]{"2014-10","2014-11","MONTHLY"},new String[]{"2014-11","2014-12","MONTHLY"},new String[]{"2014-12","2015-01","MONTHLY"},new String[]{"2014-12-24","2014-12-25","DAILY"},new String[]{"2014-12-25","2014-12-26","DAILY"},new String[]{"2014-12-26","2014-12-27","DAILY"},new String[]{"2014-12-27","2014-12-28","DAILY"},new String[]{"2014-12-28","2014-12-29","DAILY"},new String[]{"2014-12-29","2014-12-30","DAILY"},new String[]{"2014-12-30","2014-12-31","DAILY"},new String[]{"2015-01-01","2015-01-02","DAILY"},new String[]{"2015-01-02","2015-01-03","DAILY"},new String[]{"2015-01-03","2015-01-04","DAILY"},new String[]{"2015-01-04","2015-01-05","DAILY"},new String[]{"2015-01-05","2015-01-06","DAILY"},new String[]{"2015-01-06","2015-01-07","DAILY"}};
  Map<UUID,IndexMetadata> treeMetadataMap=new HashMap<UUID,IndexMetadata>();
  Map<UUID,Integer> treeIdToArrayIndexMapping=new HashMap<UUID,Integer>();
  for (int i=0; i < indexMetadataArray.length; i++) {
    Long minDataTime=toMilliSecond(indexMetadataArray[i][0],indexMetadataArray[i][2]);
    Long maxDataTime=toMilliSecond(indexMetadataArray[i][1],indexMetadataArray[i][2]);
    Long startTime=toMilliSecond(indexMetadataArray[i][0],indexMetadataArray[i][2]);
    Long endTime=toMilliSecond(indexMetadataArray[i][1],indexMetadataArray[i][2]);
    String timeGranularity=indexMetadataArray[i][2];
    IndexMetadata value=new IndexMetadata(minDataTime,maxDataTime,startTime,endTime,timeGranularity);
    UUID uuid=UUID.nameUUIDFromBytes(("" + i).getBytes());
    System.out.println("Adding metadata for treeId:" + uuid + Arrays.toString(indexMetadataArray[i])+ " metadata:"+ value);
    treeMetadataMap.put(uuid,value);
    treeIdToArrayIndexMapping.put(uuid,i);
  }
  String queryStart="2014-12-02";
  String queryEnd="2015-01-04";
  TimeRange queryTimeRange=new TimeRange(toMilliSecond(queryStart,"DAILY"),toMilliSecond(queryEnd,"DAILY"));
  System.out.println(queryTimeRange);
  List<UUID> treesToQuery=queryExecutor.selectTreesToQuery(treeMetadataMap,queryTimeRange);
  System.out.println(treesToQuery);
  System.out.println("The following tree's will be queried for query range " + (queryStart) + " - "+ queryEnd);
  Assert.assertEquals(treesToQuery.size(),4);
  for (  UUID treeId : treesToQuery) {
    String[] metadataInfo=indexMetadataArray[treeIdToArrayIndexMapping.get(treeId)];
    System.out.println(treeId + ":" + Arrays.toString(metadataInfo));
  }
  Assert.assertEquals(indexMetadataArray[treeIdToArrayIndexMapping.get(treesToQuery.get(0))],new String[]{"2014-12","2015-01","MONTHLY"});
  Assert.assertEquals(indexMetadataArray[treeIdToArrayIndexMapping.get(treesToQuery.get(1))],new String[]{"2015-01-01","2015-01-02","DAILY"});
  Assert.assertEquals(indexMetadataArray[treeIdToArrayIndexMapping.get(treesToQuery.get(2))],new String[]{"2015-01-02","2015-01-03","DAILY"});
  Assert.assertEquals(indexMetadataArray[treeIdToArrayIndexMapping.get(treesToQuery.get(3))],new String[]{"2015-01-03","2015-01-04","DAILY"});
}
