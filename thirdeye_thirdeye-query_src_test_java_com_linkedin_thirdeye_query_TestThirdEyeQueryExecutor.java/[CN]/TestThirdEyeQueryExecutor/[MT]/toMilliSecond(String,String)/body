{
  long ret;
  if (granularity.equalsIgnoreCase("MONTHLY")) {
    ret=new SimpleDateFormat("yyyy-MM").parse(dateString).getTime();
  }
 else   if (granularity.equalsIgnoreCase("DAILY")) {
    ret=new SimpleDateFormat("yyyy-MM-dd").parse(dateString).getTime();
  }
 else   if (granularity.equalsIgnoreCase("HOURLY")) {
    ret=new SimpleDateFormat("yyyy-MM-dd HH:mm:ss").parse(dateString).getTime();
  }
 else {
    throw new Exception("Unsupported granularity: " + granularity);
  }
  System.out.println("Converted " + dateString + " of granularity:"+ granularity+ " to "+ ret+ " ms to timestamp:"+ new Timestamp(ret));
  return ret;
}
