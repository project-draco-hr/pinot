{
  Object[][] indexMetadata={{UUID.randomUUID(),createIndexMetadata("2014-10TZ","2014-11TZ","2014-10TZ","2014-11TZ","MONTHLY")},{UUID.randomUUID(),createIndexMetadata("2014-11TZ","2014-12TZ","2014-11TZ","2014-12TZ","MONTHLY")},{UUID.randomUUID(),createIndexMetadata("2014-12TZ","2015-01TZ","2014-12TZ","2015-01TZ","MONTHLY")},{UUID.randomUUID(),createIndexMetadata("2014-12-24TZ","2014-12-25TZ","2014-12-24TZ","2014-12-25TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-25TZ","2014-12-26TZ","2014-12-25TZ","2014-12-26TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-26TZ","2014-12-27TZ","2014-12-26TZ","2014-12-27TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-27TZ","2014-12-28TZ","2014-12-27TZ","2014-12-28TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-28TZ","2014-12-29TZ","2014-12-28TZ","2014-12-29TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-29TZ","2014-12-30TZ","2014-12-29TZ","2014-12-30TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2014-12-30TZ","2014-12-31TZ","2014-12-30TZ","2014-12-31TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-01TZ","2015-01-02TZ","2015-01-01TZ","2015-01-02TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-02TZ","2015-01-03TZ","2015-01-02TZ","2015-01-03TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-03TZ","2015-01-04TZ","2015-01-03TZ","2015-01-04TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-04TZ","2015-01-05TZ","2015-01-04TZ","2015-01-05TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-05TZ","2015-01-06TZ","2015-01-05TZ","2015-01-06TZ","DAILY")},{UUID.randomUUID(),createIndexMetadata("2015-01-06TZ","2015-01-07TZ","2015-01-06TZ","2015-01-07TZ","DAILY")}};
  Map<UUID,IndexMetadata> indexMetadataMap=new HashMap<>();
  for (  Object[] datum : indexMetadata) {
    indexMetadataMap.put((UUID)datum[0],(IndexMetadata)datum[1]);
  }
  DateTime queryStartTime=ISODateTimeFormat.dateTimeParser().parseDateTime("2014-12-02TZ").toDateTime(DateTimeZone.UTC);
  DateTime queryEndTime=ISODateTimeFormat.dateTimeParser().parseDateTime("2015-01-04TZ").toDateTime(DateTimeZone.UTC);
  TimeRange queryTimeRange=new TimeRange(queryStartTime.getMillis(),queryEndTime.getMillis());
  List<UUID> ids=queryExecutor.selectTreesToQuery(indexMetadataMap,queryTimeRange);
  Assert.assertEquals(ids,ImmutableList.of((UUID)indexMetadata[2][0],(UUID)indexMetadata[10][0],(UUID)indexMetadata[11][0],(UUID)indexMetadata[12][0],(UUID)indexMetadata[13][0]));
}
