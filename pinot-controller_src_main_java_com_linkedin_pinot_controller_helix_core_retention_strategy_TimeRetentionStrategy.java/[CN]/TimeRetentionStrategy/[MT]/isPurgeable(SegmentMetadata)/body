{
  if (_retentionDuration == null || _retentionDuration.getMillis() <= 0) {
    return false;
  }
  Interval timeInterval=segmentMetadata.getTimeInterval();
  if (timeInterval == null) {
    return false;
  }
  long endsMills=timeInterval.getEndMillis();
  Duration segmentTimeUntilNow=new Duration(endsMills,System.currentTimeMillis());
  if (_retentionDuration.isShorterThan(segmentTimeUntilNow)) {
    return true;
  }
  return false;
}
