{
  if (isStarted.getAndSet(false)) {
    LOG.info("Shutting down Kafka consumer persist scheduler for {}",starTreeConfig.getCollection());
    taskScheduler.shutdown();
    LOG.info("Shutting down Kafka consumer executors for {}",starTreeConfig.getCollection());
    consumerExecutors.shutdown();
    LOG.info("Persisting any remaining data");
    if (persistTask.get() != null) {
      persistTask.get().run();
    }
    LOG.info("Shut down kafka consumer for {}",starTreeConfig.getCollection());
  }
}
