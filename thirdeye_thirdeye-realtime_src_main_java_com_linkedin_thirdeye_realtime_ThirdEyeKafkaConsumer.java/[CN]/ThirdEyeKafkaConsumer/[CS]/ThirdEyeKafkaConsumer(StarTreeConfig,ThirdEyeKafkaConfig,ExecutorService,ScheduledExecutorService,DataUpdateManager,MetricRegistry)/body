{
  if (starTreeConfig == null) {
    throw new NullPointerException("Provided star tree config is null");
  }
  if (kafkaConfig == null) {
    throw new NullPointerException("Provided kafka config is null");
  }
  this.starTreeConfig=starTreeConfig;
  this.kafkaConfig=kafkaConfig;
  this.consumerExecutors=consumerExecutors;
  this.taskScheduler=taskScheduler;
  this.dataUpdateManager=dataUpdateManager;
  this.isStarted=new AtomicBoolean();
  this.lock=new ReentrantReadWriteLock();
  this.stats=new ThirdEyeKafkaStats(starTreeConfig.getCollection(),kafkaConfig.getTopicName(),metricRegistry);
  this.persistTask=new AtomicReference<>();
}
