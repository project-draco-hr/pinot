{
  this.starTree=starTree;
  this.config=config;
  this.executorService=executorService;
  this.persistScheduler=persistScheduler;
  this.isShutdown=new AtomicBoolean(true);
  this.metricRegistry=metricRegistry;
  this.streamStats=new ConcurrentHashMap<String,ThirdEyeKafkaStats>();
  this.persistLock=new ReentrantReadWriteLock(true);
  this.schedule=config.getPersistInterval().getSize() + "-" + config.getPersistInterval().getUnit();
  this.metricStoreDirectory=new File(kafkaDataDir,StarTreeConstants.METRIC_STORE);
  this.tmpMetricStoreDirectory=new File(kafkaDataDir,TMP_DIR_PREFIX + StarTreeConstants.METRIC_STORE);
  this.kafkaDataDir=kafkaDataDir;
}
