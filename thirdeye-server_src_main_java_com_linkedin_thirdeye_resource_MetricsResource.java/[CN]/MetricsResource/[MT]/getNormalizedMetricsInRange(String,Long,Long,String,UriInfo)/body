{
  StarTree starTree=starTreeManager.getStarTree(collection);
  if (starTree == null) {
    throw new NotFoundException("No collection " + collection);
  }
  Map<DimensionKey,MetricTimeSeries> result=QueryUtils.doQuery(starTree,start,end,uriInfo);
  for (  Map.Entry<DimensionKey,MetricTimeSeries> entry : result.entrySet()) {
    result.put(entry.getKey(),MetricTimeSeriesUtils.normalize(entry.getValue(),metricName));
  }
  return convert(starTree.getConfig(),result);
}
