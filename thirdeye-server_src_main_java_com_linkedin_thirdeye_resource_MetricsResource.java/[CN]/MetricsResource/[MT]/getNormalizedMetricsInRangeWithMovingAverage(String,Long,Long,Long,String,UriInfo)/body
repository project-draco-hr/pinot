{
  StarTree starTree=starTreeManager.getStarTree(collection);
  if (starTree == null) {
    throw new NotFoundException("No collection " + collection);
  }
  Map<DimensionKey,MetricTimeSeries> result=QueryUtils.doQuery(starTree,start - movingAverageWindow,end,uriInfo);
  for (  Map.Entry<DimensionKey,MetricTimeSeries> entry : result.entrySet()) {
    result.put(entry.getKey(),MetricTimeSeriesUtils.normalize(MetricTimeSeriesUtils.getSimpleMovingAverage(entry.getValue(),start,end,movingAverageWindow),metricName));
  }
  return convert(starTree.getConfig(),result);
}
