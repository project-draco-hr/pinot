{
  List<StarTreeQuery> queries=StarTreeUtils.expandQueries(starTree,baseQuery);
  queries=StarTreeUtils.filterQueries(starTree.getConfig(),queries,uriInfo.getQueryParameters());
  List<ThirdEyeMetrics> metricsResults=new ArrayList<ThirdEyeMetrics>();
  for (  StarTreeQuery query : queries) {
    StarTreeRecord record=starTree.getAggregate(query);
    Map<String,String> dimensionValues=new HashMap<String,String>(starTree.getConfig().getDimensions().size());
    for (int i=0; i < starTree.getConfig().getDimensions().size(); i++) {
      dimensionValues.put(starTree.getConfig().getDimensions().get(i).getName(),record.getDimensionKey().getDimensionValues()[i]);
    }
    Map<String,Number> metricValues=new HashMap<String,Number>(starTree.getConfig().getMetrics().size());
    Number[] values=record.getMetricTimeSeries().getMetricSums();
    for (int i=0; i < starTree.getConfig().getMetrics().size(); i++) {
      metricValues.put(starTree.getConfig().getMetrics().get(i).getName(),values[i]);
    }
    ThirdEyeMetrics result=new ThirdEyeMetrics();
    result.setDimensionValues(dimensionValues);
    result.setMetricValues(metricValues);
    metricsResults.add(result);
  }
  return metricsResults;
}
