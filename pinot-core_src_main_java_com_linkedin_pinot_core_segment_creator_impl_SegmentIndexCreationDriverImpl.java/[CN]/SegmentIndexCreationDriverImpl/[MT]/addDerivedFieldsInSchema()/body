{
  if (enableHllIndex) {
    Collection<String> columnNames=dataSchema.getColumnNames();
    HllConfig hllConfig=config.getHllConfig();
    for (    Entry<String,String> entry : hllConfig.getDerivedHllFieldsMap().entrySet()) {
      String originFieldName=entry.getKey();
      String derivedFieldName=entry.getValue();
      if (columnNames.contains(derivedFieldName)) {
        throw new IllegalArgumentException("Can not add derivedField " + derivedFieldName + " since it already exists in schema.");
      }
 else {
        dataSchema.addField(derivedFieldName,new MetricFieldSpec(derivedFieldName,FieldSpec.DataType.STRING,hllConfig.getHllFieldSize(),MetricFieldSpec.DerivedMetricType.HLL));
      }
    }
  }
}
