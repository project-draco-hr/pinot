{
  statsCollector.build();
  for (  final FieldSpec spec : dataSchema.getAllFieldSpecs()) {
    final String column=spec.getName();
    indexCreationInfoMap.put(column,new ColumnIndexCreationInfo(true,statsCollector.getColumnProfileFor(column).getMinValue(),statsCollector.getColumnProfileFor(column).getMaxValue(),statsCollector.getColumnProfileFor(column).getUniqueValuesSet(),ForwardIndexType.FIXED_BIT_COMPRESSED,InvertedIndexType.P4_DELTA,statsCollector.getColumnProfileFor(column).isSorted(),statsCollector.getColumnProfileFor(column).hasNull(),statsCollector.getColumnProfileFor(column).getTotalNumberOfEntries(),statsCollector.getColumnProfileFor(column).getMaxNumberOfMultiValues()));
  }
  segmentIndexCreationInfo.setTotalDocs(totalDocs);
  segmentIndexCreationInfo.setTotalRawDocs(totalRawDocs);
  segmentIndexCreationInfo.setTotalAggDocs(totalAggDocs);
  segmentIndexCreationInfo.setStarTreeEnabled(createStarTree);
  segmentIndexCreationInfo.setTotalConversions(extractor.getTotalConversions());
  segmentIndexCreationInfo.setTotalErrors(extractor.getTotalErrors());
  segmentIndexCreationInfo.setTotalNullCols(extractor.getTotalNullCols());
  segmentIndexCreationInfo.setTotalNulls(extractor.getTotalNulls());
}
