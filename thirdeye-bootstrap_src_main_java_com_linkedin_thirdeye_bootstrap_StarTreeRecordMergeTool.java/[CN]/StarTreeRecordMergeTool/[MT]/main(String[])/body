{
  Options options=new Options();
  options.addOption("fileType",true,"Input/output file type (default: avro)");
  CommandLine commandLine=new GnuParser().parse(options,args);
  if (commandLine.getArgs().length < 3) {
    HelpFormatter helpFormatter=new HelpFormatter();
    helpFormatter.printHelp("usage: [opts] configFile outputFile inputFile(s) ...",options);
    return;
  }
  StarTreeConfig config=StarTreeConfig.fromJson(new ObjectMapper().readTree(new FileInputStream(commandLine.getArgs()[0])));
  FileType fileType=FileType.valueOf(commandLine.getOptionValue("fileType","AVRO").toUpperCase());
  File outputFile=new File(commandLine.getArgs()[1]);
  List<File> inputFiles=new ArrayList<File>();
  for (int i=2; i < commandLine.getArgs().length; i++) {
    inputFiles.add(new File(commandLine.getArgs()[i]));
  }
  new StarTreeRecordMergeTool(config,fileType,outputFile,inputFiles).run();
}
