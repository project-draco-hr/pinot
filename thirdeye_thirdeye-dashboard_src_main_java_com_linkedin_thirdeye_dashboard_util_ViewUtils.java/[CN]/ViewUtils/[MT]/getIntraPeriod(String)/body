{
  Granularity granularity=getGranularity(metricFunction);
  int aggregationWindow=Integer.parseInt(metricFunction.split("_")[1]);
  long intraPeriod;
  if (granularity.equals(Granularity.HOURS)) {
    intraPeriod=INTRA_DAY_PERIOD;
  }
 else   if (granularity.equals(Granularity.DAYS) && aggregationWindow == 1) {
    intraPeriod=INTRA_WEEK_PERIOD;
  }
 else   if (granularity.equals(Granularity.DAYS)) {
    intraPeriod=INTRA_MONTH_PERIOD;
  }
 else {
    throw new IllegalArgumentException("Unknown granularity: " + granularity);
  }
  return intraPeriod;
}
