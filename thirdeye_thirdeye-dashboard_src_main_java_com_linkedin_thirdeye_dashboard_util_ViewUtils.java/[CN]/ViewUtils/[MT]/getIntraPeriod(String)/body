{
  Granularity granularity=getGranularity(metricFunction);
  int aggregationWindow=Integer.parseInt(metricFunction.split("_")[1]);
  IntraPeriod intraPeriod;
  if (granularity == Granularity.HOURS) {
    intraPeriod=IntraPeriod.DAY;
  }
 else   if (granularity == Granularity.DAYS && aggregationWindow == 1) {
    intraPeriod=IntraPeriod.WEEK;
  }
 else   if (granularity == Granularity.DAYS) {
    intraPeriod=IntraPeriod.MONTH;
  }
 else {
    throw new IllegalArgumentException("Unknown granularity: " + granularity);
  }
  return intraPeriod;
}
