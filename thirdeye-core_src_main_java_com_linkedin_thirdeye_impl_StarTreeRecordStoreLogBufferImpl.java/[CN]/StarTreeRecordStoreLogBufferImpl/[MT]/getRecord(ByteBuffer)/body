{
  StarTreeRecordImpl.Builder builder=new StarTreeRecordImpl.Builder();
  for (  DimensionSpec dimensionSpec : dimensionSpecs) {
    String dimensionValue=reverseIndex.get(dimensionSpec.getName()).get(buffer.getInt());
    builder.setDimensionValue(dimensionSpec.getName(),dimensionValue);
  }
  long time=buffer.getLong();
  builder.setTime(time == -1 ? null : time);
  for (int i=0; i < metricSpecs.size(); i++) {
    String metricName=metricSpecs.get(i).getName();
    MetricType type=metricSpecs.get(i).getType();
    Number val=NumberUtils.readFromBuffer(buffer,type);
    builder.setMetricValue(metricName,val);
    builder.setMetricType(metricName,metricSpecs.get(i).getType());
  }
  return builder.build();
}
