{
  Map<String,String> schemaMap=new HashMap<String,String>();
  for (  String fieldName : fieldSpecMap.keySet()) {
    FieldSpec fieldSpec=fieldSpecMap.get(fieldName);
    schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.COLUMN_NAME),fieldSpec.getName());
    FieldType fieldType=fieldSpec.getFieldType();
    schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.FIELD_TYPE),fieldType.toString());
    schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.DATA_TYPE),fieldSpec.getDataType().toString());
switch (fieldType) {
case DIMENSION:
      schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.IS_SINGLE_VALUE),fieldSpec.isSingleValueField() + "");
    schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.DELIMETER),fieldSpec.getDelimiter());
  break;
case TIME:
schemaMap.put(StringUtil.join(".",DataSource.SCHEMA,fieldName,DataSource.Schema.TIME_UNIT),((TimeFieldSpec)fieldSpec).getIncominGranularutySpec().getTimeType().toString());
break;
default :
break;
}
}
return schemaMap;
}
