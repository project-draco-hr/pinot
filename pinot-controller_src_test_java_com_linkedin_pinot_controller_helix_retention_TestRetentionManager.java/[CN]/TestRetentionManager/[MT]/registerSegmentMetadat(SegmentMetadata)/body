{
  ZNRecord record=new ZNRecord(segmentMetadata.getName());
  record.setSimpleFields(segmentMetadata.toMap());
  _pinotHelixResourceManager.getPropertyStore().create(PinotHelixUtils.constructPropertyStorePathForSegment(segmentMetadata),record,AccessOption.PERSISTENT);
  IdealState idealState=_helixAdmin.getResourceIdealState(HELIX_CLUSTER_NAME,segmentMetadata.getResourceName());
  idealState.setPartitionState(segmentMetadata.getName(),"Server_localhost_0","ONLINE");
  idealState.setPartitionState(segmentMetadata.getName(),"Server_localhost_1","ONLINE");
  _helixAdmin.setResourceIdealState(HELIX_CLUSTER_NAME,segmentMetadata.getResourceName(),idealState);
}
