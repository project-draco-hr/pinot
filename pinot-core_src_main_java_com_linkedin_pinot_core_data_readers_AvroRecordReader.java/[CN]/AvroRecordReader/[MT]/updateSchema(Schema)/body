{
  for (  final FieldSpec fieldSpec : schema.getAllFieldSpecs()) {
    try {
      fieldSpec.setDataType(getColumnType(_dataStream.getSchema().getField(fieldSpec.getName())));
      fieldSpec.setSingleValueField(isSingleValueField(_dataStream.getSchema().getField(fieldSpec.getName())));
      schema.addField(fieldSpec.getName(),fieldSpec);
    }
 catch (    Exception e) {
      LOGGER.warn("Caught exception while converting Avro field {} of type {}, field will not be in schema.",fieldSpec.getName(),fieldSpec.getDataType());
    }
  }
}
