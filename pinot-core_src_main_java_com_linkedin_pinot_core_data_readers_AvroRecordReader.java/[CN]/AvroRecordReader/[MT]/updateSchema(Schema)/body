{
  if (schema == null || schema.size() == 0) {
    for (    final Field field : _dataStream.getSchema().getFields()) {
      final String columnName=field.name();
      final FieldSpec fieldSpec=new FieldSpec();
      fieldSpec.setName(columnName);
      fieldSpec.setFieldType(FieldType.unknown);
      fieldSpec.setDataType(getColumnType(_dataStream.getSchema().getField(columnName)));
      fieldSpec.setSingleValueField(isSingleValueField(_dataStream.getSchema().getField(columnName)));
      fieldSpec.setDelimeter(COMMA);
      schema.addSchema(columnName,fieldSpec);
    }
  }
 else {
    for (    final String columnName : schema.getColumnNames()) {
      final FieldSpec fieldSpec=new FieldSpec();
      fieldSpec.setName(columnName);
      fieldSpec.setFieldType(schema.getFieldType(columnName));
      fieldSpec.setDelimeter(schema.getDelimeter(columnName));
      fieldSpec.setDataType(getColumnType(_dataStream.getSchema().getField(columnName)));
      fieldSpec.setSingleValueField(isSingleValueField(_dataStream.getSchema().getField(columnName)));
      schema.addSchema(columnName,fieldSpec);
    }
  }
}
