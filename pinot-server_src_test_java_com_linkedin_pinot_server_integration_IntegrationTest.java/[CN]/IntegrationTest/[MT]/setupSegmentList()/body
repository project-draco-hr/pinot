{
  final String filePath=getClass().getClassLoader().getResource(SMALL_AVRO_DATA).getFile();
  _indexSegmentList.clear();
  if (INDEXES_DIR.exists()) {
    FileUtils.deleteQuietly(INDEXES_DIR);
  }
  INDEXES_DIR.mkdir();
  for (int i=0; i < 2; ++i) {
    final File segmentDir=new File(INDEXES_DIR,"segment_" + i);
    final SegmentGeneratorConfig config=SegmentTestUtils.getSegmentGenSpecWithSchemAndProjectedColumns(new File(filePath),segmentDir,"dim" + i,TimeUnit.DAYS,"midas","testTable");
    final SegmentIndexCreationDriver driver=SegmentCreationDriverFactory.get(null);
    driver.init(config);
    driver.build();
    System.out.println("built at : " + segmentDir.getAbsolutePath());
  }
  _indexSegmentList.add(ColumnarSegmentLoader.load(new File(new File(INDEXES_DIR,"segment_0"),"midas_testTable_0_9_"),ReadMode.mmap));
  _indexSegmentList.add(ColumnarSegmentLoader.load(new File(new File(INDEXES_DIR,"segment_1"),"midas_testTable_0_99_"),ReadMode.mmap));
}
