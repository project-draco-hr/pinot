{
  long timeBucketCount;
  if (!request.shouldGroupByTime()) {
    timeBucketCount=1;
  }
 else {
    long duration=request.getEndTimeExclusive().getMillis() - request.getStartTimeInclusive().getMillis();
    timeBucketCount=dataTimeGranularity.convertToUnit(duration);
  }
  return timeBucketCount;
}
