{
  if (maxNumResults <= MAX_NUM_GROUP_KEYS_FOR_ARRAY_BASED) {
switch (functionName.toLowerCase()) {
case "sum":
case "min":
case "max":
      DoubleArray doubleArray=new DoubleArray((int)maxNumResults,defaultValue);
    return new DoubleArrayBasedResultHolder(doubleArray,(int)maxNumResults,defaultValue);
case "avg":
  DoubleLongArray doubleLongArray=new DoubleLongArray((int)maxNumResults,new Pair<Double,Long>(0.0,0L));
return new PairArrayBasedResultHolder(doubleLongArray,(int)maxNumResults,defaultValue);
default :
throw new RuntimeException("Aggregation function not implemented in ResultHolder: " + functionName);
}
}
 else {
switch (functionName.toLowerCase()) {
case "sum":
case "min":
case "max":
return new MapBasedDoubleResultHolder(defaultValue);
case "avg":
return new MapBasedPairResultHolder(defaultValue);
default :
throw new RuntimeException("Aggregation function not implemented in ResultHolder: " + functionName);
}
}
}
