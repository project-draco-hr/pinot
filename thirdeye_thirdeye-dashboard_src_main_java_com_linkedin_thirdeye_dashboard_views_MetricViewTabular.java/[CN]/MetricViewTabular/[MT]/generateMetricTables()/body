{
  List<MetricTable> tables=new ArrayList<>();
  for (  Map.Entry<String,Map<String,Number[]>> entry : currentResult.getData().entrySet()) {
    Map<String,Number[]> currentSeries=entry.getValue();
    Map<String,Number[]> baselineSeries=baselineResult.getData().get(entry.getKey());
    if (baselineSeries == null) {
      continue;
    }
    Map<String,String> dimensionValues=getDimensionValues(entry.getKey());
    List<Long> times=new ArrayList<>(currentSeries.size());
    for (    String timeString : entry.getValue().keySet()) {
      times.add(Long.parseLong(timeString));
    }
    Collections.sort(times);
    List<MetricTableRow> rows=new ArrayList<>();
    for (    Long time : times) {
      Number[] current=currentSeries.get(Long.toString(time));
      Number[] baseline=baselineSeries.get(Long.toString(time - baselineOffsetMillis));
      if (baseline == null) {
        throw new IllegalStateException("No baseline for time " + time);
      }
      rows.add(new MetricTableRow(new DateTime(time - baselineOffsetMillis).toDateTime(DateTimeZone.UTC),baseline,new DateTime(time).toDateTime(DateTimeZone.UTC),current));
    }
    tables.add(new MetricTable(dimensionValues,rows));
  }
  return tables;
}
