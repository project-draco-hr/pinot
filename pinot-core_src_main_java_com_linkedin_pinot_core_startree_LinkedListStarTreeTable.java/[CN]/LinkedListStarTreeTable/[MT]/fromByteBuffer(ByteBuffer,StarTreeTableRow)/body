{
  buffer.rewind();
  for (int i=0; i < dimensionTypes.size(); i++) {
    row.getDimensions().set(i,buffer.getInt());
  }
  for (int i=0; i < metricTypes.size(); i++) {
switch (metricTypes.get(i)) {
case SHORT:
      row.setMetric(i,buffer.getShort());
    break;
case INT:
  row.setMetric(i,buffer.getInt());
break;
case LONG:
row.setMetric(i,buffer.getLong());
break;
case FLOAT:
row.setMetric(i,buffer.getFloat());
break;
case DOUBLE:
row.setMetric(i,buffer.getDouble());
break;
default :
throw new IllegalArgumentException("Unsupported metric type " + metricTypes.get(i));
}
}
}
