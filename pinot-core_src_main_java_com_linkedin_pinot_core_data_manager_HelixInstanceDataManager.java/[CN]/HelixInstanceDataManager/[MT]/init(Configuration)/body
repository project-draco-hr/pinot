{
  try {
    _instanceDataManagerConfig=new HelixInstanceDataManagerConfig(dataManagerConfig);
    File instanceDataDir=new File(_instanceDataManagerConfig.getInstanceDataDir());
    if (!instanceDataDir.exists()) {
      instanceDataDir.mkdirs();
    }
    File instanceSegmentTarDir=new File(_instanceDataManagerConfig.getInstanceSegmentTarDir());
    if (!instanceSegmentTarDir.exists()) {
      instanceSegmentTarDir.mkdirs();
    }
    try {
      _segmentMetadataLoader=getSegmentMetadataLoader(_instanceDataManagerConfig.getSegmentMetadataLoaderClass());
      LOGGER.info("Loaded SegmentMetadataLoader for class name : " + _instanceDataManagerConfig.getSegmentMetadataLoaderClass());
    }
 catch (    Exception e) {
      LOGGER.error("Cannot initialize SegmentMetadataLoader for class name : " + _instanceDataManagerConfig.getSegmentMetadataLoaderClass());
      e.printStackTrace();
    }
    System.out.println(_instanceDataManagerConfig.getInstanceBootstrapSegmentDir());
    System.out.println(_instanceDataManagerConfig.getInstanceDataDir());
    System.out.println(_instanceDataManagerConfig.getInstanceId());
    System.out.println(_instanceDataManagerConfig.getInstanceSegmentTarDir());
    System.out.println(_instanceDataManagerConfig.getSegmentMetadataLoaderClass());
    System.out.println(_instanceDataManagerConfig.getReadMode());
    try {
      bootstrapSegmentsFromLocal();
    }
 catch (    Exception e) {
      LOGGER.error("Error in bootstrap segment from dir : " + _instanceDataManagerConfig.getInstanceBootstrapSegmentDir());
      e.printStackTrace();
    }
  }
 catch (  Exception e) {
    _instanceDataManagerConfig=null;
    e.printStackTrace();
  }
}
