{
  decoderProps=new HashMap<String,String>();
  this.indexingSchema=schema;
  if (properties.containsKey(KafkaProperties.HighLevelConsumer.GROUP_ID)) {
    this.groupId=properties.get(KafkaProperties.HighLevelConsumer.GROUP_ID);
  }
  if (properties.containsKey(KafkaProperties.HighLevelConsumer.ZK_CONNECTION_STRING)) {
    this.zkString=properties.get(KafkaProperties.HighLevelConsumer.ZK_CONNECTION_STRING);
  }
  if (properties.containsKey(KafkaProperties.TOPIC_NAME)) {
    this.kafkaTopicName=properties.get(KafkaProperties.TOPIC_NAME);
  }
  if (properties.containsKey(KafkaProperties.DECODER_CLASS)) {
    this.decodeKlass=properties.get(KafkaProperties.DECODER_CLASS);
  }
  if (groupId == null || zkString == null || kafkaTopicName == null || this.decodeKlass == null) {
    throw new Exception();
  }
  for (  String key : properties.keySet()) {
    if (key.startsWith(KafkaProperties.DECODER_PROPS_PREFIX)) {
      decoderProps.put(KafkaProperties.getDecoderPropertyKey(key),properties.get(key));
    }
  }
}
