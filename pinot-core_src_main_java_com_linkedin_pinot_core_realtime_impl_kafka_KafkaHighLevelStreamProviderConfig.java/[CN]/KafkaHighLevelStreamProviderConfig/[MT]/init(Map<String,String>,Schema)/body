{
  decoderProps=new HashMap<String,String>();
  this.indexingSchema=schema;
  if (properties.containsKey(Helix.DataSource.Realtime.Kafka.HighLevelConsumer.GROUP_ID)) {
    this.groupId=properties.get(Helix.DataSource.Realtime.Kafka.HighLevelConsumer.GROUP_ID);
  }
  if (properties.containsKey(Helix.DataSource.Realtime.Kafka.HighLevelConsumer.ZK_CONNECTION_STRING)) {
    this.zkString=properties.get(Helix.DataSource.Realtime.Kafka.HighLevelConsumer.ZK_CONNECTION_STRING);
  }
  if (properties.containsKey(Helix.DataSource.Realtime.Kafka.TOPIC_NAME)) {
    this.kafkaTopicName=properties.get(Helix.DataSource.Realtime.Kafka.TOPIC_NAME);
  }
  if (properties.containsKey(Helix.DataSource.Realtime.Kafka.DECODER_CLASS)) {
    this.decodeKlass=properties.get(Helix.DataSource.Realtime.Kafka.DECODER_CLASS);
  }
  if (groupId == null || zkString == null || kafkaTopicName == null || this.decodeKlass == null) {
    throw new Exception();
  }
  for (  String key : properties.keySet()) {
    if (key.startsWith(Helix.DataSource.Realtime.Kafka.DECODER_PROPS_PREFIX)) {
      decoderProps.put(Helix.DataSource.Realtime.Kafka.getDecoderPropertyKey(key),properties.get(key));
    }
  }
}
