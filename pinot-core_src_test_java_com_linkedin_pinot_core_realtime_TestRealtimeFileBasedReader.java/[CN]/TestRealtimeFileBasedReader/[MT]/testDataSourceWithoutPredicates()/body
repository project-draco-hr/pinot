{
  DataSource offlineDS=offlineSegment.getDataSource("viewerId");
  DataSource realtimeDS=realtimeSegment.getDataSource("viewerId");
  Block offlineBlock=offlineDS.nextBlock();
  Block realtimeBlock=realtimeDS.nextBlock();
  BlockMetadata offlineMetadata=offlineBlock.getMetadata();
  BlockMetadata realtimeMetadata=realtimeBlock.getMetadata();
  BlockSingleValIterator offlineValIterator=(BlockSingleValIterator)offlineBlock.getBlockValueSet().iterator();
  BlockSingleValIterator realtimeValIterator=(BlockSingleValIterator)realtimeBlock.getBlockValueSet().iterator();
  Assert.assertEquals(offlineSegment.getTotalDocs(),realtimeSegment.getAggregateDocumentCount());
  while (realtimeValIterator.hasNext()) {
    int offlineDicId=offlineValIterator.nextIntVal();
    int realtimeDicId=realtimeValIterator.nextIntVal();
    Assert.assertEquals(offlineMetadata.getDictionary().get(offlineDicId),realtimeMetadata.getDictionary().get(realtimeDicId));
  }
}
