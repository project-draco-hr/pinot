{
  List<Expression> metrics=request.getMetricFunction().getMetricExpressions();
  Map<String,Integer> rawMetricIndexMap=computeIndexMap(rawMetrics);
  for (  Map<String,Number[]> row : data.values()) {
    for (    String timestamp : row.keySet()) {
      Number[] rawData=row.get(timestamp);
      Number[] metricData=computeMetricData(metrics,rawMetricIndexMap,rawData);
      row.put(timestamp,metricData);
    }
  }
  return data;
}
