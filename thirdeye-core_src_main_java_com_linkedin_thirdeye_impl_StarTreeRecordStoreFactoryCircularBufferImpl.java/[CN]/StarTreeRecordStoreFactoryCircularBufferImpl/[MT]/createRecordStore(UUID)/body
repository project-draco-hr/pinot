{
  File indexFile=new File(rootDir,nodeId.toString() + StarTreeConstants.INDEX_FILE_SUFFIX);
  Map<String,Map<String,Integer>> forwardIndex;
  try {
    forwardIndex=OBJECT_MAPPER.readValue(new FileInputStream(indexFile),TYPE_REFERENCE);
  }
 catch (  Exception e) {
    throw new IllegalStateException(e);
  }
  File bufferFile=new File(rootDir,nodeId.toString() + StarTreeConstants.BUFFER_FILE_SUFFIX);
  return new StarTreeRecordStoreCircularBufferImpl(nodeId,bufferFile,dimensionSpecs,metricSpecs,forwardIndex,numTimeBuckets);
}
