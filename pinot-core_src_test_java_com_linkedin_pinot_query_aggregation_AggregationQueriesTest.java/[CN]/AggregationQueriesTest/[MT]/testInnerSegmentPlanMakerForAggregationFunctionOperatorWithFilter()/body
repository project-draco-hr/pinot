{
  final BrokerRequest brokerRequest=getAggregationWithFilterBrokerRequest();
  final PlanMaker instancePlanMaker=new InstancePlanMakerImplV0();
  final PlanNode rootPlanNode=instancePlanMaker.makeInnerSegmentPlan(_indexSegment,brokerRequest);
  rootPlanNode.showTree("");
  final MAggregationOperator operator=(MAggregationOperator)rootPlanNode.run();
  final IntermediateResultsBlock resultBlock=(IntermediateResultsBlock)operator.nextBlock();
  LOGGER.info("RunningTime : {}",resultBlock.getTimeUsedMs());
  LOGGER.info("NumDocsScanned : {}",resultBlock.getNumDocsScanned());
  LOGGER.info("TotalDocs : {}",resultBlock.getTotalRawDocs());
  Assert.assertEquals(resultBlock.getNumDocsScanned(),582);
  Assert.assertEquals(resultBlock.getTotalRawDocs(),10001);
  logReducedResults(resultBlock);
}
