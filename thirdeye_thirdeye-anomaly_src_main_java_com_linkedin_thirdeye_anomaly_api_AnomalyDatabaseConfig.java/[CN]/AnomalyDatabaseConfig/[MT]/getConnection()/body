{
  if (useConnectionPool) {
    if (dataSource == null) {
      DriverAdapterCPDS cpds=new DriverAdapterCPDS();
      try {
        cpds.setDriver("com.mysql.jdbc.Driver");
      }
 catch (      ClassNotFoundException e) {
        e.printStackTrace();
      }
      cpds.setUrl(getPrefix() + getUrl());
      cpds.setUser(getUser());
      cpds.setPassword(getPassword());
      SharedPoolDataSource tds=new SharedPoolDataSource();
      tds.setConnectionPoolDataSource(cpds);
      tds.setMaxTotal(10);
      tds.setValidationQuery("select 1 as dbcp_connection_test;");
      tds.setDefaultTestOnBorrow(true);
      tds.setDefaultTestOnReturn(true);
      tds.setDefaultTestOnCreate(true);
      tds.setDefaultTestWhileIdle(true);
      dataSource=tds;
    }
    return dataSource.getConnection();
  }
 else {
    return DriverManager.getConnection(JDBC_MYSQL_PREFIX + getUrl(),getUser(),getPassword());
  }
}
