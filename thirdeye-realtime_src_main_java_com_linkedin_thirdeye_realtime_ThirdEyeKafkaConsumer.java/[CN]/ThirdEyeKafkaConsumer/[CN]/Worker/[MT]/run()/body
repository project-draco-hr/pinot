{
  ConsumerIterator<byte[],byte[]> itr=stream.iterator();
  while (!isShutdown.get() && itr.hasNext()) {
    try {
      MessageAndMetadata<byte[],byte[]> next=itr.next();
      reuseDecoder=DecoderFactory.get().binaryDecoder(next.message(),reuseDecoder);
      reuseRecord=datumReader.read(reuseRecord,reuseDecoder);
      messagesReceived.incrementAndGet();
      StarTreeUtils.toStarTreeRecord(starTree.getConfig(),reuseRecord,builder);
      StarTreeRecord record=builder.build();
      if (startTime == null || record.getTime() >= startTime) {
        starTree.add(record);
      }
      builder.clear();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
}
