{
  int threadCount=DEFAULT_THREAD_COUNT;
  if (kafkaConfig.getProperty(PROP_THREAD_COUNT) != null) {
    threadCount=Integer.valueOf(kafkaConfig.getProperty(PROP_THREAD_COUNT));
  }
  List<KafkaStream<byte[],byte[]>> streams=consumerConnector.createMessageStreams(Collections.singletonMap(topic,threadCount)).get(topic);
  for (  KafkaStream<byte[],byte[]> stream : streams) {
    executorService.submit(new Worker(stream));
  }
}
