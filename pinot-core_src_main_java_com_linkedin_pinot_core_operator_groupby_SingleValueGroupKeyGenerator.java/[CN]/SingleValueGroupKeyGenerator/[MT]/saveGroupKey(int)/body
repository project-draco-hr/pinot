{
  int groupKey;
  if (_storageType == STORAGE_TYPE.ARRAY_BASED) {
    if (_uniqueGroupKeysFlag[rawKey] == false) {
      _uniqueGroupKeysFlag[rawKey]=true;
      _numUniqueGroupKeys++;
    }
    groupKey=rawKey;
  }
 else {
    groupKey=_groupKeyToId.get(rawKey);
    if (groupKey == INVALID_ID) {
      groupKey=_groupKeyToId.size();
      _groupKeyToId.put(rawKey,groupKey);
      _numUniqueGroupKeys++;
    }
 else {
      groupKey=_groupKeyToId.get(rawKey);
    }
  }
  return groupKey;
}
