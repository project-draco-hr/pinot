{
  int offset=0;
  for (  String metric : dataSchema.getMetricNames()) {
    metricsOffsetMap.put(metric,offset);
switch (dataSchema.getFieldSpecFor(metric).getDataType()) {
case INT:
      offset+=Integer.SIZE / Byte.SIZE;
    break;
case FLOAT:
  offset+=Float.SIZE / Byte.SIZE;
break;
case LONG:
offset+=Long.SIZE / Byte.SIZE;
break;
case DOUBLE:
offset+=Double.SIZE / Byte.SIZE;
break;
default :
break;
}
}
}
