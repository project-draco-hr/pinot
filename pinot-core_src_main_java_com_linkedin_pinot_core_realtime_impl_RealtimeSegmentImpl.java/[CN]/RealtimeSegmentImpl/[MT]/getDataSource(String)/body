{
  FieldSpec fieldSpec=dataSchema.getFieldSpecFor(columnName);
  DataSource ds=null;
  if (fieldSpec.getFieldType() == FieldType.METRIC) {
    ds=new RealtimeColumnDataSource(fieldSpec,null,null,columnName,docIdSearchableOffset,dataSchema,0,dimensionsSerde,metricsSerDe,dimensionBuffs,metBuffs,time);
  }
  if (fieldSpec.getFieldType() == FieldType.DIMENSION) {
    ds=new RealtimeColumnDataSource(fieldSpec,dictionaryMap.get(columnName),invertedIndexMap.get(columnName),columnName,docIdSearchableOffset,dataSchema,maxNumberOfMultivaluesMap.get(columnName),dimensionsSerde,metricsSerDe,dimensionBuffs,metBuffs,time);
  }
  if (fieldSpec.getFieldType() == FieldType.TIME) {
    ds=new RealtimeColumnDataSource(fieldSpec,dictionaryMap.get(columnName),invertedIndexMap.get(columnName),columnName,docIdSearchableOffset,dataSchema,0,dimensionsSerde,metricsSerDe,dimensionBuffs,metBuffs,time);
  }
  return ds;
}
