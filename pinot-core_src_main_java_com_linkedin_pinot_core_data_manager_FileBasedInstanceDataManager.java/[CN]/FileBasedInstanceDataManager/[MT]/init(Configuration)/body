{
  try {
    _instanceDataManagerConfig=new FileBasedInstanceDataManagerConfig(dataManagerConfig);
  }
 catch (  Exception e) {
    _instanceDataManagerConfig=null;
    LOGGER.error("Error during InstanceDataManager initialization",e);
    throw new RuntimeException(e);
  }
  for (  String resourceName : _instanceDataManagerConfig.getResourceNames()) {
    ResourceDataManagerConfig resourceDataManagerConfig=_instanceDataManagerConfig.getResourceDataManagerConfig(resourceName);
    ResourceDataManager resourceDataManager=ResourceDataManagerProvider.getResourceDataManager(resourceDataManagerConfig);
    _resourceDataManagerMap.put(resourceName,resourceDataManager);
  }
  try {
    _segmentMetadataLoader=getSegmentMetadataLoader(_instanceDataManagerConfig.getSegmentMetadataLoaderClass());
    LOGGER.info("Loaded SegmentMetadataLoader for class name : " + _instanceDataManagerConfig.getSegmentMetadataLoaderClass());
  }
 catch (  Exception e) {
    LOGGER.error("Cannot initialize SegmentMetadataLoader for class name : " + _instanceDataManagerConfig.getSegmentMetadataLoaderClass());
    e.printStackTrace();
  }
}
