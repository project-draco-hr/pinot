{
  final String zkPath="/" + HELIX_CLUSTER_NAME;
  if (_zkClient.exists(zkPath)) {
    _zkClient.deleteRecursive(zkPath);
  }
  final String instanceId="localhost_helixController";
  _pinotResourceManager=new PinotHelixResourceManager(ZK_SERVER,HELIX_CLUSTER_NAME,instanceId);
  _pinotResourceManager.start();
  final String helixZkURL=HelixConfig.getAbsoluteZkPathForHelix(ZK_SERVER);
  _helixZkManager=HelixSetupUtils.setup(HELIX_CLUSTER_NAME,helixZkURL,instanceId);
  _helixAdmin=_helixZkManager.getClusterManagmentTool();
  _numInstance=1;
  final List<HelixServerStarter> pinotHelixStarters=addInstancesToAutoJoinHelixCluster(_numInstance);
  Thread.sleep(3000);
  Assert.assertEquals(_helixAdmin.getInstancesInClusterWithTag(HELIX_CLUSTER_NAME,CommonConstants.Helix.UNTAGGED_SERVER_INSTANCE).size(),_numInstance);
  final DataResource resource=ControllerRequestBuilderUtil.createOfflineClusterCreationConfig(1,1,TEST_RESOURCE_NAME,"BalanceNumSegmentAssignmentStrategy");
  _pinotResourceManager.createNewDataResource(resource);
}
