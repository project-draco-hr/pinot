{
  Options options=new Options();
  options.addOption("krb5",true,"Path to krb5.conf file (default: ~/.krb5.conf)");
  options.addOption("debug",false,"Debug logging");
  options.addOption("help",false,"Prints this help message");
  options.addOption("minTime",true,"Min time to load");
  options.addOption("maxTime",true,"Max time to load");
  options.addOption("mode",true,"Data load mode (BOOTSTRAP, INCREMENT, PATCH)");
  CommandLine commandLine=new GnuParser().parse(options,args);
  if (commandLine.getArgs().length != 3 || commandLine.hasOption("help")) {
    HelpFormatter helpFormatter=new HelpFormatter();
    helpFormatter.printHelp(USAGE,options);
    System.exit(1);
  }
  File loginConf=new File(System.getProperty("java.io.tmpdir"),"thirdeye-login.conf." + System.currentTimeMillis());
  loginConf.deleteOnExit();
  OutputStream outputStream=new FileOutputStream(loginConf);
  IOUtils.write(LOGIN_CONF.getBytes(),outputStream);
  outputStream.flush();
  outputStream.close();
  System.setProperty("java.security.auth.login.config",loginConf.getAbsolutePath());
  System.setProperty("java.security.krb5.conf",commandLine.getOptionValue("krb5",DEFAULT_KRB5_CONF));
  System.setProperty("javax.security.auth.useSubjectCredsOnly","false");
  System.setProperty("sun.security.krb5.debug",Boolean.toString(options.hasOption("debug")));
  Console console=System.console();
  char[] passwordChars=console.readPassword("password: ");
  String user=System.getProperty("user.name");
  String password=new String(passwordChars);
  DateTime minTime=commandLine.hasOption("minTime") ? parseDateTime(commandLine.getOptionValue("minTime")) : new DateTime(0);
  DateTime maxTime=commandLine.hasOption("maxTime") ? parseDateTime(commandLine.getOptionValue("maxTime")) : new DateTime(Long.MAX_VALUE);
  Mode mode=Mode.valueOf(commandLine.getOptionValue("mode","BOOTSTRAP").toUpperCase());
  new DataLoadTool(user,password,URI.create(commandLine.getArgs()[0]),URI.create(commandLine.getArgs()[1]),commandLine.getArgs()[2],mode,new TimeRange(minTime.getMillis(),maxTime.getMillis())).run();
}
