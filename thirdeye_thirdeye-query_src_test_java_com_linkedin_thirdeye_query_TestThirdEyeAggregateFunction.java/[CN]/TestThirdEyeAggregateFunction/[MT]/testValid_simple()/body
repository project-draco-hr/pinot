{
  MetricTimeSeries derived=new ThirdEyeAggregateFunction(ImmutableList.of("L","D"),new TimeGranularity(4,TimeUnit.HOURS)).apply(config,timeSeries);
  Assert.assertEquals(derived.getTimeWindowSet().size(),4);
  for (long i=0; i < 16; i+=4) {
    Assert.assertEquals(derived.get(i,"L"),4L);
    Assert.assertEquals(derived.get(i,"D"),4.0);
  }
}
