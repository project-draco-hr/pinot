{
  Set<Integer> used;
  if (dimensions.contains(StarTreeIndexNode.all())) {
    used=usedAggDocumentIds;
  }
 else {
    used=usedRawDocumentIds;
  }
  Set<Integer> possible=documentIds.get(dimensions);
  if (possible == null) {
    return null;
  }
  Integer next=null;
  for (  Integer id : possible) {
    if (!used.contains(id)) {
      used.add(id);
      next=id;
      break;
    }
  }
  return next;
}
