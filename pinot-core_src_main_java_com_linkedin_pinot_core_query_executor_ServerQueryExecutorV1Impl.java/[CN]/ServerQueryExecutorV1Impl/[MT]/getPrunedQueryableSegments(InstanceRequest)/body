{
  LOGGER.info("InstanceRequest request {} segments",instanceRequest.getSearchSegments().size());
  final String tableName=instanceRequest.getQuery().getQuerySource().getTableName();
  final TableDataManager tableDataManager=_instanceDataManager.getTableDataManager(tableName);
  if (tableDataManager == null || instanceRequest.getSearchSegmentsSize() == 0) {
    return new ArrayList<IndexSegment>();
  }
  final List<SegmentDataManager> matchedSegmentDataManagerFromServer=tableDataManager.getSegments(instanceRequest.getSearchSegments());
  LOGGER.info("TableDataManager found {} segments before pruning",matchedSegmentDataManagerFromServer.size());
  final List<IndexSegment> queryableSegmentDataManagerList=new ArrayList<IndexSegment>();
  for (  final SegmentDataManager segmentDataManager : matchedSegmentDataManagerFromServer) {
    final IndexSegment indexSegment=segmentDataManager.getSegment();
    if (!_segmentPrunerService.prune(indexSegment,instanceRequest.getQuery())) {
      queryableSegmentDataManagerList.add(indexSegment);
    }
  }
  return queryableSegmentDataManagerList;
}
