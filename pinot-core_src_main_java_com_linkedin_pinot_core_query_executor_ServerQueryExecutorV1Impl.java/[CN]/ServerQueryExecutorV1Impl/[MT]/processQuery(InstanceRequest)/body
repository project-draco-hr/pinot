{
  long start=System.currentTimeMillis();
  final BrokerRequest brokerRequest=instanceRequest.getQuery();
  LOGGER.info("Incoming query is :" + brokerRequest);
  List<IndexSegment> queryableSegmentDataManagerList=getPrunedQueryableSegments(instanceRequest);
  LOGGER.info("Matched " + queryableSegmentDataManagerList.size() + " segments! ");
  if (queryableSegmentDataManagerList.isEmpty()) {
    return null;
  }
  final Plan globalQueryPlan=_planMaker.makeInterSegmentPlan(queryableSegmentDataManagerList,brokerRequest,_instanceDataManager.getResourceDataManager(brokerRequest.getQuerySource().getResourceName()).getExecutorService());
  if (_printQueryPlan) {
    LOGGER.debug("***************************** Query Plan for Request " + instanceRequest.getRequestId() + "***********************************");
    globalQueryPlan.print();
    LOGGER.debug("*********************************** End Query Plan ***********************************");
  }
  try {
    globalQueryPlan.execute();
  }
 catch (  Exception e) {
    LOGGER.error(e.getMessage());
    return null;
  }
  DataTable instanceResponse=globalQueryPlan.getInstanceResponse();
  long end=System.currentTimeMillis();
  LOGGER.info("Searching Instance for Request Id - " + instanceRequest.getRequestId() + ", browse took: "+ (end - start));
  LOGGER.debug("InstanceResponse for Request Id - " + instanceRequest.getRequestId() + " : "+ instanceResponse.toString());
  instanceResponse.getMetadata().put("timeUsedMs",Long.toString((end - start)));
  instanceResponse.getMetadata().put("requestId",Long.toString(instanceRequest.getRequestId()));
  return instanceResponse;
}
