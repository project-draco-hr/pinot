{
  Schema schema=segment.getSegmentMetadata().getSchema();
  if (brokerRequest.getSelections() != null) {
    if (brokerRequest.getSelections().getSelectionColumns() != null) {
      for (      String columnName : brokerRequest.getSelections().getSelectionColumns()) {
        if ((!columnName.equalsIgnoreCase("*")) && (!schema.isExisted(columnName))) {
          return true;
        }
      }
    }
    if (brokerRequest.getSelections().getSelectionSortSequence() != null) {
      for (      SelectionSort selectionOrder : brokerRequest.getSelections().getSelectionSortSequence()) {
        if (!schema.isExisted(selectionOrder.getColumn())) {
          return true;
        }
      }
    }
  }
  if ((brokerRequest.getGroupBy() != null) && (brokerRequest.getGroupBy().getColumns() != null)) {
    for (    String columnName : brokerRequest.getGroupBy().getColumns()) {
      if (!schema.isExisted(columnName)) {
        return true;
      }
    }
  }
  if (brokerRequest.getAggregationsInfo() != null) {
    for (    AggregationInfo aggregationInfo : brokerRequest.getAggregationsInfo()) {
      if (aggregationInfo.getAggregationParams().containsKey(COLUMN_KEY)) {
        String columnName=aggregationInfo.getAggregationParams().get(COLUMN_KEY);
        if ((!columnName.equalsIgnoreCase("*")) && (!schema.isExisted(columnName))) {
          return true;
        }
      }
    }
  }
  return false;
}
