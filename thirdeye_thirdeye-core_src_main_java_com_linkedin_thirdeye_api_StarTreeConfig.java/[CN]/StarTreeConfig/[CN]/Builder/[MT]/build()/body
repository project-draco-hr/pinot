{
  if (collection == null) {
    throw new IllegalArgumentException("Must provide collection");
  }
  if (dimensions == null || dimensions.isEmpty()) {
    throw new IllegalArgumentException("Must provide dimension names");
  }
  if (metrics == null || metrics.isEmpty()) {
    throw new IllegalArgumentException("Must provide metric specs");
  }
  return new StarTreeConfig(collection,recordStoreFactoryClass,recordStoreFactoryConfig,anomalyDetectionFunctionClass,anomalyDetectionFunctionConfig,anomalyHandlerClass,anomalyHandlerConfig,anomalyDetectionMode,dimensions,metrics,time,joinSpec,rollup,topKRollup,split,fixed);
}
