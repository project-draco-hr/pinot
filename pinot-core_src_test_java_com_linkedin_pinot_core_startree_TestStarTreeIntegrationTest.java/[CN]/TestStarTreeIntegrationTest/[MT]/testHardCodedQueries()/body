{
  String[] queries=new String[]{"select sum(m1) from T","select sum(m1) from T where d1 = 'd1-v2' group by d2"};
  List<String> metricNames=_schema.getMetricNames();
  for (int i=0; i < queries.length; i++) {
    Pql2Compiler compiler=new Pql2Compiler();
    BrokerRequest brokerRequest=compiler.compileToBrokerRequest(queries[i]);
    double[] expectedSums=computeSumUsingRawDocs(metricNames,brokerRequest);
    double[] actualSums=computeSumUsingAggregatedDocs(metricNames,brokerRequest);
    Assert.assertEquals(expectedSums.length,actualSums.length,"Mis-match in number of metrics");
    for (int j=0; j < expectedSums.length; j++) {
      Assert.assertEquals(expectedSums[j],actualSums[j],"Mis-match result for metric: " + metricNames.get(j) + " Acutal: "+ actualSums[j]+ " Expected: "+ expectedSums[j]);
    }
  }
}
