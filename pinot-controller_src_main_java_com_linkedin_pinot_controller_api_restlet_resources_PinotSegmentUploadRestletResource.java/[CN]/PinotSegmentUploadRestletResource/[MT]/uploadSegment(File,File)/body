{
  final SegmentMetadata metadata=new SegmentMetadataImpl(indexDir);
  final File tableDir=new File(baseDataDir,metadata.getTableName());
  File segmentFile=new File(tableDir,dataFile.getName());
  if (segmentFile.exists()) {
    FileUtils.deleteQuietly(segmentFile);
  }
  FileUtils.moveFile(dataFile,segmentFile);
  PinotResourceManagerResponse response=_pinotHelixResourceManager.addSegment(metadata,constructDownloadUrl(metadata.getTableName(),dataFile.getName()));
  setStatus((response.isSuccessfull() ? Status.SUCCESS_OK : Status.SERVER_ERROR_INTERNAL));
  return new StringRepresentation(response.toJSON().toString());
}
