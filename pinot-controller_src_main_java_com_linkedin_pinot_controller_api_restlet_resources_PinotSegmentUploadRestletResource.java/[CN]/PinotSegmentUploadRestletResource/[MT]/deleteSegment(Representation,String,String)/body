{
  if (tableName == null || segmentName == null) {
    throw new RuntimeException("either table name or segment name is null");
  }
  PinotResourceManagerResponse res=null;
  if (ZKMetadataProvider.isSegmentExisted(_pinotHelixResourceManager.getPropertyStore(),TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(tableName),segmentName)) {
    res=_pinotHelixResourceManager.deleteSegment(TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(tableName),segmentName);
    rep=new StringRepresentation(res.toString());
  }
  if (ZKMetadataProvider.isSegmentExisted(_pinotHelixResourceManager.getPropertyStore(),TableNameBuilder.REALTIME_TABLE_NAME_BUILDER.forTable(tableName),segmentName)) {
    res=_pinotHelixResourceManager.deleteSegment(TableNameBuilder.REALTIME_TABLE_NAME_BUILDER.forTable(tableName),segmentName);
    rep=new StringRepresentation(res.toString());
  }
  if (res == null) {
    String error=new String("Cannot find the segment: " + segmentName + " in table: "+ tableName);
    LOGGER.error(error);
    setStatus(Status.CLIENT_ERROR_BAD_REQUEST);
    rep=new StringRepresentation(error);
  }
  return rep;
}
