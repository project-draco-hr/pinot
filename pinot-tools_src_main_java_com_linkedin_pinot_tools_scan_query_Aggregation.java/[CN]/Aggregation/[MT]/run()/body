{
  Projection projection=new Projection(_indexSegment,_metadata,_filteredDocIds,_aggregationColumns);
  ResultTable projectionResult=projection.run();
  Map<String,Dictionary> dictionaryMap=new HashMap<>();
  for (  String column : _aggregationColumns) {
    dictionaryMap.put(column,_indexSegment.getDictionaryFor(column));
  }
  ResultTable results=aggregate(projectionResult.values(dictionaryMap));
  return results;
}
