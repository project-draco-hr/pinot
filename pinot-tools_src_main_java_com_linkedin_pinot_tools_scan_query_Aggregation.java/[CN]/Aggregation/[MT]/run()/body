{
  Projection projection=new Projection(_indexSegment,_metadata,_filteredDocIds,_aggregationColumns);
  ResultTable projectionResult=projection.run();
  ResultTable results=new ResultTable(projectionResult.getColumnMetadatas(),1);
  for (  Map.Entry<String,String> entry : _columnAggregationFuncMap.entrySet()) {
    String column=entry.getKey();
    Dictionary dictionaryReader=(column.equals("*")) ? null : _indexSegment.getDictionaryFor(column);
    AggregationFunc aggregationFunc=AggregationFuncFactory.getAggregationFunc(projectionResult,column,entry.getValue(),dictionaryReader);
    ResultTable aggregationResult=aggregationFunc.run();
    results.add(0,aggregationResult.get(0,0));
  }
  return results;
}
