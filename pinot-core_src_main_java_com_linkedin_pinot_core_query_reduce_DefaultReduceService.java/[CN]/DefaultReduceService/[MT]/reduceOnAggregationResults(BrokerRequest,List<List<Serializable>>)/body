{
  List<JSONObject> retAggregationResults=new ArrayList<JSONObject>();
  List<AggregationFunction> aggregationFunctions=AggregationFunctionFactory.getAggregationFunction(brokerRequest);
  for (int i=0; i < aggregationFunctions.size(); ++i) {
    Serializable retResult=aggregationFunctions.get(i).reduce(aggregationResultsList.get(i));
    try {
      retAggregationResults.add(aggregationFunctions.get(i).render(retResult).put("function",aggregationFunctions.get(i).getFunctionName()));
    }
 catch (    JSONException e) {
      LOGGER.error("Caught exception while reducing aggregation results",e);
      Utils.rethrowException(e);
      throw new AssertionError("Should not reach this");
    }
  }
  return retAggregationResults;
}
