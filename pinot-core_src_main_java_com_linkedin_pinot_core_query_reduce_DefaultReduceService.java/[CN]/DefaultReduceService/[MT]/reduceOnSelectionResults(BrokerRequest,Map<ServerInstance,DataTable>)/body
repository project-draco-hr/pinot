{
  try {
    if (instanceResponseMap.size() > 0) {
      DataTable dt=instanceResponseMap.values().iterator().next();
      SelectionOperatorService selectionService=new SelectionOperatorService(brokerRequest.getSelections(),dt.getDataSchema());
      return selectionService.render(selectionService.reduce(instanceResponseMap));
    }
 else {
      return null;
    }
  }
 catch (  Exception e) {
    LOGGER.error("Caught exception while reducing results",e);
    Utils.rethrowException(e);
    throw new AssertionError("Should not reach this");
  }
}
