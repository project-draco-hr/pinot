{
  if (_propertyStore == null) {
    return;
  }
  String resourceName=externalView.getResourceName();
  if (BrokerRequestUtils.getResourceTypeFromResourceName(resourceName) == ResourceType.REALTIME) {
    return;
  }
  List<OfflineSegmentZKMetadata> offlineSegmentZKMetadatas=ZKMetadataProvider.getOfflineResourceZKMetadataListForResource(_propertyStore,resourceName);
  OfflineDataResourceZKMetadata offlineDataResourceZKMetadata=ZKMetadataProvider.getOfflineResourceZKMetadata(_propertyStore,resourceName);
  TimeUnit resourceTimeUnit=getTimeUnitFromString(offlineDataResourceZKMetadata.getTimeType());
  if (!offlineSegmentZKMetadatas.isEmpty() && offlineSegmentZKMetadatas.get(0).getTimeUnit() != null) {
    long maxTimeValue=-1;
    for (    OfflineSegmentZKMetadata offlineSegmentZKMetadata : offlineSegmentZKMetadatas) {
      long endTime=resourceTimeUnit.convert(offlineSegmentZKMetadata.getEndTime(),offlineSegmentZKMetadata.getTimeUnit());
      maxTimeValue=Math.max(maxTimeValue,endTime);
    }
    TimeBoundaryInfo timeBoundaryInfo=new TimeBoundaryInfo();
    timeBoundaryInfo.setTimeColumn(offlineDataResourceZKMetadata.getTimeColumnName());
    timeBoundaryInfo.setTimeValue(Long.toString(maxTimeValue));
    _timeBoundaryInfoMap.put(resourceName,timeBoundaryInfo);
  }
}
