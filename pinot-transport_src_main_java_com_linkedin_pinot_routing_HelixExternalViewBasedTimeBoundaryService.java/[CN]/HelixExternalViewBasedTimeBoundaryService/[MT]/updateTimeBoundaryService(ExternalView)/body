{
  if (_propertyStore == null) {
    return;
  }
  String tableName=externalView.getResourceName();
  if (TableNameBuilder.getTableTypeFromTableName(tableName) == TableType.REALTIME) {
    return;
  }
  Set<String> offlineSegmentsServing=externalView.getPartitionSet();
  AbstractTableConfig offlineTableConfig=ZKMetadataProvider.getOfflineTableConfig(_propertyStore,tableName);
  TimeUnit tableTimeUnit=getTimeUnitFromString(offlineTableConfig.getValidationConfig().getTimeType());
  if (!offlineSegmentsServing.isEmpty() && tableTimeUnit != null) {
    long maxTimeValue=-1;
    for (    String segmentId : offlineSegmentsServing) {
      try {
        long endTime=-1;
        OfflineSegmentZKMetadata offlineSegmentZKMetadata=ZKMetadataProvider.getOfflineSegmentZKMetadata(_propertyStore,tableName,segmentId);
        if (offlineSegmentZKMetadata.getEndTime() > 0) {
          if (offlineSegmentZKMetadata.getTimeUnit() != null) {
            endTime=tableTimeUnit.convert(offlineSegmentZKMetadata.getEndTime(),offlineSegmentZKMetadata.getTimeUnit());
          }
 else {
            endTime=offlineSegmentZKMetadata.getEndTime();
          }
        }
        maxTimeValue=Math.max(maxTimeValue,endTime);
      }
 catch (      Exception e) {
        LOGGER.error("Error during convert end time for segment - " + segmentId + ", exceptions: "+ e);
      }
    }
    TimeBoundaryInfo timeBoundaryInfo=new TimeBoundaryInfo();
    timeBoundaryInfo.setTimeColumn(offlineTableConfig.getValidationConfig().getTimeColumnName());
    timeBoundaryInfo.setTimeValue(Long.toString(maxTimeValue));
    _timeBoundaryInfoMap.put(tableName,timeBoundaryInfo);
  }
}
