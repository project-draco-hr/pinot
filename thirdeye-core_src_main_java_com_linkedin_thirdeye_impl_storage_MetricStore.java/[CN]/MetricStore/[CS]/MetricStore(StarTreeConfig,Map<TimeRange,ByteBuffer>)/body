{
  this.config=config;
  this.buffers=buffers;
  this.metricSchema=MetricSchema.fromMetricSpecs(config.getMetrics());
  this.sync=new Object();
  this.timeRanges=new ArrayList<TimeRange>(buffers.keySet());
  Collections.sort(timeRanges);
}
