{
  realtimeSegmentImpl=realtimeSegment;
  this.outputPath=outputPath;
  if (new File(outputPath).exists()) {
    throw new IllegalAccessError("path already exists");
  }
  this.resourceName=resourceName;
  this.tableName=tableName;
  this.segmentName=segmentName;
  TimeFieldSpec original=schema.getTimeSpec();
  TimeGranularitySpec incoming=original.getIncomingGranularitySpec();
  TimeFieldSpec newTimeSpec=new TimeFieldSpec(incoming);
  Schema newSchema=new Schema();
  for (  String dimension : schema.getDimensionNames()) {
    newSchema.addSchema(dimension,schema.getFieldSpecFor(dimension));
  }
  for (  String metic : schema.getMetricNames()) {
    newSchema.addSchema(metic,schema.getFieldSpecFor(metic));
  }
  newSchema.addSchema(newTimeSpec.getName(),newTimeSpec);
  this.dataSchema=newSchema;
  this.sortedColumn=sortedColumn;
}
