{
  List<String> metricNames=new ArrayList<String>(config.getMetrics().size());
  List<MetricType> metricTypes=new ArrayList<MetricType>(config.getMetrics().size());
  for (  MetricSpec spec : config.getMetrics()) {
    metricNames.add(spec.getName());
    metricTypes.add(spec.getType());
  }
  List<String> dimensionNames=new ArrayList<String>(config.getDimensions().size());
  for (  DimensionSpec dimensionSpec : config.getDimensions()) {
    dimensionNames.add(dimensionSpec.getName());
  }
  Map<String,Double> metricThresholds=new HashMap<>();
  if (config.getTopKRollup() != null && config.getTopKRollup().getThreshold() != null) {
    metricThresholds=config.getTopKRollup().getThreshold();
  }
  for (  String metric : metricNames) {
    if (metricThresholds.get(metric) == null) {
      metricThresholds.put(metric,0.0);
    }
  }
  Map<String,List<String>> dimensionExceptions=new HashMap<>();
  Map<String,String> exceptions=config.getTopKRollup().getExceptions();
  if (exceptions != null) {
    for (    Entry<String,String> entry : exceptions.entrySet()) {
      dimensionExceptions.put(entry.getKey(),Arrays.asList(entry.getValue().split(",")));
    }
  }
  return new TopKRollupPhaseOneConfig(dimensionNames,metricNames,metricTypes,metricThresholds,dimensionExceptions);
}
