{
  CollectionConfig collectionConfig=null;
  try {
    collectionConfig=CACHE_REGISTRY_INSTANCE.getCollectionConfigCache().get(collection);
  }
 catch (  InvalidCacheLoadException|ExecutionException e) {
    LOG.debug("No collection configs for collection {}",collection);
  }
  if (collectionConfig != null && collectionConfig.getDerivedMetrics() != null && collectionConfig.getDerivedMetrics().containsKey(metricsJson)) {
    metricsJson=collectionConfig.getDerivedMetrics().get(metricsJson);
  }
  List<MetricExpression> metricExpressions=new ArrayList<>();
  if (metricsJson == null) {
    return metricExpressions;
  }
  ArrayList<String> metricExpressionStrings;
  try {
    TypeReference<ArrayList<String>> valueTypeRef=new TypeReference<ArrayList<String>>(){
    }
;
    metricExpressionStrings=OBJECT_MAPPER.readValue(metricsJson,valueTypeRef);
  }
 catch (  Exception e) {
    LOG.error("Error parsing metrics json: {} errorMessage:{}",metricsJson,e.getMessage());
    metricExpressionStrings=new ArrayList<>();
    String[] metrics=metricsJson.split(",");
    for (    String metric : metrics) {
      metricExpressionStrings.add(metric);
    }
  }
  for (  String metricExpressionString : metricExpressionStrings) {
    metricExpressions.add(new MetricExpression(metricExpressionString));
  }
  return metricExpressions;
}
