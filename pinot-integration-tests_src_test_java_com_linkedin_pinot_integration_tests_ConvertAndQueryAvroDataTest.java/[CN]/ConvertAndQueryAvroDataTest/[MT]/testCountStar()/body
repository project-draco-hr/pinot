{
  JSONObject response=postQuery("select count(*) from 'myresource.mytable'");
  System.out.println("response = " + response);
  Assert.assertEquals("5819811",response.getJSONArray("aggregationResults").getJSONObject(0).getString("value"));
  Map<String,String> correctValues=new HashMap<String,String>();
  correctValues.put("AA","537697");
  correctValues.put("AS","160257");
  correctValues.put("B6","249693");
  correctValues.put("DL","800375");
  correctValues.put("EV","686021");
  correctValues.put("F9","85474");
  correctValues.put("FL","79495");
  correctValues.put("HA","74732");
  correctValues.put("MQ","392701");
  correctValues.put("OO","613030");
  correctValues.put("UA","493528");
  correctValues.put("US","414665");
  correctValues.put("VX","57510");
  correctValues.put("WN","1174633");
  Map<String,String> actualValues=new HashMap<String,String>();
  response=postQuery("select count(*) from 'myresource.mytable' group by Carrier");
  JSONArray aggregationResults=response.getJSONArray("aggregationResults").getJSONObject(0).getJSONArray("groupByResult");
  for (int i=0; i < aggregationResults.length(); ++i) {
    actualValues.put(aggregationResults.getJSONObject(i).getJSONArray("group").getString(0),aggregationResults.getJSONObject(i).getString("value"));
  }
  Assert.assertEquals(actualValues,correctValues);
}
