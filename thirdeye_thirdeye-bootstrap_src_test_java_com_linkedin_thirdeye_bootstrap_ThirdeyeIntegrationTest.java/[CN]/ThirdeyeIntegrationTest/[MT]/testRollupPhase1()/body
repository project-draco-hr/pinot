{
  LOGGER.info("Starting rollup_phase1 job");
  Job job=Job.getInstance(conf);
  job.setJobName("RollupPhase1Test");
  job.setJarByClass(RollupPhaseOneJob.class);
  job.setMapperClass(RollupPhaseOneMapper.class);
  job.setInputFormatClass(SequenceFileInputFormat.class);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(BytesWritable.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(BytesWritable.class);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  job.setNumReduceTasks(0);
  Configuration configuration=job.getConfiguration();
  configuration.set(ROLLUP_PHASE1_INPUT_PATH.toString(),aggregationOutputPath.toString());
  configuration.set(ROLLUP_PHASE1_CONFIG_PATH.toString(),configFilePath.toString());
  configuration.set(ROLLUP_PHASE1_OUTPUT_PATH.toString(),rollupPhase1OutputPath.toString());
  FileInputFormat.addInputPath(job,new Path(configuration.get(ROLLUP_PHASE1_INPUT_PATH.toString())));
  MultipleOutputs.addNamedOutput(job,"aboveThreshold",SequenceFileOutputFormat.class,BytesWritable.class,BytesWritable.class);
  MultipleOutputs.addNamedOutput(job,"belowThreshold",SequenceFileOutputFormat.class,BytesWritable.class,BytesWritable.class);
  FileOutputFormat.setOutputPath(job,new Path(configuration.get(ROLLUP_PHASE1_OUTPUT_PATH.toString())));
  job.waitForCompletion(true);
  assertTrue("rollup_phase1 job failed",job.isSuccessful());
  assertTrue("rollup_phase1 folder not created",fs.exists(rollupPhase1OutputPath));
  assertTrue("aboveThreshold folder not created",fs.exists(aboveThresholdPath));
  assertTrue("belowThreshold folder not created",fs.exists(belowThresholdPath));
  FileStatus[] aboveThresholdStatus=fs.listStatus(aboveThresholdPath,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().startsWith("above");
    }
  }
);
  FileStatus[] belowThresholdStatus=fs.listStatus(belowThresholdPath,new PathFilter(){
    @Override public boolean accept(    Path path){
      return path.getName().startsWith("below");
    }
  }
);
  assertTrue("aboveThreshold data not generated",aboveThresholdStatus.length != 0);
  assertTrue("belowThreshold data not generated",belowThresholdStatus.length != 0);
  LOGGER.info("rollup_phase1 job completed");
}
