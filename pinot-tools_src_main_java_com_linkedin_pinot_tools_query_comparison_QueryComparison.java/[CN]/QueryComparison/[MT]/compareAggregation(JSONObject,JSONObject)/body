{
  if ((clusterJson.getJSONArray(AGGREGATION_RESULTS).length() == 0) && !scanJson.has(AGGREGATION_RESULTS)) {
    return true;
  }
  if (!compareNumDocsScanned(clusterJson,scanJson)) {
    return false;
  }
  JSONArray clusterAggregation=clusterJson.getJSONArray(AGGREGATION_RESULTS);
  if (clusterAggregation.length() == 0) {
    return true;
  }
  if (clusterAggregation.getJSONObject(0).has(GROUP_BY_RESULT)) {
    return compareAggregationGroupBy(clusterJson,scanJson);
  }
  JSONArray scanAggregation=scanJson.getJSONArray(AGGREGATION_RESULTS);
  return compareAggregationArrays(clusterAggregation,scanAggregation);
}
