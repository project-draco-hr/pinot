{
  if ((actualJson.getJSONArray(AGGREGATION_RESULTS).length() == 0) && !expectedJson.has(AGGREGATION_RESULTS)) {
    return true;
  }
  if (_compareNumDocs && !compareNumDocsScanned(actualJson,expectedJson)) {
    return false;
  }
  JSONArray actualAggregation=actualJson.getJSONArray(AGGREGATION_RESULTS);
  if (actualAggregation.length() == 0) {
    return true;
  }
  if (actualAggregation.getJSONObject(0).has(GROUP_BY_RESULT)) {
    return compareAggregationGroupBy(actualJson,expectedJson);
  }
  JSONArray expectedAggregation=expectedJson.getJSONArray(AGGREGATION_RESULTS);
  return compareAggregationArrays(actualAggregation,expectedAggregation);
}
