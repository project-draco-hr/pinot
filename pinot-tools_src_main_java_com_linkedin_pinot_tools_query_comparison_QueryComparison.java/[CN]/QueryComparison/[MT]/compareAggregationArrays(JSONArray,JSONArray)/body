{
  Map<String,Double> map=new HashMap<>();
  for (int i=0; i < refAggregation.length(); ++i) {
    JSONObject object=refAggregation.getJSONObject(i);
    map.put(object.getString(FUNCTION).toLowerCase(),Double.valueOf(object.getString(VALUE)));
  }
  for (int i=0; i < flowAggregation.length(); ++i) {
    JSONObject object=flowAggregation.getJSONObject(i);
    String function=object.getString(FUNCTION).toLowerCase();
    String valueString=object.getString(VALUE);
    if (!isNumeric(valueString)) {
      LOGGER.warn("Found non-numeric value for aggregation ignoring Function: {} Value: {}",function,valueString);
      continue;
    }
    Double value=Double.valueOf(valueString);
    if (!map.containsKey(function)) {
      LOGGER.error("Ref Response does not contain function {}",function);
      return false;
    }
    Double refValue=map.get(function);
    if (!fuzzyEqual(value,refValue)) {
      LOGGER.error("Aggregation value mismatch for function {}, {}, {}",function,value,refValue);
      return false;
    }
  }
  return true;
}
