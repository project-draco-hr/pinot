{
  startCluster();
  String query;
  ScanBasedQueryProcessor scanBasedQueryProcessor=new ScanBasedQueryProcessor(_segmentsDir.getAbsolutePath());
  BufferedReader bufferedReader=new BufferedReader(new FileReader(_queryFile));
  int passed=0;
  int total=0;
  while ((query=bufferedReader.readLine()) != null) {
    if (query.isEmpty() || query.startsWith("#")) {
      continue;
    }
    try {
      QueryResponse scanResponse=scanBasedQueryProcessor.processQuery(query);
      JSONObject scanJson=new JSONObject(new ObjectMapper().writeValueAsString(scanResponse));
      String clusterResponse=_clusterStarter.query(query);
      JSONObject clusterJson=new JSONObject(clusterResponse);
      if (compare(clusterJson,scanJson)) {
        ++passed;
        LOGGER.info("Comparison PASSED: {}",query);
      }
 else {
        LOGGER.error("Comparison FAILED: {}",query);
        LOGGER.info("Cluster Response: {}",clusterJson);
        LOGGER.info("Scan Response: {}",scanJson);
      }
      ++total;
    }
 catch (    Exception e) {
      LOGGER.error("Exception caught while processing query: '{}'",query,e);
    }
  }
  LOGGER.info("Total {} out of {} queries passed.",passed,total);
}
