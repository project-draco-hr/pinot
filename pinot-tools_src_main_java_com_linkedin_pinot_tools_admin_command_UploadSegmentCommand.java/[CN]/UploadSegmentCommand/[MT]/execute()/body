{
  if (_controllerHost == null) {
    _controllerHost=NetUtil.getHostAddress();
  }
  LOGGER.info("Executing command: " + toString());
  File dir=new File(_segmentDir);
  File[] files=dir.listFiles();
  for (  File file : files) {
    File tgzFile=file;
    boolean cleanTmpFile=false;
    if (file.isDirectory()) {
      String srcDir=file.getAbsolutePath();
      String tgzFileName=TarGzCompressionUtils.createTarGzOfDirectory(srcDir);
      tgzFile=new File(tgzFileName);
      cleanTmpFile=true;
    }
    FileUploadUtils.sendSegmentFile(_controllerHost,_controllerPort,tgzFile.getName(),new FileInputStream(tgzFile),tgzFile.length());
    if (cleanTmpFile) {
      FileUtils.deleteQuietly(tgzFile);
    }
  }
  return true;
}
