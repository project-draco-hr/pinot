{
  if (_controllerHost == null) {
    _controllerHost=NetUtil.getHostAddress();
  }
  LOGGER.info("Executing command: " + toString());
  File dir=new File(_segmentDir);
  File[] files=dir.listFiles();
  for (  File file : files) {
    if (!file.isDirectory()) {
      continue;
    }
    String srcDir=file.getAbsolutePath();
    String outFile=TarGzCompressionUtils.createTarGzOfDirectory(srcDir);
    File tgzFile=new File(outFile);
    FileUploadUtils.sendSegmentFile(_controllerHost,_controllerPort,tgzFile.getName(),new FileInputStream(tgzFile),tgzFile.length());
    FileUtils.deleteQuietly(tgzFile);
  }
  return true;
}
