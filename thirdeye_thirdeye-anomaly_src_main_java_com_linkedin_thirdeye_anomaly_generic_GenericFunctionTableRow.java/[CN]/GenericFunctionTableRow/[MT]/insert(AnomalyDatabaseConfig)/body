{
  Connection conn=null;
  PreparedStatement preparedStmt=null;
  try {
    conn=dbConfig.getConnection();
    preparedStmt=conn.prepareStatement(String.format(ResourceUtils.getResourceAsString("database/generic/insert-function-template.sql"),dbConfig.getFunctionTableName()));
    preparedStmt.setString(1,getFunctionName());
    preparedStmt.setString(2,getFunctionDescription());
    preparedStmt.setString(3,getCollectionName());
    preparedStmt.setString(4,getJarUrl());
    preparedStmt.setString(5,getClassName());
    preparedStmt.setString(6,getFunctionProperties());
    preparedStmt.executeUpdate();
  }
 catch (  SQLException e) {
    throw e;
  }
 finally {
    try {
      if (conn != null) {
        conn.close();
      }
      if (preparedStmt != null) {
        preparedStmt.close();
      }
    }
 catch (    SQLException e) {
      LOGGER.error("close exception",e);
    }
  }
}
