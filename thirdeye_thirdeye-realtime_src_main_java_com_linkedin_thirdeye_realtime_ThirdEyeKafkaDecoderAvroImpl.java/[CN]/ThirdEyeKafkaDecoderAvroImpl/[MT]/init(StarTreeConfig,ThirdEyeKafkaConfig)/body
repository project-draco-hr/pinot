{
  this.starTreeConfig=starTreeConfig;
  this.decoderThreadLocal=new ThreadLocal<BinaryDecoder>();
  String schemaUri=kafkaConfig.getDecoderConfig().getProperty(PROP_SCHEMA_URI);
  if (schemaUri == null) {
    throw new IllegalStateException("Must provide " + PROP_SCHEMA_URI);
  }
  InputStream schemaInputStream=URI.create(schemaUri).toURL().openStream();
  Schema schema=Schema.parse(schemaInputStream);
  schemaInputStream.close();
  LOG.info("Init decoder for {} with schema {}",starTreeConfig.getCollection(),schema);
  this.datumReader=new GenericDatumReader<GenericRecord>(schema);
  String recordOffsetProp=kafkaConfig.getDecoderConfig().getProperty(PROP_RECORD_OFFSET);
  if (recordOffsetProp != null) {
    this.recordOffset=Integer.valueOf(recordOffsetProp);
  }
}
