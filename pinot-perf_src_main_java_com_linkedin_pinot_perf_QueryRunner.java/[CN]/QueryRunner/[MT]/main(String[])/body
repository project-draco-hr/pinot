{
  String queryFile=null;
  if (args.length >= 1) {
    queryFile=args[0];
  }
 else {
    System.out.println("QueryRunner <queryFile> <brokerHost(optional. default=localhost)> <brokerPort (optional. default=8099)> <mode(optional.(single-threaded(optional)|multi-threaded))>)");
    System.exit(1);
  }
  String brokerHost=null;
  String brokerPort=null;
  if (args.length >= 3) {
    brokerHost=args[1];
    brokerPort=args[2];
  }
  boolean multiThreaded=false;
  if (args.length >= 4) {
    if ("multi-threaded".equals(args[3])) {
      multiThreaded=true;
    }
  }
  PerfBenchmarkDriverConf conf=new PerfBenchmarkDriverConf();
  if (brokerHost != null) {
    conf.setBrokerHost(brokerHost);
    conf.setBrokerPort(Integer.parseInt(brokerPort));
  }
  conf.setStartBroker(false);
  conf.setStartController(false);
  conf.setStartServer(false);
  conf.setStartZookeeper(false);
  conf.setUploadIndexes(false);
  conf.setRunQueries(true);
  conf.setConfigureResources(false);
  if (multiThreaded) {
    multiThreadedQueryRunner(conf,queryFile);
  }
 else {
    singleThreadedQueryRunner(conf,queryFile);
  }
}
