{
  List<Long> times=new ArrayList<Long>(timeSeries.getTimeWindowSet());
  Collections.sort(times);
  for (  Long time : times) {
    buffer.putLong(time);
    for (    MetricSpec metricSpec : config.getMetrics()) {
      Number value=timeSeries.get(time,metricSpec.getName());
      NumberUtils.addToBuffer(buffer,value,metricSpec.getType());
    }
  }
}
