{
  Map<String,RetentionStrategy> tableToDeletionStrategyMap=new HashMap<String,RetentionStrategy>();
  AbstractTableConfig offlineTableConfig;
  try {
    offlineTableConfig=ZKMetadataProvider.getOfflineTableConfig(_pinotHelixResourceManager.getPropertyStore(),offlineTableName);
  }
 catch (  Exception e) {
    LOGGER.error("Error getting offline table config from property store!");
    return tableToDeletionStrategyMap;
  }
  if (offlineTableConfig.getValidationConfig().getSegmentPushType().equalsIgnoreCase("REFRESH")) {
    LOGGER.info("Table: " + offlineTableName + " is a fresh only table.");
    return tableToDeletionStrategyMap;
  }
  try {
    TimeRetentionStrategy timeRetentionStrategy=new TimeRetentionStrategy(offlineTableConfig.getValidationConfig().getRetentionTimeUnit(),offlineTableConfig.getValidationConfig().getRetentionTimeValue());
    tableToDeletionStrategyMap.put(offlineTableName,timeRetentionStrategy);
  }
 catch (  Exception e) {
    LOGGER.error("Error creating TimeRetentionStrategy for table: " + offlineTableName + ", Exception: "+ e);
  }
  return tableToDeletionStrategyMap;
}
