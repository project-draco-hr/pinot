{
  ThirdEyeAnomalyDetectionConfiguration config=collectionToConfigMap.get(collection);
  List<String> columns=new ArrayList<String>(formParams.keySet());
  List<String> values=new ArrayList<String>(columns.size());
  for (  String column : columns) {
    values.add("\"" + formParams.getFirst(column) + "\"");
  }
  String sql=String.format(ResourceUtils.getResourceAsString("database/rulebased/insert-update-delta-template.sql"),deltaTableName,COMMA.join(columns),COMMA.join(values));
  try {
    config.getAnomalyDatabaseConfig().runSQL(sql);
  }
 catch (  SQLException e) {
    return Response.serverError().entity("An error occurred").build();
  }
  return Response.ok().entity(formResponseHtmlHelper("Success!",SLASH.join("",collection,"rulebased","deltatable",deltaTableName))).build();
}
