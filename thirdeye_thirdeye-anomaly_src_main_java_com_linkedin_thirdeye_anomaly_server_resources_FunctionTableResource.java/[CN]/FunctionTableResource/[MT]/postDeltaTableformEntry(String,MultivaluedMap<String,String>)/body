{
  List<String> columns=new ArrayList<String>(formParams.keySet());
  List<String> values=new ArrayList<String>(columns.size());
  for (  String column : columns) {
    values.add("\"" + formParams.getFirst(column) + "\"");
  }
  String sql=String.format(ResourceUtils.getResourceAsString("database/rulebased/insert-update-delta-template.sql"),deltaTableName,COMMA.join(columns),COMMA.join(values));
  if (!config.getAnomalyDatabaseConfig().runSQL(sql)) {
    return Response.serverError().entity("An error occurred").build();
  }
  return Response.ok().entity(formResponseHtmlHelper("Success!","/rulebased/deltatable/" + deltaTableName)).build();
}
