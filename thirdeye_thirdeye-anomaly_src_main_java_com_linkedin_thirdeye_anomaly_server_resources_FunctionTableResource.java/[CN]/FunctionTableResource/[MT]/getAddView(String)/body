{
  ThirdEyeAnomalyDetectionConfiguration config=collectionToConfigMap.get(collection);
switch (config.getMode()) {
case GENERIC:
    return new AddGenericView(config.getAnomalyDatabaseConfig().getUrl(),config.getAnomalyDatabaseConfig().getFunctionTableName(),config.getCollectionName(),SLASH.join("",collection,"functions","add"));
case RULEBASED:
  return new AddRuleBasedView(config.getAnomalyDatabaseConfig().getUrl(),config.getAnomalyDatabaseConfig().getFunctionTableName(),config.getCollectionName(),SLASH.join("",collection,"functions","add"));
default :
throw new IllegalStateException();
}
}
