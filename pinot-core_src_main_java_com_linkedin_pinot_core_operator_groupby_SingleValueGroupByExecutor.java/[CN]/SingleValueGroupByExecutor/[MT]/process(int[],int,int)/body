{
  Preconditions.checkState(_init,"process cannot be called before init.");
  Preconditions.checkArgument(length <= _docIdToGroupKey.length);
  _groupKeyGenerator.generateKeysForDocIdSet(docIdSet,startIndex,length,_docIdToGroupKey);
  int maxUniqueKeys=_groupKeyGenerator.getMaxUniqueKeys();
  fetchColumnValues(docIdSet,startIndex,length);
  for (int i=0; i < _aggrFuncContextList.size(); i++) {
    AggregationFunctionContext aggrFuncContext=_aggrFuncContextList.get(i);
    String[] aggrColumns=aggrFuncContext.getAggregationColumns();
    _resultHolderArray[i].ensureCapacity(maxUniqueKeys);
    for (int j=0; j < aggrColumns.length; j++) {
      String aggrColumn=aggrColumns[j];
      double[] valueArray=_columnToValueArrayMap.get(aggrColumn);
      aggrFuncContext.apply(length,_docIdToGroupKey,_resultHolderArray[i],valueArray);
    }
  }
}
