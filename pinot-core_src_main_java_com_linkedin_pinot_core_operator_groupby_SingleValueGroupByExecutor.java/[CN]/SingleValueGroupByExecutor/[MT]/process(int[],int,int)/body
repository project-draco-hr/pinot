{
  Preconditions.checkState(_inited,"process cannot be called before init.");
  Preconditions.checkArgument(length <= _docIdToGroupKey.length);
  _groupKeyGenerator.generateKeysForDocIdSet(docIdSet,startIndex,length,_docIdToGroupKey);
  int numGroupKeys=_groupKeyGenerator.getNumGroupKeys();
  fetchColumnValues(docIdSet,startIndex,length);
  for (int i=0; i < _aggrFuncContextList.size(); i++) {
    AggregationFunctionContext aggrFuncContext=_aggrFuncContextList.get(i);
    _resultHolderArray[i].ensureCapacity(numGroupKeys);
    if (aggrFuncContext.getFunctionName().equalsIgnoreCase("count")) {
      aggrFuncContext.apply(length,_docIdToGroupKey,_resultHolderArray[i]);
    }
 else {
      String[] aggrColumns=aggrFuncContext.getAggregationColumns();
      for (int j=0; j < aggrColumns.length; j++) {
        String aggrColumn=aggrColumns[j];
        double[] valueArray=_columnToValueArrayMap.get(aggrColumn);
        aggrFuncContext.apply(length,_docIdToGroupKey,_resultHolderArray[i],valueArray);
      }
    }
  }
}
