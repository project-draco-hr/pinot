{
  Map<DimensionKey,Integer> matches=new HashMap<DimensionKey,Integer>();
  Integer existingDocId=dimensionKeys.get(dimensionKey);
  if (existingDocId == null) {
    dimensionKeys.putIfAbsent(dimensionKey,nextDocId.getAndIncrement());
    for (int i=0; i < dimensions.size(); i++) {
      String name=dimensions.get(i).getName();
      String value=dimensionKey.getDimensionValues()[i];
      dictionary.add(name,value,nextValueId.getAndIncrement());
    }
  }
  for (  Map.Entry<DimensionKey,Integer> entry : dimensionKeys.entrySet()) {
    if (dimensionKey.matches(entry.getKey())) {
      matches.put(entry.getKey(),entry.getValue());
    }
  }
  return matches;
}
