{
  buffer.rewind();
  for (  Integer logicalOffset : logicalOffsets) {
    buffer.position(logicalOffset * (4 + 4));
    int startOffset=buffer.getInt();
    int length=buffer.getInt();
    if (length == 0) {
      continue;
    }
    buffer.position(startOffset);
    long minTime=buffer.getLong();
    int middle=0;
    long timeRangeStartValue=timeRange.getStart();
    if (useBinarySearch) {
      middle=findStartIndex(buffer,startOffset,length,minTime,timeRangeStartValue);
    }
    if (middle == -1) {
      continue;
    }
    for (int i=middle; i < length; i++) {
      buffer.position(startOffset + (i * sizePerEntry));
      Long time=buffer.getLong();
      if (times.contains(time)) {
        for (        MetricSpec metricSpec : config.getMetrics()) {
          Number value=NumberUtils.readFromBuffer(buffer,metricSpec.getType());
          timeSeries.increment(time,metricSpec.getName(),value);
        }
      }
      if (time >= timeRange.getEnd()) {
        break;
      }
    }
  }
}
