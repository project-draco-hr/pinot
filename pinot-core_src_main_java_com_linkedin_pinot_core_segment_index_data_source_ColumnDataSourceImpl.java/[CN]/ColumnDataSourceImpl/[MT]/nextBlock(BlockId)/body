{
  Block b=null;
  if (columnMetadata.isSingleValue()) {
    if (columnMetadata.isSorted()) {
      b=new SingleValueBlockWithSortedInvertedIndex(blockId,(FixedBitCompressedSVForwardIndexReader)reader,invertedIndex,dictionary,columnMetadata);
    }
 else {
      b=new SingleValueBlockWithBitmapInvertedIndex(blockId,(FixedBitCompressedSVForwardIndexReader)reader,invertedIndex,dictionary,columnMetadata);
    }
  }
 else {
    b=new MultiValueBlockWithBitmapInvertedIndex(blockId,(FixedBitCompressedMVForwardIndexReader)reader,invertedIndex,dictionary,columnMetadata);
  }
  if (predicate != null) {
    b.applyPredicate(predicate);
  }
  return b;
}
