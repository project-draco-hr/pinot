{
  Block b=null;
  if (indexContainer.getColumnMetadata().isSingleValue()) {
    if (indexContainer.getColumnMetadata().isSorted()) {
      b=new SingleValueBlockWithSortedInvertedIndex(blockId,(SortedForwardIndexReader)indexContainer.getForwardIndex(),indexContainer.getInvertedIndex(),indexContainer.getDictionary(),indexContainer.getColumnMetadata());
    }
 else {
      b=new SingleValueBlockWithBitmapInvertedIndex(blockId,(FixedBitCompressedSVForwardIndexReader)indexContainer.getForwardIndex(),indexContainer.getInvertedIndex(),indexContainer.getDictionary(),indexContainer.getColumnMetadata());
    }
  }
 else {
    b=new MultiValueBlockWithBitmapInvertedIndex(blockId,(FixedBitCompressedMVForwardIndexReader)indexContainer.getForwardIndex(),indexContainer.getInvertedIndex(),indexContainer.getDictionary(),indexContainer.getColumnMetadata());
  }
  if (predicate != null) {
    b.applyPredicate(predicate);
  }
  return b;
}
