{
  _segmentDirName=segmentDirName;
  File segmentsDir=new File(_segmentDirName);
  Set<String> uniqueDimensions=new HashSet<>();
  Set<String> uniqueMetrics=new HashSet<>();
  Map<String,Set<String>> uniqueColumnValues=new HashMap<>();
  for (  File segment : segmentsDir.listFiles()) {
    readOneSegment(segment,uniqueDimensions,uniqueMetrics,uniqueColumnValues);
  }
  _dimensionColumns=new ArrayList<>(uniqueDimensions);
  _metricColumns=new ArrayList<>(uniqueMetrics);
  _columnValuesMap=new HashMap<>(uniqueColumnValues.size());
  for (  Map.Entry<String,Set<String>> entry : uniqueColumnValues.entrySet()) {
    _columnValuesMap.put(entry.getKey(),new ArrayList<>(entry.getValue()));
  }
}
