{
  final File tempDir=new File("/tmp/Pql2CompilerTest");
  tempDir.mkdirs();
  TarGzCompressionUtils.unTar(new File(TestUtils.getFileFromResourceUrl(OfflineClusterIntegrationTest.class.getClassLoader().getResource("On_Time_On_Time_Performance_2014_100k_subset_nonulls.tar.gz"))),tempDir);
  try {
    File avroFile=new File(tempDir,"On_Time_On_Time_Performance_2014_1.avro");
    QueryGenerator qg=new QueryGenerator(Collections.singletonList(avroFile),"whatever","whatever");
    PQLCompiler pql1Compiler=new PQLCompiler(new HashMap<>());
    Pql2Compiler pql2Compiler=new Pql2Compiler();
    for (int i=1; i <= 1000000; i++) {
      String pql=qg.generateQuery().generatePql();
      testQuery(pql1Compiler,pql2Compiler,pql);
    }
  }
  finally {
    FileUtils.deleteQuietly(tempDir);
  }
}
