{
  if (brokerRequest.isSetAggregationsInfo()) {
    if (!brokerRequest.isSetGroupBy()) {
      PlanNode aggregationPlanNode=new AggregationPlanNode(indexSegment,brokerRequest);
      return aggregationPlanNode;
    }
 else {
      PlanNode aggregationGroupByPlanNode=new AggregationGroupByOperatorPlanNode(indexSegment,brokerRequest,AggregationGroupByImplementationType.NoDictionary);
      return aggregationGroupByPlanNode;
    }
  }
  if (brokerRequest.isSetSelections()) {
    PlanNode selectionPlanNode=new SelectionPlanNode(indexSegment,brokerRequest);
    return selectionPlanNode;
  }
  throw new UnsupportedOperationException("The query contains no aggregation or selection!");
}
