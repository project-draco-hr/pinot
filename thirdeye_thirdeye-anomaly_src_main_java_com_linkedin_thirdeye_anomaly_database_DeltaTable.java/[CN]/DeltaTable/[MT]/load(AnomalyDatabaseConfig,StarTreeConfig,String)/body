{
  Connection conn=null;
  Statement stmt=null;
  ResultSet rs=null;
  try {
    conn=dbConfig.getConnection();
    stmt=conn.createStatement();
    rs=stmt.executeQuery(buildDeltaTableQuery(deltaTableName));
    DimensionKeyMatchTable<Double> result=new DimensionKeyMatchTable<>(starTreeConfig.getDimensions());
    List<DimensionSpec> dimensions=starTreeConfig.getDimensions();
    while (rs.next()) {
      double delta=rs.getDouble(COLUMN_NAME_DELTA);
      String[] dimensionValues=new String[dimensions.size()];
      for (int i=0; i < dimensions.size(); i++) {
        dimensionValues[i]=rs.getString(dimensions.get(i).getName());
      }
      result.put(new DimensionKey(dimensionValues),delta);
    }
    return result;
  }
 catch (  SQLException e) {
    LOGGER.error("could not get delta table",e);
  }
 finally {
    try {
      if (conn != null) {
        conn.close();
      }
      if (stmt != null) {
        stmt.close();
      }
      if (rs != null) {
        rs.close();
      }
    }
 catch (    SQLException e) {
      e.printStackTrace();
    }
  }
  throw new IllegalFunctionException("failed to load delta_table : " + deltaTableName);
}
