{
  List<String> dimensionNames=new ArrayList<String>(starTreeConfig.getDimensions().size());
  for (  DimensionSpec dimension : starTreeConfig.getDimensions()) {
    dimensionNames.add(dimension.getName());
  }
  int columnWidth=MYSQL_PRIMARY_KEY_LIMIT / starTreeConfig.getDimensions().size();
  StringBuilder sb=new StringBuilder();
  sb.append("CREATE TABLE IF NOT EXISTS ").append(deltaTableName).append("(\n");
  sb.append("delta DOUBLE NOT NULL,\n");
  for (  String dimensionName : dimensionNames) {
    sb.append(String.format("%s VARCHAR(%d) NOT NULL DEFAULT \"?\",\n",dimensionName,columnWidth));
  }
  sb.append("PRIMARY KEY(").append(COMMA.join(dimensionNames)).append("));");
  String sql=sb.toString();
  LOGGER.info("creating delta table if not exists - {}",deltaTableName);
  try {
    dbConfig.runSQL(sql);
  }
 catch (  SQLException e) {
  }
}
