{
  LOGGER.info("Trying to delete segment: {} for table: {} ",segmentId,tableName);
  final PinotResourceManagerResponse res=new PinotResourceManagerResponse();
  try {
    IdealState idealState=_helixAdmin.getResourceIdealState(_helixClusterName,tableName);
    if (idealState.getPartitionSet().contains(segmentId)) {
      LOGGER.info("Trying to delete segment: {} from IdealStates",segmentId);
      idealState=PinotTableIdealStateBuilder.dropSegmentFromIdealStateFor(tableName,segmentId,_helixAdmin,_helixClusterName);
      _helixAdmin.setResourceIdealState(_helixClusterName,tableName,idealState);
      idealState=PinotTableIdealStateBuilder.removeSegmentFromIdealStateFor(tableName,segmentId,_helixAdmin,_helixClusterName);
      _helixAdmin.setResourceIdealState(_helixClusterName,tableName,idealState);
    }
 else {
      res.message="Segment " + segmentId + " not in IDEALSTATE.";
      LOGGER.info("Segment: {} is not in IDEALSTATE",segmentId);
    }
    _segmentDeletionManager.deleteSegment(tableName,segmentId);
    res.message="Segment successfully deleted.";
    res.status=ResponseStatus.success;
  }
 catch (  final Exception e) {
    LOGGER.error("Caught exception while deleting segment",e);
    res.status=ResponseStatus.failure;
    res.message=e.getMessage();
  }
  return res;
}
