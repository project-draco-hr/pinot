{
  LOGGER.info("Trying to delete segment: {} for resource: {} ",segmentId,resourceName);
  final PinotResourceManagerResponse res=new PinotResourceManagerResponse();
  try {
    IdealState idealState=_helixAdmin.getResourceIdealState(_helixClusterName,resourceName);
    if (idealState.getPartitionSet().contains(segmentId)) {
      LOGGER.info("Trying to delete segment: {} from IdealStates",segmentId);
      idealState=PinotResourceIdealStateBuilder.dropSegmentFromIdealStateFor(resourceName,segmentId,_helixAdmin,_helixClusterName);
      _helixAdmin.setResourceIdealState(_helixClusterName,resourceName,idealState);
      idealState=PinotResourceIdealStateBuilder.removeSegmentFromIdealStateFor(resourceName,segmentId,_helixAdmin,_helixClusterName);
      _helixAdmin.setResourceIdealState(_helixClusterName,resourceName,idealState);
    }
 else {
      LOGGER.info("Segment: {} is not in IdealStates",segmentId);
    }
    _segmentDeletionManager.deleteSegment(resourceName,segmentId);
    res.status=STATUS.success;
  }
 catch (  final Exception e) {
    res.status=STATUS.failure;
    res.errorMessage=e.getMessage();
  }
  return res;
}
