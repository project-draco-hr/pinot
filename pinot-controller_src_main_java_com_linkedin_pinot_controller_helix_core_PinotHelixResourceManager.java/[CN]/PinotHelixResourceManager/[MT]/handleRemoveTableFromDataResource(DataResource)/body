{
  final PinotResourceManagerResponse resp=new PinotResourceManagerResponse();
  final Set<String> tableNames=getAllTableNamesForResource(resource.getResourceName());
  if (!tableNames.contains(resource.getTableName())) {
    resp.status=STATUS.failure;
    resp.errorMessage=String.format("Table name (%s) is not existed in resource (%s)",resource.getTableName(),resource.getResourceName());
    return resp;
  }
  tableNames.remove(resource.getTableName());
  final Map<String,String> tableConfig=new HashMap<String,String>();
  tableConfig.put("tableName",StringUtils.join(tableNames,","));
  HelixHelper.updateResourceConfigsFor(tableConfig,resource.getResourceName(),_helixClusterName,_helixAdmin);
  deleteSegmentsInTable(resource.getResourceName(),resource.getTableName());
  resp.status=STATUS.success;
  resp.errorMessage=String.format("Removing table name (%s) from resource (%s)",resource.getTableName(),resource.getResourceName());
  return resp;
}
