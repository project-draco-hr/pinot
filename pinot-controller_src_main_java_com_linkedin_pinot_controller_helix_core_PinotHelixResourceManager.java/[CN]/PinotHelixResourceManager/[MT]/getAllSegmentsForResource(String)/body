{
  List<String> segmentsInResource=new ArrayList<String>();
switch (BrokerRequestUtils.getResourceTypeFromResourceName(resourceName)) {
case REALTIME:
    for (    RealtimeSegmentZKMetadata segmentZKMetadata : ZKMetadataProvider.getRealtimeResourceZKMetadataListForResource(getPropertyStore(),resourceName)) {
      segmentsInResource.add(segmentZKMetadata.getSegmentName());
    }
  break;
case OFFLINE:
for (OfflineSegmentZKMetadata segmentZKMetadata : ZKMetadataProvider.getOfflineResourceZKMetadataListForResource(getPropertyStore(),resourceName)) {
  segmentsInResource.add(segmentZKMetadata.getSegmentName());
}
break;
default :
break;
}
return segmentsInResource;
}
