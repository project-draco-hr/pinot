{
  List<String> segmentsInTable=new ArrayList<String>();
switch (BrokerRequestUtils.getResourceTypeFromResourceName(resourceName)) {
case REALTIME:
    for (    RealtimeSegmentZKMetadata segmentZKMetadata : ZKMetadataProvider.getRealtimeResourceZKMetadataListForResource(getPropertyStore(),resourceName)) {
      if (segmentZKMetadata.getTableName().equals(tableName)) {
        segmentsInTable.add(segmentZKMetadata.getSegmentName());
      }
    }
  break;
case OFFLINE:
for (OfflineSegmentZKMetadata segmentZKMetadata : ZKMetadataProvider.getOfflineResourceZKMetadataListForResource(getPropertyStore(),resourceName)) {
  if (segmentZKMetadata.getTableName().equals(tableName)) {
    segmentsInTable.add(segmentZKMetadata.getSegmentName());
  }
}
break;
default :
break;
}
return segmentsInTable;
}
