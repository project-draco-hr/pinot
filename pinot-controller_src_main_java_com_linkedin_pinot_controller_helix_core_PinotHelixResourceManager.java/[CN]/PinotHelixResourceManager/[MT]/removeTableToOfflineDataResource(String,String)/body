{
  OfflineDataResourceZKMetadata offlineDataResourceZKMetadata=ZKMetadataProvider.getOfflineResourceZKMetadata(_zkClient,resourceName);
  List<String> tableList=offlineDataResourceZKMetadata.getTableList();
  if (tableList.contains(tableName)) {
    tableList.remove(tableName);
    offlineDataResourceZKMetadata.setTableList(tableList);
    ZKMetadataProvider.setOfflineResourceZKMetadata(offlineDataResourceZKMetadata,_zkClient);
    deleteSegmentsInTable(BrokerRequestUtils.getOfflineResourceNameForResource(resourceName),tableName);
    return true;
  }
  return false;
}
