{
  OfflineDataResourceZKMetadata offlineDataResourceZKMetadata=ZKMetadataProvider.getOfflineResourceZKMetadata(getPropertyStore(),resourceName);
  List<String> tableList=offlineDataResourceZKMetadata.getTableList();
  if (tableList.contains(tableName)) {
    tableList.remove(tableName);
    offlineDataResourceZKMetadata.setTableList(tableList);
    ZKMetadataProvider.setOfflineResourceZKMetadata(getPropertyStore(),offlineDataResourceZKMetadata);
    deleteSegmentsInTable(BrokerRequestUtils.getOfflineResourceNameForResource(resourceName),tableName);
    return true;
  }
  return false;
}
