{
  String brokerTag=null;
  if (getAllResourceNames().contains(BrokerRequestUtils.getRealtimeResourceNameForResource(resourceName))) {
    brokerTag=ZKMetadataProvider.getRealtimeResourceZKMetadata(_zkClient,BrokerRequestUtils.getRealtimeResourceNameForResource(resourceName)).getBrokerTag();
  }
  if (getAllResourceNames().contains(BrokerRequestUtils.getOfflineResourceNameForResource(resourceName))) {
    brokerTag=ZKMetadataProvider.getOfflineResourceZKMetadata(_zkClient,BrokerRequestUtils.getOfflineResourceNameForResource(resourceName)).getBrokerTag();
  }
  final List<String> instanceIds=_helixAdmin.getInstancesInClusterWithTag(_helixClusterName,brokerTag);
  if (instanceIds == null || instanceIds.size() == 0) {
    return null;
  }
  Collections.shuffle(instanceIds);
  return instanceIds.get(0);
}
