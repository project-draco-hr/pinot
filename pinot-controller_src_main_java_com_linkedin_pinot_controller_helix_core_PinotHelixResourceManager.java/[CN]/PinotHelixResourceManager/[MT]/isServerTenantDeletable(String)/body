{
  Set<String> taggedInstances=new HashSet<String>(_helixAdmin.getInstancesInClusterWithTag(_helixClusterName,ControllerTenantNameBuilder.getOfflineTenantNameForTenant(tenantName)));
  taggedInstances.addAll(_helixAdmin.getInstancesInClusterWithTag(_helixClusterName,ControllerTenantNameBuilder.getRealtimeTenantNameForTenant(tenantName)));
  for (  String resourceName : getAllResourceNames()) {
    if (resourceName.equals(CommonConstants.Helix.BROKER_RESOURCE_INSTANCE)) {
      continue;
    }
    IdealState resourceIdealState=_helixAdmin.getResourceIdealState(_helixClusterName,resourceName);
    for (    String partition : resourceIdealState.getPartitionSet()) {
      for (      String instance : resourceIdealState.getInstanceSet(partition)) {
        if (taggedInstances.contains(instance)) {
          return false;
        }
      }
    }
  }
  return true;
}
