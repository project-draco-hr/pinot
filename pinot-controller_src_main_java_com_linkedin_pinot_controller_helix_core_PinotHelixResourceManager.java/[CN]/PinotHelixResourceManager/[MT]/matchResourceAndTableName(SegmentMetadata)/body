{
  if (segmentMetadata == null || segmentMetadata.getResourceName() == null || segmentMetadata.getTableName() == null) {
    LOGGER.error("SegmentMetadata or resource name or table name is null");
    return false;
  }
  if ("realtime".equalsIgnoreCase(segmentMetadata.getIndexType())) {
    if (getAllResourceNames().contains(BrokerRequestUtils.getRealtimeResourceNameForResource(segmentMetadata.getResourceName()))) {
      if (getAllTableNamesForResource(BrokerRequestUtils.getRealtimeResourceNameForResource(segmentMetadata.getResourceName())).contains(segmentMetadata.getTableName())) {
        return true;
      }
    }
  }
  if (!getAllResourceNames().contains(BrokerRequestUtils.getOfflineResourceNameForResource(segmentMetadata.getResourceName()))) {
    LOGGER.error("Resource is not registered");
    return false;
  }
  if (!getAllTableNamesForResource(BrokerRequestUtils.getOfflineResourceNameForResource(segmentMetadata.getResourceName())).contains(segmentMetadata.getTableName())) {
    LOGGER.error("Table " + segmentMetadata.getTableName() + " is not registered for resource: "+ segmentMetadata.getResourceName());
    return false;
  }
  return true;
}
