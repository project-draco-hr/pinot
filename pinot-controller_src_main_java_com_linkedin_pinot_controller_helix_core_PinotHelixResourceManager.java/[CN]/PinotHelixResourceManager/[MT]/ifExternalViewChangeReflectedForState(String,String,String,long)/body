{
  long timeOutTimeStamp=System.currentTimeMillis() + timeOutInMills;
  boolean isSucess=true;
  while (System.currentTimeMillis() < timeOutTimeStamp) {
    try {
      Thread.sleep(2000);
    }
 catch (    InterruptedException e) {
    }
    isSucess=true;
    ExternalView externalView=_helixAdmin.getResourceExternalView(_helixClusterName,tableName);
    Map<String,String> segmentStatsMap=externalView.getStateMap(segmentName);
    if (segmentStatsMap != null) {
      for (      String instance : segmentStatsMap.keySet()) {
        if (!segmentStatsMap.get(instance).equalsIgnoreCase(targerStates)) {
          isSucess=false;
        }
      }
    }
 else {
      isSucess=false;
    }
    if (isSucess) {
      break;
    }
  }
  return isSucess;
}
