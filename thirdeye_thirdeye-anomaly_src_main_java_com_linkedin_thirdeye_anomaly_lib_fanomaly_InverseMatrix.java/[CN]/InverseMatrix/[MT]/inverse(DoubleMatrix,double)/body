{
  MathUtils.checkNotNull(matrix);
  if (!matrix.isSquare()) {
    throw new NonSquareMatrixException(matrix.getRows(),matrix.getRows());
  }
  return Solve.pinv(matrix);
}
