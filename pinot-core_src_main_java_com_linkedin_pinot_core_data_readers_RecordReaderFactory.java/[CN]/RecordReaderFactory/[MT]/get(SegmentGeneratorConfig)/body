{
  if (segmentCreationSpec.getInputFileFormat() == null) {
    throw new UnsupportedOperationException("No input format property!");
  }
  if (segmentCreationSpec.getInputFileFormat() == FileFormat.AVRO || segmentCreationSpec.getInputFileFormat() == FileFormat.GZIPPED_AVRO) {
    return new AvroRecordReader(FieldExtractorFactory.getPlainFieldExtractor(segmentCreationSpec),segmentCreationSpec.getInputFilePath());
  }
  throw new UnsupportedOperationException("Not support input format: " + segmentCreationSpec.getInputFileFormat());
}
