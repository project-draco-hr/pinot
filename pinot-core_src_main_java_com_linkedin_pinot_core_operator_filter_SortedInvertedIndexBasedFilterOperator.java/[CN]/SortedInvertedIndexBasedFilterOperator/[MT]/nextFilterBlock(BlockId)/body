{
  Predicate predicate=getPredicate();
  final SortedInvertedIndexReader invertedIndex=(SortedInvertedIndexReader)dataSource.getInvertedIndex();
  Dictionary dictionary=dataSource.getDictionary();
  List<IntPair> pairs=new ArrayList<IntPair>();
  PredicateEvaluator evaluator=PredicateEvaluatorProvider.getPredicateFunctionFor(predicate,dictionary);
  int[] dictionaryIds=evaluator.getMatchingDictionaryIds();
  for (int i=0; i < dictionaryIds.length; i++) {
    IntPair pair=invertedIndex.getMinMaxRangeFor(dictionaryIds[i]);
    pairs.add(pair);
  }
  LOGGER.debug("Creating a Sorted Block with pairs: {}",pairs);
  sortedBlock=new SortedBlock(dataSource.getOperatorName(),pairs);
  return sortedBlock;
}
