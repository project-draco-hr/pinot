{
  _logger.info("Trying to add a new segment to resource : " + _resourceName);
synchronized (getGlobalLock()) {
    if (!_segmentsMap.containsKey(indexSegmentToAdd.getSegmentName())) {
      _logger.info("Trying to add segment - " + indexSegmentToAdd.getSegmentName());
      _segmentsMap.put(indexSegmentToAdd.getSegmentName(),new SegmentDataManager(indexSegmentToAdd));
      markSegmentAsLoaded(indexSegmentToAdd.getSegmentName());
      _referenceCounts.put(indexSegmentToAdd.getSegmentName(),new AtomicInteger(1));
    }
 else {
      _logger.info("Trying to refresh segment - " + indexSegmentToAdd.getSegmentName());
      refreshSegment(indexSegmentToAdd);
    }
  }
}
