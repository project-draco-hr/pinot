{
  this.sql=sql;
  CCJSqlParserManager parserManager=new CCJSqlParserManager();
  Statement statement=parserManager.parse(new StringReader(sql));
  ((Select)statement).getSelectBody().accept(this);
  if (query.getStart() == null || query.getEnd() == null) {
    throw new Exception("Must provide BETWEEN clause");
  }
}
