{
switch (terminalState.peek()) {
case DIMENSION_EQUALS_RIGHT:
    currentValue=stringValue.getValue();
  return;
case BETWEEN_START:
query.setStart(ISODateTimeFormat.dateTimeParser().parseDateTime(stringValue.getValue()));
return;
case BETWEEN_END:
query.setEnd(ISODateTimeFormat.dateTimeParser().parseDateTime(stringValue.getValue()));
return;
case SELECT_ITEM:
query.addMetricName(stringValue.getValue());
return;
case GROUP_BY:
query.addGroupByColumn(stringValue.getValue());
return;
case FUNCTION_AGGREGATE:
case FUNCTION_MOVING_AVERAGE:
query.addMetricName(stringValue.getValue());
return;
case FUNCTION_SUM:
case FUNCTION_RATIO:
functionMetrics.add(stringValue.getValue());
return;
}
throw new IllegalStateException("Invalid SQL: " + sql);
}
