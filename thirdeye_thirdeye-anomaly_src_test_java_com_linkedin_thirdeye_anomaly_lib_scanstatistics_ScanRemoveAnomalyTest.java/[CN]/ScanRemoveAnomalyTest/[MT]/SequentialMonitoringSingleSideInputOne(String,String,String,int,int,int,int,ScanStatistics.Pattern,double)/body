{
  int[] columns={3};
  double[] series=GetData(filename,columns);
  String[] inputTimestamps=GetTimestamp(filename,1);
  double[] deseasonal_series=new double[series.length];
  long[] timestamps=new long[series.length];
  for (int ii=0; ii < series.length; ii++) {
    timestamps[ii]=ii;
    if (series[ii] == 0) {
      series[ii]=Double.NaN;
      System.out.println(ii);
    }
 else {
      series[ii]=Math.log(series[ii]);
    }
  }
  ScanStatisticsAnomalyDetectionFunction.removeMissingValuesByAveragingNeighbors(series);
  double[][] data=STLTest.removeSeasonality(timestamps,series,168,15,1,0.75,0.10,true);
  double[] data_trend=data[0];
  double[] data_remainder=data[1];
  for (int ii=0; ii < series.length; ii++) {
    deseasonal_series[ii]=data_trend[ii] + data_remainder[ii];
  }
  System.out.println("seasonality removed." + series.length);
  File file=new File(seasonalOutputFilename);
  OutputStream fop=new FileOutputStream(file);
  BufferedWriter writer=new BufferedWriter(new OutputStreamWriter(fop));
  for (  double element : deseasonal_series) {
    writer.write(Double.toString(element));
    writer.newLine();
  }
  writer.close();
  SequentialMonitoringCompareWithR(series,inputTimestamps,outputFilename,training_size,monitor_size,scan_size,numSims,target_pattern,target_level);
}
