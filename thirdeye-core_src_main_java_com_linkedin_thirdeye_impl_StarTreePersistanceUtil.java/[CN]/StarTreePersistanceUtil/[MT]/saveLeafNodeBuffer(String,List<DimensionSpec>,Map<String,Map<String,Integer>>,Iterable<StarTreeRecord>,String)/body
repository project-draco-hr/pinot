{
  ByteArrayOutputStream bufferStream=new ByteArrayOutputStream();
  DataOutputStream bufferDataOutputStream=new DataOutputStream(bufferStream);
  for (  StarTreeRecord record : records) {
    for (    DimensionSpec dimensionSpec : dimensionSpecs) {
      String dimValue=record.getDimensionKey().getDimensionValue(dimensionSpecs,dimensionSpec.getName());
      int dimValueId=forwardIndex.get(dimensionSpec.getName()).get(dimValue);
      bufferDataOutputStream.writeInt(dimValueId);
    }
  }
  bufferDataOutputStream.flush();
  byte[] bufferBytes=bufferStream.toByteArray();
  File bufferFile=new File(outputDir,nodeId + StarTreeConstants.BUFFER_FILE_SUFFIX);
  if (!bufferFile.createNewFile()) {
    throw new IOException(bufferFile + " already exists");
  }
  IOUtils.copy(new ByteArrayInputStream(bufferBytes),new FileOutputStream(bufferFile));
}
