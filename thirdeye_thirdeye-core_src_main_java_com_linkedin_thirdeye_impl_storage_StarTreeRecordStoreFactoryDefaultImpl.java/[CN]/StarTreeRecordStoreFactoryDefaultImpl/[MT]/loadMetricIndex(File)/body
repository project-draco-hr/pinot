{
  List<MetricIndexEntry> entries=StorageUtils.readMetricIndex(indexFile);
  FileDescriptor fileDescriptor=FileDescriptor.fromString(indexFile.getName(),StarTreeConstants.INDEX_FILE_SUFFIX);
  metricIndexByFile.put(fileDescriptor.getId(),new HashSet<MetricIndexEntry>());
  indexDescriptors.put(fileDescriptor.getId(),fileDescriptor);
  for (  MetricIndexEntry entry : entries) {
    List<MetricIndexEntry> nodeEntries=metricIndex.get(entry.getNodeId());
    if (nodeEntries == null) {
      nodeEntries=new ArrayList<MetricIndexEntry>();
      metricIndex.put(entry.getNodeId(),nodeEntries);
    }
    nodeEntries.add(entry);
    metricIndexByFile.get(fileDescriptor.getId()).add(entry);
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("Loaded metric index {}",indexFile);
  }
}
