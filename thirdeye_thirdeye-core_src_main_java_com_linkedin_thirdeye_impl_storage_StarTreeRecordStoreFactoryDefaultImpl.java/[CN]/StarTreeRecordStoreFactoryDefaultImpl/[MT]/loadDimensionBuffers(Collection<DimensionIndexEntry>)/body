{
  File dimensionStore=new File(rootDir,StarTreeConstants.DIMENSION_STORE);
  for (  DimensionIndexEntry indexEntry : indexEntries) {
    FileDescriptor associatedDescriptor=indexDescriptors.get(indexEntry.getFileId());
    if (associatedDescriptor == null) {
      throw new IllegalStateException("No index descriptor for " + indexEntry);
    }
    if (!dimensionSegments.containsKey(indexEntry.getFileId())) {
      File bufferFile=new File(dimensionStore,associatedDescriptor.toString(StarTreeConstants.BUFFER_FILE_SUFFIX));
      dimensionSegments.put(indexEntry.getFileId(),mapBuffer(bufferFile));
      if (LOG.isDebugEnabled()) {
        LOGGER.debug("Loaded buffer file {}",bufferFile);
      }
    }
    if (!dictionarySegments.containsKey(indexEntry.getFileId())) {
      File bufferFile=new File(dimensionStore,associatedDescriptor.toString(StarTreeConstants.DICT_FILE_SUFFIX));
      dictionarySegments.put(indexEntry.getFileId(),mapBuffer(bufferFile));
      if (LOG.isDebugEnabled()) {
        LOGGER.debug("Loaded buffer file {}",bufferFile);
      }
    }
  }
}
