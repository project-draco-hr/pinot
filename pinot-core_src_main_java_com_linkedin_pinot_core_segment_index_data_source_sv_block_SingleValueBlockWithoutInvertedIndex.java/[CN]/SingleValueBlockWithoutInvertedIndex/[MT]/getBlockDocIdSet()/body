{
  if (predicate == null) {
    return BlockUtils.getDummyBlockDocIdSet(columnMetadata.getTotalDocs());
  }
  final List<Integer> filteredIds=DictionaryIdFilterUtils.filter(predicate,dictionary);
  return new BlockDocIdSet(){
    @Override public BlockDocIdIterator iterator(){
      return new BlockDocIdIterator(){
        int counter=-1;
        @Override public int advance(        int targetDocId){
          if (targetDocId >= columnMetadata.getTotalDocs()) {
            return Constants.EOF;
          }
          counter=targetDocId - 1;
          return next();
        }
        @Override public int next(){
          counter++;
          if (counter >= columnMetadata.getTotalDocs()) {
            return Constants.EOF;
          }
          while (counter < columnMetadata.getTotalDocs()) {
            if (filteredIds.contains(indexReader.getInt(counter))) {
              return counter;
            }
            counter++;
          }
          return Constants.EOF;
        }
        @Override public int currentDocId(){
          return counter;
        }
      }
;
    }
    @Override public Object getRaw(){
      throw new UnsupportedOperationException("cannot get raw from forward index blocks");
    }
  }
;
}
