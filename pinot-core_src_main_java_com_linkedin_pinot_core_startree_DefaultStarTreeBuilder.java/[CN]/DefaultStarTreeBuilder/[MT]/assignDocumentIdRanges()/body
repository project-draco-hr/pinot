{
  Queue<StarTreeIndexNode> queue=new LinkedList<>();
  queue.add(starTree);
  while (!queue.isEmpty()) {
    StarTreeIndexNode current=queue.remove();
    if (current.isLeaf()) {
      int offset=0;
      if (current.getPathValues().values().contains(StarTreeIndexNode.all())) {
        offset=totalRawDocumentCount;
      }
      StarTreeTableRange range=adjustedDocumentIdRanges.get(current.getNodeId());
      current.setStartDocumentId(range.getStartDocumentId() + offset);
      current.setDocumentCount(range.getDocumentCount());
    }
 else {
      for (      StarTreeIndexNode child : current.getChildren().values()) {
        queue.add(child);
      }
    }
  }
}
