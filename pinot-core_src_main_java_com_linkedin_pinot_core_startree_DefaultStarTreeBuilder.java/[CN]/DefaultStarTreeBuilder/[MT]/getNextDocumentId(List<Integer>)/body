{
  if (!buildComplete) {
    throw new IllegalStateException("Must call build first");
  }
  return documentIdMap.getNextDocumentId(dimensions);
}
