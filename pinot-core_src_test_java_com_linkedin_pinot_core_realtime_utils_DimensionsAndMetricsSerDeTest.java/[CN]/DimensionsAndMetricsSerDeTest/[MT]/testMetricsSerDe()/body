{
  resetReader();
  RealtimeMetricsSerDe metricsSerDe=new RealtimeMetricsSerDe(schema);
  while (reader.hasNext()) {
    GenericRow row=reader.next();
    ByteBuffer buffer=metricsSerDe.serialize(row);
    for (    String metric : schema.getMetricNames()) {
      Assert.assertEquals(row.getValue(metric),metricsSerDe.getRawValueFor(metric,buffer));
    }
  }
}
