{
  InputStream is=null;
switch (mode) {
case DISK:
    is=new BufferedInputStream(new FileInputStream(new File(filePath)));
  break;
case HDFS:
is=new BufferedInputStream(fs.open(new Path(filePath)));
break;
default :
throw new UnsupportedOperationException();
}
return is;
}
