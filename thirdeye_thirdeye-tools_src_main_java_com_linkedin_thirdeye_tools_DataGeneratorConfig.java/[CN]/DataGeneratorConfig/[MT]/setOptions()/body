{
  if (minTime == null || maxTime == null) {
    DateTime d=new DateTime();
    endTime=d.getMillis();
    startTime=d.minusYears(1).getMillis();
  }
 else {
    DateTimeFormatter parser=ISODateTimeFormat.dateHourMinuteSecond();
    startTime=parser.parseDateTime(minTime).getMillis();
    endTime=parser.parseDateTime(maxTime).getMillis();
  }
  TimeUnit inputTimeUnit=starTreeConfig.getTime().getBucket().getUnit();
  int inputTimeBucketSize=starTreeConfig.getTime().getBucket().getSize();
  startTime=inputTimeUnit.convert(startTime,TimeUnit.MILLISECONDS) / inputTimeBucketSize;
  endTime=inputTimeUnit.convert(endTime,TimeUnit.MILLISECONDS) / inputTimeBucketSize;
  dimensionCardinality=new int[starTreeConfig.getDimensions().size()];
  Random r=new Random();
  if (cardinality == null) {
    for (int i=0; i < starTreeConfig.getDimensions().size(); i++)     dimensionCardinality[i]=r.nextInt(50) + 2;
  }
 else {
    String[] tokens=cardinality.split(",");
    for (int i=0; i < tokens.length; i++)     dimensionCardinality[i]=Integer.parseInt(tokens[i]);
    for (int i=tokens.length; i < starTreeConfig.getDimensions().size(); i++)     dimensionCardinality[i]=r.nextInt(50) + 2;
  }
  if (numRecords == 0) {
    numRecordsPerTimeUnit=100;
    numRecords=(endTime - startTime + 1) * numRecordsPerTimeUnit;
  }
 else {
    if (numRecords > (endTime - startTime + 1))     numRecordsPerTimeUnit=(int)(numRecords / (endTime - startTime + 1));
 else     numRecordsPerTimeUnit=1;
  }
  if (numFiles == 0) {
    numFiles=1;
  }
  numRecordsPerFile=numRecords / numFiles;
}
