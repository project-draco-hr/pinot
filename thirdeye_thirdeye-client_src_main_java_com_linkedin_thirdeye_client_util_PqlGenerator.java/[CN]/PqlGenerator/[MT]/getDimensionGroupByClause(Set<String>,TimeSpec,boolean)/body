{
  String timeColumnName=timeSpec.getColumnName();
  List<String> groups=new LinkedList<String>();
  if (groupBy != null) {
    groups.addAll(groupBy);
  }
  if (shouldGroupByTime && !groups.contains(timeColumnName)) {
    groups.add(0,timeColumnName);
  }
  return String.format("GROUP BY %s",COMMA.join(groups));
}
