{
  long globalMinTimeMillis=-1;
  long globalMaxTimeMillis=-1;
  if (starTrees != null) {
    for (    StarTree starTree : starTrees) {
      TimeGranularity bucket=starTree.getConfig().getTime().getBucket();
      StarTreeStats stats=starTree.getStats();
      long minTimeMillis=TimeUnit.MILLISECONDS.convert(stats.getMinTime() * bucket.getSize(),bucket.getUnit());
      long maxTimeMillis=TimeUnit.MILLISECONDS.convert(stats.getMaxTime() * bucket.getSize(),bucket.getUnit());
      if (globalMinTimeMillis == -1 || minTimeMillis < globalMaxTimeMillis) {
        globalMinTimeMillis=minTimeMillis;
      }
      if (globalMaxTimeMillis == -1 || maxTimeMillis > globalMaxTimeMillis) {
        globalMaxTimeMillis=maxTimeMillis;
      }
    }
  }
  return Range.closed(new DateTime(globalMinTimeMillis),new DateTime(globalMaxTimeMillis));
}
