{
  DoubleMatrix[] trainingTimeSeries=getTrainingData(inputTimeSeries,inputTimeStamps);
  DoubleMatrix[] processTrainingTimeSeries=RemoveTimeStamps(trainingTimeSeries,inputTimeStamps);
  double estimateMean=EstimateTrainingMean(processTrainingTimeSeries);
  Map<Long,FanomalyDataPoint> output=new HashMap<Long,FanomalyDataPoint>();
  for (int ii=0; ii < processTrainingTimeSeries.length; ii++) {
    if (processTrainingTimeSeries[ii] == null) {
      output.put(inputTimeStamps[ii],new FanomalyDataPoint(Double.NaN,Double.NaN,Double.NaN,0.0,inputTimeStamps[ii],ii));
    }
 else {
      if (processTrainingTimeSeries[ii].get(0,0) == estimateMean) {
        output.put(inputTimeStamps[ii],new FanomalyDataPoint(estimateMean,estimateMean,1.0,0.0,inputTimeStamps[ii],ii));
      }
    }
  }
  return output;
}
