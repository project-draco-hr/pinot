{
  Properties config=new Properties();
  config.setProperty(AggregationJobConstants.AGG_INPUT_AVRO_SCHEMA.toString(),getSchemaPath(root,collection));
  config.setProperty(AggregationJobConstants.AGG_CONFIG_PATH.toString(),getConfigPath(root,collection));
  boolean skipMissing=Boolean.parseBoolean(inputConfig.getProperty(ThirdEyeJobConstants.THIRDEYE_SKIP_MISSING.getName(),DEFAULT_SKIP_MISSING));
  if (skipMissing) {
    inputPaths=getFilteredInputPaths(inputPaths);
  }
  config.setProperty(AggregationJobConstants.AGG_INPUT_PATH.toString(),inputPaths);
  config.setProperty(AggregationJobConstants.AGG_OUTPUT_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + AGGREGATION.getName());
  config.setProperty(AggregationJobConstants.AGG_DIMENSION_STATS_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + StarTreeConstants.DIMENSION_STATS_FOLDER);
  config.setProperty(AggregationJobConstants.AGG_PRESERVE_TIME_COMPACTION.toString(),inputConfig.getProperty(ThirdEyeJobConstants.THIRDEYE_PRESERVE_TIME_COMPACTION.getName(),DEFAULT_THIRDEYE_PRESERVE_TIME_COMPACTION));
  config.setProperty(AggregationJobConstants.AGG_METRIC_SUMS_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + StarTreeConstants.METRIC_SUMS_FOLDER+ File.separator+ StarTreeConstants.METRIC_SUMS_FILE);
  return config;
}
