{
  Properties config=new Properties();
  config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_CONFIG_PATH.toString(),getConfigPath(root,collection));
  boolean isTopK=Boolean.parseBoolean(inputConfig.getProperty(ThirdEyeJobConstants.THIRDEYE_TOPK.getName(),DEFAULT_TOPK));
  if (isTopK) {
    config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_INPUT_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + TOPK_ROLLUP_PHASE3.getName());
  }
 else {
    config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_INPUT_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + ROLLUP_PHASE4.getName());
  }
  config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_OUTPUT_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + STARTREE_GENERATION.getName());
  return config;
}
