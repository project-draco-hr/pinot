{
  Properties config=new Properties();
  config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_CONFIG_PATH.toString(),getConfigPath(root,collection));
  String inputPath=getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator;
  FileSystem fs=FileSystem.get(new Configuration());
  if (fs.exists(new Path(inputPath + TOPK_ROLLUP_PHASE3.getName()))) {
    inputPath=inputPath + TOPK_ROLLUP_PHASE3.getName();
  }
 else   if (fs.exists(new Path(inputPath + ROLLUP_PHASE4.getName()))) {
    inputPath=inputPath + ROLLUP_PHASE4.getName();
  }
 else {
    inputPath=inputPath + AGGREGATION.getName();
  }
  config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_INPUT_PATH.toString(),inputPath);
  config.setProperty(StarTreeGenerationConstants.STAR_TREE_GEN_OUTPUT_PATH.toString(),getMetricIndexDir(root,collection,flowSpec,minTime,maxTime) + File.separator + STARTREE_GENERATION.getName());
  return config;
}
