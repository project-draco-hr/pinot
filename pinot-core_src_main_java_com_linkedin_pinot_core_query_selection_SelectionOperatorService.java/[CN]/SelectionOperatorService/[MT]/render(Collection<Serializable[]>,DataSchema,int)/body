{
  final LinkedList<JSONArray> rowEventsJSonList=new LinkedList<JSONArray>();
  if (finalResults instanceof PriorityQueue<?>) {
    PriorityQueue<Serializable[]> queue=(PriorityQueue<Serializable[]>)finalResults;
    while (finalResults.size() > offset) {
      rowEventsJSonList.addFirst(getJSonArrayFromRow(queue.poll(),dataSchema));
    }
  }
 else   if (finalResults instanceof ArrayList<?>) {
    List<Serializable[]> list=(List<Serializable[]>)finalResults;
    for (int i=offset; i < list.size(); i++) {
      rowEventsJSonList.add(getJSonArrayFromRow(list.get(i),dataSchema));
    }
  }
 else {
    throw new UnsupportedDataTypeException("type of results Expected: (PriorityQueue| ArrayList)) actual:" + finalResults.getClass());
  }
  final JSONObject resultJsonObject=new JSONObject();
  resultJsonObject.put("results",new JSONArray(rowEventsJSonList));
  resultJsonObject.put("columns",getSelectionColumnsFromDataSchema(dataSchema));
  return resultJsonObject;
}
