{
  int keyCount=0;
  Set<Map.Entry<String,Number>> baselineSet=baseline.entrySet();
  for (  Map.Entry<String,Number> baselineEntry : baselineSet) {
    String keyValue=baselineEntry.getKey();
    double s1=baselineEntry.getValue().doubleValue();
    double s2=current.get(keyValue).doubleValue();
    double[] s=new double[2];
    s[0]=s1;
    s[1]=s2;
    _snapshotDictionary.put(keyValue,s);
    _dimensionValue[keyCount]=keyValue;
    keyCount=keyCount + 1;
  }
  Stats baselineStats=getStats(baseline);
  Stats currentStats=getStats(current);
  double baselineSum=baselineStats.getSum();
  double currentSum=currentStats.getSum();
  List<HeatMapCell> cells=new ArrayList<HeatMapCell>();
  String resultString=updateRecords();
  String[] entries=resultString.split(",");
  for (  String entryString : entries) {
    if (_snapshotDictionary.containsKey(entryString)) {
      double[] valueList=_snapshotDictionary.get(entryString);
      baselineSum=baselineSum - valueList[0];
      currentSum=currentSum - valueList[1];
    }
  }
  double restRatio=currentSum / baselineSum;
  for (  String entryString : resultString.split(",")) {
    if (_snapshotDictionary.containsKey(entryString)) {
      double[] valueList=_snapshotDictionary.get(entryString);
      double ratio=valueList[1] / valueList[0];
      String colorString=COLOR;
      if (ratio < restRatio) {
        colorString=DOWNCOLOR;
      }
      if (ratio > restRatio) {
        colorString=UPCOLOR;
      }
      HeatMapCell cell=new HeatMapCell(entryString,valueList[1],valueList[0],ratio,1.0,colorString);
      cells.add(cell);
    }
  }
  if (entries.length > _maxRecords) {
    HeatMapCell cell=new HeatMapCell("Rest",currentSum,baselineSum,restRatio,1.0,COLOR);
    cells.add(cell);
  }
  return cells;
}
