{
  SegmentGeneratorConfig segmentGenSpec=new SegmentGeneratorConfig();
  List<String> projectedColumns=AvroUtils.getAllColumnsInAvroFile(inputAvro);
  segmentGenSpec.setInputFilePath(inputAvro.getAbsolutePath());
  segmentGenSpec.setProjectedColumns(projectedColumns);
  segmentGenSpec.setSchema(AvroUtils.extractSchemaFromAvro(inputAvro));
  segmentGenSpec.setTimeUnitForSegment(timeUnit);
  segmentGenSpec.setInputFileFormat(FileFormat.AVRO);
  segmentGenSpec.setSegmentVersion(SegmentVersion.v1);
  segmentGenSpec.setResourceName(clusterName);
  segmentGenSpec.setTableName(tableName);
  segmentGenSpec.setIndexOutputDir(outputDir.getAbsolutePath());
  return segmentGenSpec;
}
