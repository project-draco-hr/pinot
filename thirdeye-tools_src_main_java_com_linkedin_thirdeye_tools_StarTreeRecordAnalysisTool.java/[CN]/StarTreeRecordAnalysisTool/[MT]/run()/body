{
  Map<String,Number> aggregates=new HashMap<String,Number>();
  for (  String metricName : config.getMetricNames()) {
    aggregates.put(metricName,0);
  }
  for (  Iterable<StarTreeRecord> stream : streams) {
    for (    StarTreeRecord record : stream) {
      if (matches(record)) {
        updateAggregates(record,aggregates);
        if (debug) {
          printWriter.println(record);
        }
      }
    }
  }
  for (  String metricName : config.getMetricNames()) {
    printWriter.print(metricName);
    printWriter.print("=");
    printWriter.print(aggregates.get(metricName));
    printWriter.println();
  }
}
