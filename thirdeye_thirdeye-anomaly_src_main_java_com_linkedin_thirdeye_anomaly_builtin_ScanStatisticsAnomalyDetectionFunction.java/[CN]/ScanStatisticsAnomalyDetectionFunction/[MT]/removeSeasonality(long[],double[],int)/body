{
  STLDecomposition.Config config=new STLDecomposition.Config();
  config.setNumberOfObservations(seasonality);
  config.setNumberOfInnerLoopPasses(1);
  config.setNumberOfRobustnessIterations(15);
  config.setLowPassFilterBandwidth(0.5);
  config.setTrendComponentBandwidth(stlTrendBandwidth);
  config.setPeriodic(true);
  config.setNumberOfDataPoints(series.length);
  STLDecomposition stl=new STLDecomposition(config);
  STLResult res=stl.decompose(timestamps,series);
  double[] trend=res.getTrend();
  double[] remainder=res.getRemainder();
  double[] seasonalityRemoved=new double[trend.length];
  for (int i=0; i < trend.length; i++) {
    seasonalityRemoved[i]=trend[i] + remainder[i];
  }
  return seasonalityRemoved;
}
