{
  super(znRecord);
  setResourceType(ResourceType.REALTIME);
  _streamType=znRecord.getEnumField(CommonConstants.Helix.DataSource.Realtime.STREAM_TYPE,StreamType.class,StreamType.kafka);
  _dataSchema=Schema.getSchemaFromMap(znRecord.getSimpleFields());
switch (_streamType) {
case kafka:
    _streamMetadata=new KafkaStreamMetadata(znRecord.getSimpleFields());
  break;
default :
throw new UnsupportedOperationException("Not support stream type - " + _streamType);
}
}
