{
  DimensionKey rawDimensionKey=null;
  MetricTimeSeries rawMetricTimeSeries=null;
  Map<DimensionKey,MetricTimeSeries> possibleRollupTimeSeriesMap=new HashMap<DimensionKey,MetricTimeSeries>();
  for (  BytesWritable writable : rollupReduceOutputWritableIterable) {
    RollupPhaseTwoReduceOutput temp;
    temp=RollupPhaseTwoReduceOutput.fromBytes(writable.copyBytes(),metricSchema);
    if (rawMetricTimeSeries == null) {
      rawDimensionKey=temp.getRawDimensionKey();
      rawMetricTimeSeries=temp.getRawTimeSeries();
    }
    possibleRollupTimeSeriesMap.put(temp.getRollupDimensionKey(),temp.getRollupTimeSeries());
  }
  DimensionKey selectedRollup=rollupFunc.rollup(rawDimensionKey,possibleRollupTimeSeriesMap,rollupThresholdFunc);
  context.write(new BytesWritable(selectedRollup.toBytes()),new BytesWritable(rawMetricTimeSeries.toBytes()));
}
