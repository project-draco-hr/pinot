{
  StarTreeRecordStreamTextStreamImpl starTreeRecords=new StarTreeRecordStreamTextStreamImpl(new FileInputStream(recordFile),Arrays.asList("A","B","C"),Arrays.asList("M"),Arrays.asList(MetricType.INT),"\t",false);
  int idx=0;
  for (  StarTreeRecord starTreeRecord : starTreeRecords) {
    Assert.assertEquals(starTreeRecord.getDimensionValues().get("A"),"A" + idx);
    Assert.assertEquals(starTreeRecord.getDimensionValues().get("B"),"B" + idx);
    Assert.assertEquals(starTreeRecord.getDimensionValues().get("C"),"C" + idx);
    Assert.assertEquals(starTreeRecord.getMetricValues().get("M").intValue(),1);
    Assert.assertEquals(starTreeRecord.getTime().longValue(),0L);
    idx++;
  }
}
