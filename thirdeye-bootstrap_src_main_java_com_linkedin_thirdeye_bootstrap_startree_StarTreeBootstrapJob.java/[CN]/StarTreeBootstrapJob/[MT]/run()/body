{
  Job job=Job.getInstance(getConf());
  job.setJobName(name);
  job.setJarByClass(StarTreeBootstrapJob.class);
  Schema schema=new Schema.Parser().parse(FileSystem.get(getConf()).open(new Path(getAndCheck(PROP_AVRO_SCHEMA))));
  LOG.info("{}",schema);
  job.setMapperClass(StarTreeBootstrapMapper.class);
  AvroJob.setInputKeySchema(job,schema);
  job.setInputFormatClass(AvroKeyInputFormat.class);
  job.setMapOutputKeyClass(Text.class);
  job.setMapOutputValueClass(AvroValue.class);
  AvroJob.setMapOutputValueSchema(job,schema);
  job.setReducerClass(StarTreeBootstrapReducer.class);
  job.setOutputKeyClass(NullWritable.class);
  job.setOutputValueClass(BytesWritable.class);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  job.getConfiguration().set(PROP_STARTREE_CONFIG,getAndCheck(PROP_STARTREE_CONFIG));
  job.getConfiguration().set(PROP_STARTREE_ROOT,getAndCheck(PROP_STARTREE_ROOT));
  job.getConfiguration().set(PROP_OUTPUT_PATH,getAndCheck(PROP_OUTPUT_PATH));
  job.getConfiguration().set(PROP_AVRO_SCHEMA,getAndCheck(PROP_AVRO_SCHEMA));
  for (  String inputPath : getAndCheck(PROP_INPUT_PATHS).split(",")) {
    FileInputFormat.addInputPath(job,new Path(inputPath));
  }
  FileOutputFormat.setOutputPath(job,new Path(getAndCheck(PROP_OUTPUT_PATH)));
  job.waitForCompletion(true);
}
