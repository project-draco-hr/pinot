{
  if (pairs == null || pairs.isEmpty()) {
    return BlockUtils.emptyBlockDocIdSetIterator();
  }
  return new BlockDocIdIterator(){
    int pairPointer=0;
    int currentDocId=-1;
    @Override public int advance(    int targetDocId){
      if (pairPointer == pairs.size() || targetDocId > pairs.get(pairs.size() - 1).getRight()) {
        pairPointer=pairs.size();
        return (currentDocId=Constants.EOF);
      }
      long start=System.nanoTime();
      if (currentDocId >= targetDocId) {
        return currentDocId;
      }
      while (pairPointer < pairs.size()) {
        if (pairs.get(pairPointer).getLeft() > targetDocId) {
          currentDocId=pairs.get(pairPointer).getLeft();
          break;
        }
 else         if (targetDocId >= pairs.get(pairPointer).getLeft() && targetDocId <= pairs.get(pairPointer).getRight()) {
          currentDocId=targetDocId;
          break;
        }
        pairPointer++;
      }
      if (pairPointer == pairs.size()) {
        currentDocId=Constants.EOF;
      }
      long end=System.nanoTime();
      timeMeasure.addAndGet(end - start);
      return currentDocId;
    }
    @Override public int next(){
      if (pairPointer == pairs.size() || currentDocId > pairs.get(pairs.size() - 1).getRight()) {
        pairPointer=pairs.size();
        return (currentDocId=Constants.EOF);
      }
      long start=System.nanoTime();
      currentDocId=currentDocId + 1;
      if (pairPointer < pairs.size() && currentDocId > pairs.get(pairPointer).getRight()) {
        pairPointer++;
        if (pairPointer == pairs.size()) {
          currentDocId=Constants.EOF;
        }
 else {
          currentDocId=pairs.get(pairPointer).getLeft();
        }
      }
 else       if (currentDocId < pairs.get(pairPointer).getLeft()) {
        currentDocId=pairs.get(pairPointer).getLeft();
      }
      long end=System.nanoTime();
      timeMeasure.addAndGet(end - start);
      return currentDocId;
    }
    @Override public int currentDocId(){
      return currentDocId;
    }
  }
;
}
