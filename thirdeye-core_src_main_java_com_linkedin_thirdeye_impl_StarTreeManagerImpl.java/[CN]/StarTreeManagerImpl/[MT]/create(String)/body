{
synchronized (trees) {
    StarTree starTree=trees.get(collection);
    if (starTree != null) {
      throw new IllegalArgumentException("Star tree exists for collection " + collection);
    }
    StarTreeConfig config=configs.get(collection);
    if (config == null) {
      throw new IllegalStateException("No config exists for collection " + collection);
    }
    starTree=new StarTreeImpl(config);
    starTree.open();
    trees.put(collection,starTree);
  }
}
