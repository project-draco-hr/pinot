{
synchronized (trees) {
    LOG.info("Creating new startree for {}",collection);
    File collectionDir=new File(rootDir,collection);
    File treeFile=new File(collectionDir,StarTreeConstants.TREE_FILE_NAME);
    ObjectInputStream inputStream=new ObjectInputStream(new FileInputStream(treeFile));
    StarTreeNode root=(StarTreeNode)inputStream.readObject();
    File configFile=new File(collectionDir,StarTreeConstants.CONFIG_FILE_NAME);
    StarTreeConfig config=StarTreeConfig.fromJson(OBJECT_MAPPER.readTree(new FileInputStream(configFile)),rootDir);
    StarTree starTree=new StarTreeImpl(config,root);
    starTree.open();
    StarTree previous=trees.put(collection,starTree);
    if (previous != null) {
      previous.close();
    }
    configs.put(collection,config);
  }
}
