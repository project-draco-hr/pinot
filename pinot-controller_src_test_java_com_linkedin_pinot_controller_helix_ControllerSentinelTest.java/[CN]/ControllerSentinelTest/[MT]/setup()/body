{
  final ControllerConf conf=new ControllerConf();
  conf.setControllerHost(CONTROLLER_INSTANCE_NAME);
  conf.setControllerPort(CONTROLLER_API_PORT);
  conf.setDataDir(DATA_DIR);
  conf.setZkStr(ZK_STR);
  conf.setHelixClusterName(HELIX_CLUSTER_NAME);
  if (_zkClient.exists("/" + HELIX_CLUSTER_NAME)) {
    _zkClient.deleteRecursive("/" + HELIX_CLUSTER_NAME);
  }
  final String helixZkURL=HelixConfig.getAbsoluteZkPathForHelix(ZK_STR);
  _helixZkManager=HelixSetupUtils.setup(HELIX_CLUSTER_NAME,helixZkURL,CONTROLLER_INSTANCE_NAME);
  _helixAdmin=_helixZkManager.getClusterManagmentTool();
  _controllerStarter=new ControllerStarter(conf);
  _controllerStarter.start();
  ControllerRequestBuilderUtil.addFakeBrokerInstancesToAutoJoinHelixCluster(HELIX_CLUSTER_NAME,ZK_STR,20);
  ControllerRequestBuilderUtil.addFakeDataInstancesToAutoJoinHelixCluster(HELIX_CLUSTER_NAME,ZK_STR,20);
}
