{
  Map<MetricFunction,Map<String,Double>> metricOnlyData=TimeOnTimeResponseParser.processAggregateResponse(queryResultMap);
  Row.Builder rowBuilder=new Row.Builder();
  rowBuilder.setBaselineStart(comparisonRequest.getBaselineStart());
  rowBuilder.setBaselineEnd(comparisonRequest.getBaselineEnd());
  rowBuilder.setCurrentStart(comparisonRequest.getCurrentStart());
  rowBuilder.setCurrentEnd(comparisonRequest.getCurrentEnd());
  for (  Entry<MetricFunction,Map<String,Double>> entry : metricOnlyData.entrySet()) {
    MetricFunction key=entry.getKey();
    Map<String,Double> valueMap=entry.getValue();
    rowBuilder.addMetric(key.getMetricName(),valueMap.get(BASELINE_VALUE),valueMap.get(CURRENT_VALUE));
  }
  return rowBuilder.build();
}
