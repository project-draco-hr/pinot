{
  final InstanceResponsePlanNode rootNode=new InstanceResponsePlanNode();
  final CombinePlanNode combinePlanNode=new CombinePlanNode(brokerRequest,executorService,timeOutMs);
  rootNode.setPlanNode(combinePlanNode);
  for (  final IndexSegment indexSegment : indexSegmentList) {
    combinePlanNode.addPlanNode(makeInnerSegmentPlan(indexSegment,brokerRequest));
  }
  return new GlobalPlanImplV0(rootNode);
}
