{
  Representation presentation=null;
  try {
    final String resourceName=(String)getRequest().getAttributes().get("resourceName");
    final String segmentName=(String)getRequest().getAttributes().get("segmentName");
    if ((resourceName == null) && (segmentName == null)) {
      final JSONArray ret=new JSONArray();
      for (      final File file : baseDataDir.listFiles()) {
        final String url="http://" + StringUtil.join(":",conf.getControllerVipHost(),conf.getControllerPort()) + "/datafiles/"+ file.getName();
        ret.put(url);
      }
      presentation=new StringRepresentation(ret.toString());
      return presentation;
    }
 else     if ((resourceName != null) && (segmentName == null)) {
      final JSONArray ret=new JSONArray();
      for (      final File file : new File(baseDataDir,resourceName).listFiles()) {
        final String url="http://" + StringUtil.join(":",conf.getControllerVipHost(),conf.getControllerPort()) + "/datafiles/"+ resourceName+ "/"+ file.getName();
        ret.put(url);
      }
      presentation=new StringRepresentation(ret.toString());
      return presentation;
    }
    final File dataFile=new File(baseDataDir,StringUtil.join("/",resourceName,segmentName));
    if (dataFile.exists()) {
      presentation=new FileRepresentation(dataFile,MediaType.ALL,0);
      return presentation;
    }
    presentation=new StringRepresentation("this is a string");
  }
 catch (  final Exception e) {
    logger.error(e);
  }
  return presentation;
}
