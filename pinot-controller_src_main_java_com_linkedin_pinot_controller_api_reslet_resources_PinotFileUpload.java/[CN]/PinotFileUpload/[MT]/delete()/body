{
  Representation rep=null;
  final String resourceName=(String)getRequest().getAttributes().get("resourceName");
  final String segmentName=(String)getRequest().getAttributes().get("segmentName");
  logger.info("Getting segment deletion request, resourceName: " + resourceName + " segmentName: "+ segmentName);
  if (resourceName == null || segmentName == null) {
    throw new RuntimeException("either resource name or segment name is null");
  }
  final PinotResourceManagerResponse res=manager.deleteSegment(resourceName,segmentName);
  File fileToDelete=new File(new File(baseDataDir,resourceName),segmentName);
  FileUtils.deleteQuietly(fileToDelete);
  rep=new StringRepresentation(res.toString());
  return rep;
}
