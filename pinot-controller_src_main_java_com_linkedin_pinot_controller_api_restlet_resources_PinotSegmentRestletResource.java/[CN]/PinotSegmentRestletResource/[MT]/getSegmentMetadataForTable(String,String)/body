{
  if (!grouping.equals("instances")) {
    throw new RuntimeException("currently only instance grouping is supported");
  }
  JSONArray ret=new JSONArray();
  if (manager.hasRealtimeTable(tableName)) {
    String realtimeTableName=TableNameBuilder.REALTIME_TABLE_NAME_BUILDER.forTable(tableName);
    JSONObject realtime=new JSONObject();
    realtime.put("tableType","realtime");
    realtime.put("segments",new ObjectMapper().writeValueAsString(manager.getInstanceToSegmentsInATableMap(realtimeTableName)));
    ret.put(realtime);
  }
  if (manager.hasOfflineTable(tableName)) {
    String offlineTableName=TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(tableName);
    JSONObject offline=new JSONObject();
    offline.put("tableType","offline");
    offline.put("segments",new ObjectMapper().writeValueAsString(manager.getInstanceToSegmentsInATableMap(offlineTableName)));
    ret.put(offline);
  }
  return new StringRepresentation(ret.toString());
}
