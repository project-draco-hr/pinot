{
  JSONArray ret=new JSONArray();
  if ((tableType == null || TableType.OFFLINE.name().equalsIgnoreCase(tableType)) && _pinotHelixResourceManager.hasOfflineTable(tableName)) {
    String offlineTableName=TableNameBuilder.OFFLINE_TABLE_NAME_BUILDER.forTable(tableName);
    ret.put(toggleSegmentsForTable(offlineTableName,segmentName,state));
  }
  if ((tableType == null || TableType.REALTIME.name().equalsIgnoreCase(tableType)) && _pinotHelixResourceManager.hasRealtimeTable(tableName)) {
    String realTimeTableName=TableNameBuilder.REALTIME_TABLE_NAME_BUILDER.forTable(tableName);
    ret.put(toggleSegmentsForTable(realTimeTableName,segmentName,state));
  }
  return new StringRepresentation(ret.toString());
}
