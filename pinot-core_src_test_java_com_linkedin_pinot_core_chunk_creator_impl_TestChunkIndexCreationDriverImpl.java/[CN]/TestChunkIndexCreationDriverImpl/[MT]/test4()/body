{
  final IndexSegmentImpl segment=(IndexSegmentImpl)Loaders.IndexSegment.load(new File("/tmp/mirrorTwoDotO/mirror_mirror_16381_16381_1"),ReadMode.mmap);
  final ImmutableDictionaryReader d=segment.getDictionaryFor("viewerId");
  final List<String> rhs=new ArrayList<String>();
  rhs.add(d.get(new Random().nextInt(d.length())).toString());
  final Predicate p=new Predicate("viewerId",Type.EQ,rhs);
  final DataSource ds=segment.getDataSource("viewerId",p);
  final Block bl=ds.nextBlock();
  final BlockDocIdSet idSet=bl.getBlockDocIdSet();
  final BlockDocIdIterator it=idSet.iterator();
  int docId=it.next();
  final StringBuilder b=new StringBuilder();
  while (docId != Constants.EOF) {
    b.append(docId + ",");
    docId=it.next();
  }
  System.out.println(b.toString());
}
