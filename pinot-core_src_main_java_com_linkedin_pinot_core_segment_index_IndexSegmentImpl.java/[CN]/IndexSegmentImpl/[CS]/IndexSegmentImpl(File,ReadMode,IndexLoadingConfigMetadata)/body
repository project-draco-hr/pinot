{
  this.indexDir=indexDir;
  indexLoadMode=loadMode;
  segmentMetadata=new SegmentMetadataImpl(indexDir);
  dictionaryMap=new HashMap<String,ImmutableDictionaryReader>();
  forwardIndexMap=new HashMap<String,DataFileReader>();
  invertedIndexMap=new HashMap<String,InvertedIndexReader>();
  String tableName=segmentMetadata.getTableName();
  for (  final String column : segmentMetadata.getAllColumns()) {
    LOGGER.debug("loading dictionary, forwardIndex, inverted index for column : " + column);
    dictionaryMap.put(column,Loaders.Dictionary.load(segmentMetadata.getColumnMetadataFor(column),new File(indexDir,column + V1Constants.Dict.FILE_EXTENTION),loadMode));
    forwardIndexMap.put(column,Loaders.ForwardIndex.loadFwdIndexForColumn(segmentMetadata.getColumnMetadataFor(column),new File(indexDir,column + V1Constants.Indexes.UN_SORTED_SV_FWD_IDX_FILE_EXTENTION),loadMode));
    if (indexLoadingConfigMetadata == null || (!indexLoadingConfigMetadata.containsTable(tableName)) || indexLoadingConfigMetadata.isLoadingInvertedIndexForColumn(tableName,column)) {
      invertedIndexMap.put(column,Loaders.InvertedIndex.load(segmentMetadata.getColumnMetadataFor(column),indexDir,column,loadMode));
    }
    if (segmentMetadata.getColumnMetadataFor(column).isSingleValue()) {
      forwardIndexMap.put(column,Loaders.ForwardIndex.loadFwdIndexForColumn(segmentMetadata.getColumnMetadataFor(column),new File(indexDir,column + V1Constants.Indexes.UN_SORTED_SV_FWD_IDX_FILE_EXTENTION),loadMode));
    }
 else {
      forwardIndexMap.put(column,Loaders.ForwardIndex.loadFwdIndexForColumn(segmentMetadata.getColumnMetadataFor(column),new File(indexDir,column + V1Constants.Indexes.UN_SORTED_MV_FWD_IDX_FILE_EXTENTION),loadMode));
    }
    invertedIndexMap.put(column,Loaders.InvertedIndex.load(segmentMetadata.getColumnMetadataFor(column),indexDir,column,loadMode));
  }
  LOGGER.info("successfully loaded the index segment : " + indexDir.getName());
}
