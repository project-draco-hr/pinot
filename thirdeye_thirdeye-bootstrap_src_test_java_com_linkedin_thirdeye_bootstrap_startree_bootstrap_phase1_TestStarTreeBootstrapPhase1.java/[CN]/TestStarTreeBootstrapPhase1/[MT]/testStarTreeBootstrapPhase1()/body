{
  List<Pair<GenericRecord,NullWritable>> inputRecords=generateTestDataMapper();
  generateAndSerializeStarTree();
  for (  Pair<GenericRecord,NullWritable> p : inputRecords) {
    AvroKey<GenericRecord> inKey=new AvroKey<GenericRecord>();
    inKey.datum(p.getFirst());
    mapDriver.addInput(new Pair<AvroKey<GenericRecord>,NullWritable>(inKey,NullWritable.get()));
  }
  List<Pair<BytesWritable,BytesWritable>> result=mapDriver.run();
  Assert.assertEquals(2,result.size());
  List<Pair<BytesWritable,List<BytesWritable>>> input=generateTestDataReducer();
  reduceDriver.addAll(input);
  result=reduceDriver.run();
  BootstrapPhaseMapOutputValue output=BootstrapPhaseMapOutputValue.fromBytes(result.get(0).getSecond().getBytes(),TestHelper.getMetricSchema(starTreeBootstrapConfig));
  Assert.assertEquals(TestStarTreeBootstrapPhase1.TestHelper.generateMetricTimeSeries(starTreeBootstrapConfig,30),output.getMetricTimeSeries());
}
