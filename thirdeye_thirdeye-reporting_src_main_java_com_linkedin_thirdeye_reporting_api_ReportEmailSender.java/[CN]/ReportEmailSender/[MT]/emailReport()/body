{
  try {
    Configuration emailConfiguration=new Configuration();
    Template emailReportTemplate=emailConfiguration.getTemplate(ReportConstants.REPORT_EMAIL_TEMPLATE_PATH);
    Map<String,Object> rootMap=new HashMap<String,Object>();
    rootMap.put(ReportConstants.REPORT_CONFIG_OBJECT,reportConfig);
    rootMap.put(ReportConstants.TABLES_OBJECT,tables);
    rootMap.put(ReportConstants.ANOMALY_TABLES_OBJECT,anomalyReportTables);
    Writer emailOutput=new StringWriter();
    emailReportTemplate.process(rootMap,emailOutput);
    System.out.println(emailOutput.toString());
    Properties props=new Properties();
    props.setProperty(ReportConstants.MAIL_SMTP_HOST_KEY,ReportConstants.MAIL_SMTP_HOST_VALUE);
    Session session=Session.getDefaultInstance(props,null);
    Message emailReportMessage=new MimeMessage(session);
    for (    String emailIdFrom : scheduleSpec.getEmailFrom().split(",")) {
      emailReportMessage.setFrom(new InternetAddress(emailIdFrom,scheduleSpec.getNameFrom()));
    }
    for (    String emailIdTo : scheduleSpec.getEmailTo().split(",")) {
      emailReportMessage.addRecipient(Message.RecipientType.TO,new InternetAddress(emailIdTo,scheduleSpec.getNameTo()));
    }
    emailReportMessage.setSubject(reportConfig.getName());
    emailReportMessage.setContent(emailOutput.toString(),"text/html");
    Transport.send(emailReportMessage);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
}
