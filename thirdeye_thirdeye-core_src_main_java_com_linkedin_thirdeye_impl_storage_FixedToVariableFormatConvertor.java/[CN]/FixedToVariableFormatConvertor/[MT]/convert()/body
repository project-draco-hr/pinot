{
  if (!indexMetadata.getIndexFormat().equals(IndexFormat.FIXED_SIZE)) {
    LOGGER.warn("Index format is not in FIXED_SIZE format, aborting conversion for directory:{}",dataDirectory);
    return;
  }
  File inputDir=new File(dataDirectory,StarTreeConstants.METRIC_STORE);
  FilenameFilter filter=new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      return name.endsWith(StarTreeConstants.BUFFER_FILE_SUFFIX);
    }
  }
;
  File[] listFiles=inputDir.listFiles(filter);
  for (  File bufferFile : listFiles) {
    LOGGER.debug("START:Converting bufferfile:{} original size:{}",bufferFile.getAbsolutePath(),bufferFile.length());
    convert(bufferFile);
  }
  indexMetadata.setIndexFormat(IndexFormat.VARIABLE_SIZE);
  FileOutputStream fos=new FileOutputStream(new File(dataDirectory,StarTreeConstants.METADATA_FILE_NAME));
  indexMetadata.toProperties().store(fos,"This segment was generated during conversion from Fixed Format to Variable Size Format");
}
