{
  SegmentMetadataImpl segmentMetadata=new SegmentMetadataImpl(segmentDirectoryFile);
  String segmentVersion=segmentMetadata.getVersion();
  Assert.assertEquals(SegmentVersion.valueOf(segmentVersion),SegmentVersion.v1);
  String col1FileName=segmentMetadata.getBitmapInvertedIndexFileName(COLUMN1_NAME,segmentVersion);
  String col7FileName=segmentMetadata.getBitmapInvertedIndexFileName(COLUMN7_NAME,segmentVersion);
  String col13FileName=segmentMetadata.getBitmapInvertedIndexFileName(COLUMN13_NAME,segmentVersion);
  String badColFileName=segmentMetadata.getBitmapInvertedIndexFileName(NO_SUCH_COLUMN_NAME,segmentVersion);
  File col1File=new File(segmentDirectoryFile,col1FileName);
  File col7File=new File(segmentDirectoryFile,col7FileName);
  File col13File=new File(segmentDirectoryFile,col13FileName);
  File badColFile=new File(segmentDirectoryFile,badColFileName);
  Assert.assertFalse(col1File.exists());
  Assert.assertTrue(col7File.exists());
  Assert.assertFalse(col13File.exists());
  Assert.assertFalse(badColFile.exists());
  FileTime col7LastModifiedTime=Files.getLastModifiedTime(col7File.toPath());
  Thread.sleep(2000);
  checkInvertedIndexCreation(segmentDirectoryFile,segmentMetadata,false);
  Assert.assertTrue(col1File.exists());
  Assert.assertTrue(col7File.exists());
  Assert.assertTrue(col13File.exists());
  Assert.assertFalse(badColFile.exists());
  Assert.assertEquals(Files.getLastModifiedTime(col7File.toPath()),col7LastModifiedTime);
  FileTime col1LastModifiedTime=Files.getLastModifiedTime(col1File.toPath());
  FileTime col13LastModifiedTime=Files.getLastModifiedTime(col13File.toPath());
  Thread.sleep(2000);
  checkInvertedIndexCreation(segmentDirectoryFile,segmentMetadata,true);
  Assert.assertTrue(col1File.exists());
  Assert.assertTrue(col7File.exists());
  Assert.assertTrue(col13File.exists());
  Assert.assertFalse(badColFile.exists());
  Assert.assertEquals(Files.getLastModifiedTime(col1File.toPath()),col1LastModifiedTime);
  Assert.assertEquals(Files.getLastModifiedTime(col7File.toPath()),col7LastModifiedTime);
  Assert.assertEquals(Files.getLastModifiedTime(col13File.toPath()),col13LastModifiedTime);
}
