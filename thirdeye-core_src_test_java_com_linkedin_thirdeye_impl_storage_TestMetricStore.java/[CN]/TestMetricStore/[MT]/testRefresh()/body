{
  MetricStore refreshMetricStore=new MetricStore(config,generateBuffer(new TimeRange(0L,3L)));
  MetricTimeSeries timeSeries=refreshMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(0L,0L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{1});
  refreshMetricStore.refresh(generateBuffer(new TimeRange(4L,7L)));
  timeSeries=refreshMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(0L,0L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{0});
  timeSeries=refreshMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(4L,4L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{1});
}
