{
  List<BrokerRequest> perResourceRequests=new ArrayList<BrokerRequest>();
  perResourceRequests.add(getRealtimeBrokerRequest(request));
  perResourceRequests.add(getOfflineBrokerRequest(request));
  try {
    return getDataTableFromBrokerRequestList(request,perResourceRequests,null);
  }
 catch (  Exception e) {
    LOGGER.error("Caught exception while processing federated broker request",e);
    Utils.rethrowException(e);
    throw new AssertionError("Should not reach this");
  }
}
