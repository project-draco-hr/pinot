{
  List<OfflineSegmentZKMetadata> resultList=new ArrayList<OfflineSegmentZKMetadata>();
  if (propertyStore == null) {
    return resultList;
  }
  String offlineResourceName=BrokerRequestUtils.getOfflineResourceNameForResource(resourceName);
  if (propertyStore.exists(constructPropertyStorePathForResource(offlineResourceName),AccessOption.PERSISTENT)) {
    List<ZNRecord> znRecordList=propertyStore.getChildren(constructPropertyStorePathForResource(offlineResourceName),null,AccessOption.PERSISTENT);
    if (znRecordList != null) {
      for (      ZNRecord record : znRecordList) {
        resultList.add(new OfflineSegmentZKMetadata(record));
      }
    }
  }
  return resultList;
}
