{
  if (!resourceName.endsWith(CommonConstants.Broker.DataResource.OFFLINE_RESOURCE_SUFFIX)) {
    resourceName=BrokerRequestUtils.getOfflineResourceNameForResource(resourceName);
  }
  return new OfflineSegmentZKMetadata(propertyStore.get(constructPropertyStorePathForSegment(resourceName,segmentName),null,AccessOption.PERSISTENT));
}
