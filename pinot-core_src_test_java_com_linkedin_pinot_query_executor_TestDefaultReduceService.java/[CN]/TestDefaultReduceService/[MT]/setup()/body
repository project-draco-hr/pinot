{
  File confDir=new File(TestQueryExecutor.class.getClassLoader().getResource("conf").toURI());
  FileUtils.deleteDirectory(new File("/tmp/pinot/test1"));
  String configFilePath=confDir.getAbsolutePath();
  PropertiesConfiguration serverConf=new PropertiesConfiguration();
  serverConf.setDelimiterParsingDisabled(false);
  serverConf.load(new File(configFilePath,PINOT_PROPERTIES));
  InstanceDataManager instanceDataManager1=InstanceDataManager.getInstanceDataManager();
  instanceDataManager1.init(new InstanceDataManagerConfig(serverConf.subset("pinot.server.instance")));
  instanceDataManager1.start();
  for (int i=0; i < 2; ++i) {
    IndexSegment indexSegment=IndexSegmentUtils.getIndexSegmentWithAscendingOrderValues(20000001,"midas","testTable");
    instanceDataManager1.getResourceDataManager("midas");
    instanceDataManager1.getResourceDataManager("midas").addSegment(indexSegment);
  }
  _queryExecutor=new ServerQueryExecutorV1Impl();
  _queryExecutor.init(serverConf.subset("pinot.server.query.executor"),instanceDataManager1);
}
