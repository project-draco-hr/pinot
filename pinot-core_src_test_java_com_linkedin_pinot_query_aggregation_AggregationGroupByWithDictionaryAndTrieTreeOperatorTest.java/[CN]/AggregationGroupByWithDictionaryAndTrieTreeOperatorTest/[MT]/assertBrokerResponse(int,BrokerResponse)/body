{
  Assert.assertEquals(10001 * numSegments,brokerResponse.getNumDocsScanned());
  final int groupSize=15;
  assertBrokerResponse(brokerResponse,groupSize);
  final List<double[]> aggregationResult=getAggregationResult(numSegments);
  final List<String[]> groupByResult=getGroupResult();
  for (int j=0; j < _numAggregations; ++j) {
    final double[] aggResult=aggregationResult.get(j);
    final String[] groupResult=groupByResult.get(j);
    for (int i=0; i < 15; ++i) {
      Assert.assertEquals(0,DoubleComparisonUtil.defaultDoubleCompare(aggResult[i],brokerResponse.getAggregationResults().get(j).getJSONArray("groupByResult").getJSONObject(i).getDouble("value")));
      if ((i < 14 && aggResult[i] == aggResult[i + 1]) || (i > 0 && aggResult[i] == aggResult[i - 1])) {
      }
 else {
        Assert.assertEquals(groupResult[i],brokerResponse.getAggregationResults().get(j).getJSONArray("groupByResult").getJSONObject(i).getString("group"));
      }
    }
  }
}
