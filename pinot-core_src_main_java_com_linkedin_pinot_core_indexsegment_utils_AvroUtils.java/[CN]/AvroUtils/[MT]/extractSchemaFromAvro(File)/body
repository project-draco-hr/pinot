{
  final Schema schema=new Schema();
  final DataFileStream<GenericRecord> dataStreamReader=getAvroReader(avroFile);
  final org.apache.avro.Schema avroSchema=dataStreamReader.getSchema();
  for (  final Field field : avroSchema.getFields()) {
    FieldSpec spec;
    FieldSpec.DataType columnType=AvroRecordReader.getColumnType(field);
    if (field.name().contains("count") || field.name().contains("met")) {
      spec=new MetricFieldSpec();
      spec.setDataType(columnType);
    }
 else     if (field.name().contains("day") || field.name().equalsIgnoreCase("daysSinceEpoch")) {
      spec=new TimeFieldSpec(field.name(),columnType,TimeUnit.DAYS);
    }
 else {
      spec=new DimensionFieldSpec();
      spec.setDataType(columnType);
    }
    spec.setName(field.name());
    spec.setSingleValueField(AvroRecordReader.isSingleValueField(field));
    schema.addSchema(spec.getName(),spec);
  }
  dataStreamReader.close();
  return schema;
}
