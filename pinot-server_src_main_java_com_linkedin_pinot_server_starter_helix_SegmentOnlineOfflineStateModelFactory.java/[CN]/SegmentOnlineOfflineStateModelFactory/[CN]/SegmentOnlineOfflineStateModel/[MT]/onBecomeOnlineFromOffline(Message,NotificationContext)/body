{
  LOGGER.debug("SegmentOnlineOfflineStateModel.onBecomeOnlineFromOffline() : " + message);
  final ResourceType resourceType=BrokerRequestUtils.getResourceTypeFromResourceName(message.getResourceName());
  try {
switch (resourceType) {
case OFFLINE:
      onBecomeOnlineFromOfflineForOfflineSegment(message,context);
    break;
case REALTIME:
  onBecomeOnlineFromOfflineForRealtimeSegment(message,context);
break;
default :
throw new RuntimeException("Not supported resource Type for onBecomeOnlineFromOffline message: " + message);
}
}
 catch (Exception e) {
if (LOGGER.isErrorEnabled()) {
LOGGER.error("Caught exception in state transition for OFFLINE -> ONLINE for partition" + message.getPartitionName() + " of resource "+ message.getResourceName(),e);
}
Utils.rethrowException(e);
}
}
