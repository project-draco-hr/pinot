{
  LOGGER.debug("SegmentOnlineOfflineStateModel.onBecomeOnlineFromOffline() : " + message);
  final ResourceType resourceType=BrokerRequestUtils.getResourceTypeFromResourceName(message.getResourceName());
  try {
switch (resourceType) {
case OFFLINE:
      onBecomeOnlineFromOfflineForOfflineSegment(message,context);
    break;
case REALTIME:
  onBecomeOnlineFromOfflineForRealtimeSegment(message,context);
break;
default :
throw new RuntimeException("Not supported resource Type for onBecomeOnlineFromOffline message: " + message);
}
}
 catch (Exception e) {
throw new RuntimeException("Got internal error for adding segment: " + message + "\nException: "+ e.getMessage());
}
}
