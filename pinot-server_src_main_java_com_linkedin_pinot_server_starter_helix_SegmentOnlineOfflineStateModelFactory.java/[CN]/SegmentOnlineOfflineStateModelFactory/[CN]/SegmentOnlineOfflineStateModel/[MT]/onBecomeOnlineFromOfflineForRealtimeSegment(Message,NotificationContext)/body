{
  final String segmentId=message.getPartitionName();
  final String resourceName=message.getResourceName();
  ZkHelixPropertyStore<ZNRecord> propertyStore=ZkUtils.getZkPropertyStore(context.getManager(),_helixClusterName);
  SegmentZKMetadata realtimeSegmentZKMetadata=ZKMetadataProvider.getRealtimeSegmentZKMetadata(propertyStore,resourceName,segmentId);
  InstanceZKMetadata instanceZKMetadata=ZKMetadataProvider.getInstanceZKMetadata(propertyStore,_instanceId);
  RealtimeDataResourceZKMetadata realtimeDataResourceZKMetadata=ZKMetadataProvider.getRealtimeResourceZKMetadata(propertyStore,resourceName);
  ((InstanceDataManager)INSTANCE_DATA_MANAGER).addSegment(propertyStore,realtimeDataResourceZKMetadata,instanceZKMetadata,realtimeSegmentZKMetadata);
}
