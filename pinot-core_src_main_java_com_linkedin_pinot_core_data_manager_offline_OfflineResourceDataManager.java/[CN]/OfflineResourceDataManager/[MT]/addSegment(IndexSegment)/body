{
  _logger.info("Trying to add a new segment to resource : " + _resourceName);
synchronized (getGlobalLock()) {
    if (!_segmentsMap.containsKey(indexSegmentToAdd.getSegmentName())) {
      _logger.info("Trying to add segment - " + indexSegmentToAdd.getSegmentName());
      _segmentsMap.put(indexSegmentToAdd.getSegmentName(),new SegmentDataManager(indexSegmentToAdd));
      markSegmentAsLoaded(indexSegmentToAdd.getSegmentName());
      _referenceCounts.put(indexSegmentToAdd.getSegmentName(),new AtomicInteger(1));
    }
 else {
      _logger.info("Trying to refresh segment - " + indexSegmentToAdd.getSegmentName());
      SegmentDataManager segment=_segmentsMap.get(indexSegmentToAdd.getSegmentName());
      _segmentsMap.put(indexSegmentToAdd.getSegmentName(),new SegmentDataManager(indexSegmentToAdd));
      if (segment != null) {
        _currentNumberOfDocuments.dec(segment.getSegment().getSegmentMetadata().getTotalDocs());
        _currentNumberOfDocuments.inc(indexSegmentToAdd.getSegmentMetadata().getTotalDocs());
        segment.getSegment().destroy();
      }
    }
  }
}
