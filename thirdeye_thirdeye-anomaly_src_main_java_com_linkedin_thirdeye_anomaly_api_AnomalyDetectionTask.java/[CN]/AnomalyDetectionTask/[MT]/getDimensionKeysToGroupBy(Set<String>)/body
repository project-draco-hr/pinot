{
  Set<String> dimensionsToGroupBy=new HashSet<>();
  List<String> dimensions=driverConfig.getDimensionPrecedence();
  if (dimensions == null) {
    LOGGER.warn("no dimension precedence given, applying default order in star-tree. This may be highly inefficient.");
    dimensions=DimensionSpecUtils.getDimensionNames(starTreeConfig.getDimensions());
  }
  int firstUnexploredDimensionIndex=0;
  for (int i=0; i < dimensions.size(); i++) {
    if (dimensionsExplored.contains(dimensions.get(i))) {
      firstUnexploredDimensionIndex=i + 1;
    }
  }
  for (int i=firstUnexploredDimensionIndex; i < dimensions.size(); i++) {
    String dimensionName=dimensions.get(i);
    if (dimensionsExplored.contains(dimensionName)) {
      throw new IllegalStateException();
    }
    dimensionsToGroupBy.add(dimensionName);
  }
  return dimensionsToGroupBy;
}
