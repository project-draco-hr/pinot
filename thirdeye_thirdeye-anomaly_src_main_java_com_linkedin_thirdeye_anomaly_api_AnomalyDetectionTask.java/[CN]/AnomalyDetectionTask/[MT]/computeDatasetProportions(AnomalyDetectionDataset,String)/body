{
  Map<DimensionKey,Double> result=new HashMap<>();
  int metricIndex=dataset.getMetrics().indexOf(metricName);
  double totalSum=0;
  for (  DimensionKey dk : dataset.getDimensionKeys()) {
    double dkValue=dataset.getMetricTimeSeries(dk).getMetricSums()[metricIndex].doubleValue();
    result.put(dk,dkValue);
    totalSum+=dkValue;
  }
  for (  DimensionKey dk : dataset.getDimensionKeys()) {
    result.put(dk,result.get(dk) / totalSum);
  }
  return result;
}
