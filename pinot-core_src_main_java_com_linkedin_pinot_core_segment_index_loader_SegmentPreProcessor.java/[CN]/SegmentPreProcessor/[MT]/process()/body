{
  SegmentDirectory.Writer segmentWriter=null;
  try {
    segmentWriter=segmentDirectory.createWriter();
    addRemoveInvertedIndices(segmentWriter);
  }
  finally {
    if (segmentWriter != null) {
      try {
        segmentWriter.saveAndClose();
      }
 catch (      Exception e) {
        LOGGER.error("Failed to close segment directory: {}",segmentDirectory,e);
      }
    }
  }
}
