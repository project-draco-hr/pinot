{
  MetricType[] metricTypes=new MetricType[original.getSchema().getNumMetrics()];
  Arrays.fill(metricTypes,MetricType.DOUBLE);
  MetricTimeSeries normalized=new MetricTimeSeries(new MetricSchema(original.getSchema().getNames(),Arrays.asList(metricTypes)));
  MetricType baselineMetricType=original.getSchema().getMetricType(baselineMetricName);
  List<Long> sortedTimes=new ArrayList<Long>(original.getTimeWindowSet());
  Collections.sort(sortedTimes);
  for (  Long time : sortedTimes) {
    for (int i=0; i < original.getSchema().getNumMetrics(); i++) {
      String metricName=original.getSchema().getMetricName(i);
      Number value=original.get(time,metricName);
      Number baseline=original.get(time,baselineMetricName);
      if (NumberUtils.isZero(baseline,baselineMetricType)) {
        normalized.set(time,metricName,0);
      }
 else {
        normalized.set(time,metricName,value.doubleValue() / baseline.doubleValue());
      }
    }
  }
  return normalized;
}
