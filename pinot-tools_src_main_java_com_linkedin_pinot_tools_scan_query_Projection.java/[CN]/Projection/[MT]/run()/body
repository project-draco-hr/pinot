{
  List<ColumnMetadata> columnMetadatas=new ArrayList<>();
  for (  String column : _columns) {
    columnMetadatas.add(_metadata.getColumnMetadataFor(column));
  }
  ResultTable resultTable=new ResultTable(columnMetadatas,_filteredDocIds.size());
  for (  String column : _columns) {
    if (column.equals(("*"))) {
      continue;
    }
    ColumnMetadata columnMetadata=_metadata.getColumnMetadataFor(column);
    FieldSpec.DataType dataType=_metadata.getColumnMetadataFor(column).getDataType();
    Dictionary dictionaryReader=_indexSegment.getDictionaryFor(column);
    if (_metadata.getColumnMetadataFor(column).isSingleValue()) {
      BlockSingleValIterator bvIter=(BlockSingleValIterator)_indexSegment.getDataSource(column).getNextBlock().getBlockValueSet().iterator();
      int rowId=0;
      for (      Integer docId : _filteredDocIds) {
        bvIter.skipTo(docId);
        resultTable.add(rowId++,bvIter.nextIntVal());
      }
    }
 else {
      BlockMultiValIterator bvIter=(BlockMultiValIterator)_indexSegment.getDataSource(column).getNextBlock().getBlockValueSet().iterator();
      int rowId=0;
      for (      Integer docId : _filteredDocIds) {
        bvIter.skipTo(docId);
        int maxNumMultiValues=_metadata.getColumnMetadataFor(column).getMaxNumberOfMultiValues();
        int[] dictIds=new int[maxNumMultiValues];
        resultTable.add(rowId++,dictIds);
      }
    }
  }
  return resultTable;
}
