{
  for (  MetricFieldSpec spec : schema.getMetricFieldSpecs()) {
    String column=spec.getName();
    ColumnIndexCreationInfo info=columnInfo.get(column);
    Object[] valuesWithAggregates=uniqueMetricValues.get(column).toArray();
    Arrays.sort(valuesWithAggregates);
    dictionaryCreatorMap.put(column,new SegmentDictionaryCreator(info.hasNulls(),PrimitiveArrayUtils.toPrimitive(valuesWithAggregates),spec,outDir));
    dictionaryCreatorMap.get(column).build();
  }
}
