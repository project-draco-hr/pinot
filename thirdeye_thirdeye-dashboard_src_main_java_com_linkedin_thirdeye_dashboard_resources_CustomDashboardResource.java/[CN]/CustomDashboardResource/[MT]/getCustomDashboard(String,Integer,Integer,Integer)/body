{
  CustomDashboardSpec spec=cache.get(name);
  List<Pair<CustomDashboardComponentSpec,View>> views=new ArrayList<>();
  for (  CustomDashboardComponentSpec componentSpec : spec.getComponents()) {
    MultivaluedMap<String,String> dimensionValues=new MultivaluedMapImpl();
    if (componentSpec.getDimensions() != null) {
      for (      Map.Entry<String,String> entry : componentSpec.getDimensions().entrySet()) {
        dimensionValues.putSingle(entry.getKey(),entry.getValue());
      }
    }
    String collection=spec.getCollection();
    List<String> metrics=componentSpec.getMetrics();
    String groupBy=componentSpec.getGroupBy();
    View view=null;
switch (componentSpec.getType()) {
case FUNNEL:
      view=getCustomFunnelTabularView(collection,year,month,day,metrics,dimensionValues);
    break;
case TIME_SERIES:
  view=getCustomTimeSeriesView(collection,year,month,day,metrics,dimensionValues,groupBy);
break;
default :
throw new IllegalStateException("Invalid funnel spec " + componentSpec.getType());
}
if (view != null) {
views.add(new Pair<>(componentSpec,view));
}
}
return new CustomDashboardView(name,views);
}
