{
  Map<String,QueryResult> results=new HashMap<>(resultFutures.size());
  for (  Map.Entry<String,List<Future<QueryResult>>> entry : resultFutures.entrySet()) {
    QueryResult finalQueryResult=null;
    for (    Future<QueryResult> futureQueryResult : entry.getValue()) {
      QueryResult queryResult=futureQueryResult.get();
      if (finalQueryResult == null) {
        finalQueryResult=queryResult;
      }
 else {
        finalQueryResult=mergeQueryResults(finalQueryResult,queryResult);
      }
    }
    results.put(entry.getKey(),finalQueryResult);
  }
  return results;
}
