{
  final PropertiesConfiguration properties=new PropertiesConfiguration(new File(file,V1Constants.MetadataKeys.METADATA_FILE_NAME));
  properties.setProperty(SEGMENT_NAME,segmentName);
  properties.setProperty(RESOURCE_NAME,config.getResourceName());
  properties.setProperty(TABLE_NAME,config.getTableName());
  properties.setProperty(DIMENSIONS,config.getDimensions());
  properties.setProperty(METRICS,config.getMetrics());
  properties.setProperty(TIME_COLUMN_NAME,config.getTimeColumnName());
  properties.setProperty(TIME_INTERVAL,"not_there");
  properties.setProperty(SEGMENT_TOTAL_DOCS,String.valueOf(totalDocs));
  String timeColumn=config.getTimeColumnName();
  if (indexCreationInfoMap.get(timeColumn) != null) {
    properties.setProperty(SEGMENT_START_TIME,indexCreationInfoMap.get(timeColumn).getMin());
    properties.setProperty(SEGMENT_END_TIME,indexCreationInfoMap.get(timeColumn).getMax());
    properties.setProperty(TIME_UNIT,config.getTimeUnitForSegment());
  }
  if (config.containsKey(SEGMENT_START_TIME)) {
    properties.setProperty(SEGMENT_START_TIME,config.getStartTime());
  }
  if (config.containsKey(SEGMENT_END_TIME)) {
    properties.setProperty(SEGMENT_END_TIME,config.getStartTime());
  }
  if (config.containsKey(TIME_UNIT)) {
    properties.setProperty(TIME_UNIT,config.getTimeUnitForSegment());
  }
  for (  final String key : config.getAllCustomKeyValuePair().keySet()) {
    properties.setProperty(key,config.getAllCustomKeyValuePair().get(key));
  }
  for (  final String column : indexCreationInfoMap.keySet()) {
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,CARDINALITY),String.valueOf(indexCreationInfoMap.get(column).getSortedUniqueElementsArray().length));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,TOTAL_DOCS),String.valueOf(totalDocs));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,DATA_TYPE),schema.getFieldSpecFor(column).getDataType().toString());
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,BITS_PER_ELEMENT),String.valueOf(SegmentForwardIndexCreatorImpl.getNumOfBits(indexCreationInfoMap.get(column).getSortedUniqueElementsArray().length)));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,DICTIONARY_ELEMENT_SIZE),String.valueOf(dictionaryCreatorMap.get(column).getStringColumnMaxLength()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,COLUMN_TYPE),String.valueOf(schema.getFieldSpecFor(column).getFieldType().toString()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,IS_SORTED),String.valueOf(indexCreationInfoMap.get(column).isSorted()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,HAS_NULL_VALUE),String.valueOf(indexCreationInfoMap.get(column).hasNulls()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,V1Constants.MetadataKeys.Column.HAS_DICTIONARY),String.valueOf(indexCreationInfoMap.get(column).isCreateDictionary()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,HAS_INVERTED_INDEX),String.valueOf(true));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,IS_SINGLE_VALUED),String.valueOf(schema.getFieldSpecFor(column).isSingleValueField()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,MAX_MULTI_VALUE_ELEMTS),String.valueOf(indexCreationInfoMap.get(column).getMaxNumberOfMutiValueElements()));
  }
  properties.save();
}
