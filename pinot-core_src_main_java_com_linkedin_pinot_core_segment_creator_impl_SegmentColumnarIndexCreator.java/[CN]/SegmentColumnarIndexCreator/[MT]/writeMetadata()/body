{
  final PropertiesConfiguration properties=new PropertiesConfiguration(new File(file,V1Constants.MetadataKeys.METADATA_FILE_NAME));
  properties.setProperty(SEGMENT_CREATOR_VERSION,config.getCreatorVersion());
  properties.setProperty(SEGMENT_PADDING_CHARACTER,StringEscapeUtils.escapeJava(Character.toString(config.getPaddingCharacter())));
  properties.setProperty(SEGMENT_NAME,segmentName);
  properties.setProperty(TABLE_NAME,config.getTableName());
  properties.setProperty(DIMENSIONS,config.getDimensions());
  properties.setProperty(METRICS,config.getMetrics());
  properties.setProperty(TIME_COLUMN_NAME,config.getTimeColumnName());
  properties.setProperty(TIME_INTERVAL,"not_there");
  properties.setProperty(SEGMENT_TOTAL_RAW_DOCS,String.valueOf(totalRawDocs));
  properties.setProperty(SEGMENT_TOTAL_AGGREGATE_DOCS,String.valueOf(totalAggDocs));
  properties.setProperty(SEGMENT_TOTAL_DOCS,String.valueOf(totalDocs));
  properties.setProperty(STAR_TREE_ENABLED,String.valueOf(config.isEnableStarTreeIndex()));
  properties.setProperty(SEGMENT_TOTAL_ERRORS,String.valueOf(totalErrors));
  properties.setProperty(SEGMENT_TOTAL_NULLS,String.valueOf(totalNulls));
  properties.setProperty(SEGMENT_TOTAL_CONVERSIONS,String.valueOf(totalConversions));
  properties.setProperty(SEGMENT_TOTAL_NULL_COLS,String.valueOf(totalNullCols));
  String timeColumn=config.getTimeColumnName();
  StarTreeIndexSpec starTreeIndexSpec=config.getStarTreeIndexSpec();
  if (starTreeIndexSpec != null) {
    properties.setProperty(STAR_TREE_SPLIT_ORDER,starTreeIndexSpec.getDimensionsSplitOrder());
    properties.setProperty(STAR_TREE_MAX_LEAF_RECORDS,starTreeIndexSpec.getMaxLeafRecords());
    properties.setProperty(STAR_TREE_SKIP_STAR_NODE_CREATION_FOR_DIMENSIONS,starTreeIndexSpec.getSkipStarNodeCreationForDimensions());
    properties.setProperty(STAR_TREE_SKIP_MATERIALIZATION_CARDINALITY,starTreeIndexSpec.getskipMaterializationCardinalityThreshold());
    properties.setProperty(STAR_TREE_SKIP_MATERIALIZATION_FOR_DIMENSIONS,starTreeIndexSpec.getskipMaterializationForDimensions());
  }
  if (indexCreationInfoMap.get(timeColumn) != null) {
    properties.setProperty(SEGMENT_START_TIME,indexCreationInfoMap.get(timeColumn).getMin());
    properties.setProperty(SEGMENT_END_TIME,indexCreationInfoMap.get(timeColumn).getMax());
    properties.setProperty(TIME_UNIT,config.getSegmentTimeUnit());
  }
  if (config.containsCustomProperty(SEGMENT_START_TIME)) {
    properties.setProperty(SEGMENT_START_TIME,config.getStartTime());
  }
  if (config.containsCustomProperty(SEGMENT_END_TIME)) {
    properties.setProperty(SEGMENT_END_TIME,config.getEndTime());
  }
  if (config.containsCustomProperty(TIME_UNIT)) {
    properties.setProperty(TIME_UNIT,config.getSegmentTimeUnit());
  }
  for (  final String key : config.getCustomProperties().keySet()) {
    properties.setProperty(key,config.getCustomProperties().get(key));
  }
  for (  final String column : indexCreationInfoMap.keySet()) {
    final ColumnIndexCreationInfo columnIndexCreationInfo=indexCreationInfoMap.get(column);
    final int uniqueValueCount=columnIndexCreationInfo.getDistinctValueCount();
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,CARDINALITY),String.valueOf(uniqueValueCount));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,TOTAL_DOCS),String.valueOf(totalDocs));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,TOTAL_RAW_DOCS),String.valueOf(totalRawDocs));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,TOTAL_AGG_DOCS),String.valueOf(totalAggDocs));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,DATA_TYPE),schema.getFieldSpecFor(column).getDataType().toString());
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,BITS_PER_ELEMENT),String.valueOf(SingleValueUnsortedForwardIndexCreator.getNumOfBits(uniqueValueCount)));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,DICTIONARY_ELEMENT_SIZE),String.valueOf(dictionaryCreatorMap.get(column).getStringColumnMaxLength()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,COLUMN_TYPE),String.valueOf(schema.getFieldSpecFor(column).getFieldType().toString()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,IS_SORTED),String.valueOf(columnIndexCreationInfo.isSorted()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,HAS_NULL_VALUE),String.valueOf(columnIndexCreationInfo.hasNulls()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,V1Constants.MetadataKeys.Column.HAS_DICTIONARY),String.valueOf(columnIndexCreationInfo.isCreateDictionary()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,HAS_INVERTED_INDEX),String.valueOf(true));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,IS_SINGLE_VALUED),String.valueOf(schema.getFieldSpecFor(column).isSingleValueField()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,MAX_MULTI_VALUE_ELEMTS),String.valueOf(columnIndexCreationInfo.getMaxNumberOfMutiValueElements()));
    properties.setProperty(V1Constants.MetadataKeys.Column.getKeyFor(column,TOTAL_NUMBER_OF_ENTRIES),String.valueOf(columnIndexCreationInfo.getTotalNumberOfEntries()));
  }
  properties.save();
}
