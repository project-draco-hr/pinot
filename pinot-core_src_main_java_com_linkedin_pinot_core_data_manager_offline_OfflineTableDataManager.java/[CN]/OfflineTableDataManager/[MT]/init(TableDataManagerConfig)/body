{
  _tableDataManagerConfig=tableDataManagerConfig;
  _tableName=_tableDataManagerConfig.getTableName();
  LOGGER=LoggerFactory.getLogger(_tableName + "-OfflineTableDataManager");
  _currentNumberOfSegments=Metrics.newCounter(OfflineTableDataManager.class,_tableName + "-" + CommonConstants.Metric.Server.CURRENT_NUMBER_OF_SEGMENTS);
  _currentNumberOfDocuments=Metrics.newCounter(OfflineTableDataManager.class,_tableName + "-" + CommonConstants.Metric.Server.CURRENT_NUMBER_OF_DOCUMENTS);
  _numDeletedSegments=Metrics.newCounter(OfflineTableDataManager.class,_tableName + "-" + CommonConstants.Metric.Server.NUMBER_OF_DELETED_SEGMENTS);
  _tableDataDir=_tableDataManagerConfig.getDataDir();
  if (!new File(_tableDataDir).exists()) {
    new File(_tableDataDir).mkdirs();
  }
  _numberOfTableQueryExecutorThreads=_tableDataManagerConfig.getNumberOfTableQueryExecutorThreads();
  if (_numberOfTableQueryExecutorThreads > 0) {
    _queryExecutorService=Executors.newFixedThreadPool(_numberOfTableQueryExecutorThreads,new NamedThreadFactory("parallel-query-executor-" + _tableName));
  }
 else {
    _queryExecutorService=Executors.newCachedThreadPool(new NamedThreadFactory("parallel-query-executor-" + _tableName));
  }
  _readMode=ReadMode.valueOf(_tableDataManagerConfig.getReadMode());
  _indexLoadingConfigMetadata=_tableDataManagerConfig.getIndexLoadingConfigMetadata();
  LOGGER.info("Initialized table : " + _tableName + " with :\n\tData Directory: "+ _tableDataDir+ "\n\tRead Mode : "+ _readMode+ "\n\tQuery Exeutor with "+ ((_numberOfTableQueryExecutorThreads > 0) ? _numberOfTableQueryExecutorThreads : "cached")+ " threads");
}
