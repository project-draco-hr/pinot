{
  List<SegmentDataManager> ret=new ArrayList<SegmentDataManager>();
  try {
    _rwLock.readLock().lock();
    for (    String segmentName : _segmentsMap.keySet()) {
      OfflineSegmentDataManager segmentDataManager;
      _rwLock.readLock().lock();
      segmentDataManager=_segmentsMap.get(segmentName);
      if (segmentDataManager != null) {
        segmentDataManager.incrementRefCnt();
        ret.add(segmentDataManager);
      }
    }
  }
  finally {
    _rwLock.readLock().unlock();
  }
  return ret;
}
