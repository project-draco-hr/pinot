{
  Set<String> servingDataResourceSet=new HashSet<String>();
  for (  ExternalView externalView : externalViewList) {
    if (externalView.getResourceName().equals("brokerResource")) {
      Set<String> dataResources=externalView.getPartitionSet();
      for (      String dataResource : dataResources) {
        Map<String,String> dataResourceToServingBrokerMap=externalView.getStateMap(dataResource);
        if (dataResourceToServingBrokerMap.containsKey(_instanceId)) {
          if (dataResourceToServingBrokerMap.get(_instanceId).equals("ONLINE")) {
            servingDataResourceSet.add(dataResource);
          }
        }
      }
    }
  }
  LOGGER.info("Current serving data resource : " + Arrays.toString(servingDataResourceSet.toArray(new String[0])));
  return servingDataResourceSet;
}
