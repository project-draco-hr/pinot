{
  TimeRange timeRange=new TimeRange(0L,3L);
  ConcurrentMap<TimeRange,List<ByteBuffer>> metricBuffers=new ConcurrentHashMap<TimeRange,List<ByteBuffer>>();
  metricBuffers.put(timeRange,Arrays.asList(generateBuffer(timeRange)));
  MetricStoreImmutableImpl createMetricStore=new MetricStoreImmutableImpl(config,metricBuffers);
  MetricTimeSeries timeSeries=createMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(0L,0L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{1});
  timeSeries=createMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(4L,4L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{0});
  timeRange=new TimeRange(4L,7L);
  createMetricStore.notifyCreate(timeRange,generateBuffer(timeRange));
  timeSeries=createMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(0L,0L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{1});
  timeSeries=createMetricStore.getTimeSeries(getLogicalOffsets(0),new TimeRange(4L,4L));
  Assert.assertEquals(timeSeries.getMetricSums(),new Number[]{1});
}
