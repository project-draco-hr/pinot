{
  Schema schema1=AvroTestUtil.createSchemaFor(input1SourceName,input1Dimensions,input1Metrics);
  Schema schema2=AvroTestUtil.createSchemaFor(input2SourceName,input2Dimensions,input2Metrics);
  GenericRecord record1=AvroTestUtil.generateDummyRecord(schema1,input1Dimensions,input1Metrics);
  MapOutputValue valueOrig=new MapOutputValue(schema1.getName(),record1);
  byte[] bytes=valueOrig.toBytes();
  Map<String,Schema> schemaMap=new HashMap<String,Schema>();
  schemaMap.put(schema1.getName(),schema1);
  schemaMap.put(schema2.getName(),schema2);
  MapOutputValue valueNew=MapOutputValue.fromBytes(bytes,schemaMap);
  Assert.assertEquals(valueOrig.getSchemaName(),valueNew.getSchemaName());
  Assert.assertEquals(valueOrig.getRecord(),valueNew.getRecord());
}
