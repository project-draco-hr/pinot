{
  Scanner userInput=new Scanner(System.in);
  System.out.println("Welcome to thirdeye-anomaly setup. This process will guide " + "you through the process of generating base configuration " + "templates and database tables.");
  ThirdEyeAnomalyDetectionConfiguration topLevelConfig=getTopLevelConfig(userInput);
  StarTreeConfig starTreeConfig=ServerUtils.getStarTreeConfig(topLevelConfig.getThirdEyeServerHost(),topLevelConfig.getThirdEyeServerPort(),topLevelConfig.getCollectionName());
  topLevelConfig.setDriverConfig(getDriverConfig(userInput,starTreeConfig));
  topLevelConfig.setAnomalyDatabaseConfig(getDatabaseConfig(userInput));
  YAMLFactory yamlFactory=new YAMLFactory();
  ObjectMapper mapper=new ObjectMapper(yamlFactory);
  mapper.setSerializationInclusion(Include.NON_NULL);
  System.out.println(mapper.writeValueAsString(topLevelConfig));
  if (!promptForYN("Accept this configuration?",userInput)) {
    System.err.println("Abort...");
    System.exit(0);
  }
  String pathName=promptForInput("Enter a filename (config.yml)",userInput);
  File configFile=new File(pathName);
  File parent=configFile.getParentFile();
  if (parent != null && !parent.exists() && !parent.mkdirs()) {
    throw new IllegalStateException("Couldn't create dir: " + parent);
  }
  yamlFactory.createGenerator(new FileOutputStream(configFile)).writeObject(topLevelConfig);
  if (topLevelConfig.getMode() == Mode.Generic) {
    initializeDatabase(topLevelConfig,userInput,starTreeConfig);
  }
  printSectionTitle("Congratulations, you are done!");
  System.out.println("Config file has been saved to: " + configFile.getAbsolutePath());
  System.out.println("usage: java -jar <this_jar> <your_config.yml>");
  printDashboardMessage(topLevelConfig.getAnomalyDatabaseConfig(),mapper);
}
