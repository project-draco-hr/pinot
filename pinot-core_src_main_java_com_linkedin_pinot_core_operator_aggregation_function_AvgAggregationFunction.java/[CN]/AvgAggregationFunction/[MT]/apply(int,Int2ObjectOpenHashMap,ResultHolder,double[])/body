{
  Preconditions.checkState(length <= valueArray.length);
  for (int i=0; i < length; ++i) {
    long[] groupKeys=(long[])valueArrayIndexToGroupKeys.get(i);
    for (    long groupKey : groupKeys) {
      Pair<Double,Long> avgValue=(Pair<Double,Long>)resultHolder.getResult(groupKey);
      if (avgValue == null) {
        avgValue=new com.linkedin.pinot.core.query.aggregation.function.AvgAggregationFunction.AvgPair(0.0,0L);
      }
      avgValue.setFirst(avgValue.getFirst() + valueArray[i]);
      avgValue.setSecond(avgValue.getSecond() + 1);
      resultHolder.putValueForKey(groupKey,avgValue);
    }
  }
}
