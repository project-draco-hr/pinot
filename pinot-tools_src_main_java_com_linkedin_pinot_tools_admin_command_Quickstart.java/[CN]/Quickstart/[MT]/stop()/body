{
  if (isStopped) {
    return;
  }
  if (server != null) {
    server.stop();
  }
  if (broker != null) {
    broker.stop();
  }
  if (controller != null) {
    controller.stop();
  }
  ZkStarter.stopLocalZkServer(true);
  isStopped=true;
}
