{
  LOG.info("START: In clean up");
  FileSystem dfs=FileSystem.get(context.getConfiguration());
  String leafDataTarGz=context.getTaskAttemptID().getTaskID() + "-leaf-data.tar.gz";
  LOG.info("Generating " + leafDataTarGz + " from "+ localOutputDataDir);
  FixedBufferUtil.combineDataFiles(dfs.open(pathToTree),new File(localTmpDataDir),new File(localOutputDataDir,"data"));
  TarGzCompressionUtils.createTarGzOfDirectory(localOutputDataDir,leafDataTarGz);
  Path src=FileSystem.getLocal(new Configuration()).makeQualified(new Path(leafDataTarGz));
  Path dst=dfs.makeQualified(new Path(hdfsOutputDir,leafDataTarGz));
  LOG.info("Copying " + src + " to "+ dst);
  dfs.copyFromLocalFile(src,dst);
  LOG.info("END: Clean up");
  File f=new File(localInputDataDir);
  FileUtils.deleteDirectory(f);
  f=new File(localOutputDataDir);
  FileUtils.deleteDirectory(f);
  f=new File(localTmpDataDir);
  FileUtils.deleteDirectory(f);
  f=new File(leafDataTarGz);
  f.delete();
  f=new File("leaf-data.tar.gz");
  f.delete();
}
