{
  RoutingTableBuilder routingStrategy=new RandomRoutingTableBuilder(100);
  HelixExternalViewBasedRouting routingTable=new HelixExternalViewBasedRouting(routingStrategy,null,null,null);
  ExternalView externalView=new ExternalView("testResource0_O");
  externalView.setState("segment0","dataServer_instance_0","ONLINE");
  externalView.setState("segment0","dataServer_instance_1","ONLINE");
  externalView.setState("segment1","dataServer_instance_1","ONLINE");
  externalView.setState("segment1","dataServer_instance_2","ONLINE");
  externalView.setState("segment2","dataServer_instance_2","ONLINE");
  externalView.setState("segment2","dataServer_instance_0","ONLINE");
  routingTable.markDataResourceOnline("testResource0_O",externalView);
  ExternalView externalView1=new ExternalView("testResource1_O");
  externalView1.setState("segment10","dataServer_instance_0","ONLINE");
  externalView1.setState("segment11","dataServer_instance_1","ONLINE");
  externalView1.setState("segment12","dataServer_instance_2","ONLINE");
  routingTable.markDataResourceOnline("testResource1_O",externalView1);
  ExternalView externalView2=new ExternalView("testResource2_O");
  externalView2.setState("segment20","dataServer_instance_0","ONLINE");
  externalView2.setState("segment21","dataServer_instance_0","ONLINE");
  externalView2.setState("segment22","dataServer_instance_0","ONLINE");
  externalView2.setState("segment20","dataServer_instance_1","ONLINE");
  externalView2.setState("segment21","dataServer_instance_1","ONLINE");
  externalView2.setState("segment22","dataServer_instance_1","ONLINE");
  externalView2.setState("segment20","dataServer_instance_2","ONLINE");
  externalView2.setState("segment21","dataServer_instance_2","ONLINE");
  externalView2.setState("segment22","dataServer_instance_2","ONLINE");
  routingTable.markDataResourceOnline("testResource2_O",externalView2);
  for (int numRun=0; numRun < 100; ++numRun) {
    assertResourceRequest(routingTable,"testResource0_O","[segment0, segment1, segment2]",3);
  }
  for (int numRun=0; numRun < 100; ++numRun) {
    assertResourceRequest(routingTable,"testResource1_O","[segment10, segment11, segment12]",3);
  }
  for (int numRun=0; numRun < 100; ++numRun) {
    assertResourceRequest(routingTable,"testResource2_O","[segment20, segment21, segment22]",3);
  }
}
