{
  Map<String,Long> aggValues=new HashMap<String,Long>();
  for (  Map.Entry<String,Long> entry : metricThresholdValues.entrySet()) {
    aggValues.put(entry.getKey(),0L);
  }
  for (  StarTreeRecord record : records) {
    for (    String metricName : metricThresholdValues.keySet()) {
      Long metricValue=record.getMetricValues().get(metricName);
      if (metricValue == null) {
        throw new IllegalArgumentException("Record must contain metric " + metricName + " if there's a threshold that must be passed: "+ record);
      }
      Long aggValue=aggValues.get(metricName);
      aggValues.put(metricName,aggValue + metricValue);
    }
  }
  for (  Map.Entry<String,Long> entry : metricThresholdValues.entrySet()) {
    Long aggValue=aggValues.get(entry.getKey());
    Long thresholdValue=entry.getValue();
    if (aggValue < thresholdValue) {
      return false;
    }
  }
  return true;
}
