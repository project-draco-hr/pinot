{
  DimensionBuffer dimension=new DimensionBuffer(numDimensions);
  for (int i=0; i < dimensionNames.size(); i++) {
    String dimName=dimensionNames.get(i);
    Map<Object,Integer> dictionary=dictionaryMap.get(dimName);
    Object dimValue=row.getValue(dimName);
    if (dimValue == null) {
      dimValue=dimensionNameToStarValueMap.get(dimName);
    }
    if (!dictionary.containsKey(dimValue)) {
      dictionary.put(dimValue,dictionary.size());
    }
    dimension.setDimension(i,dictionary.get(dimValue));
  }
  Number[] numbers=new Number[numMetrics];
  for (int i=0; i < numMetrics; i++) {
    String metName=metricNames.get(i);
    numbers[i]=(Number)row.getValue(metName);
  }
  MetricBuffer metrics=new MetricBuffer(numbers);
  append(dimension,metrics);
}
