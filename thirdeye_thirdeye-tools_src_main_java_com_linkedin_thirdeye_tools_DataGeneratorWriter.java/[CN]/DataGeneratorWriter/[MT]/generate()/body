{
  Schema schemaJson=Schema.parse(config.schemaFile);
  final GenericDatumWriter<GenericData.Record> datum=new GenericDatumWriter<GenericData.Record>(schemaJson);
  DataFileWriter<GenericData.Record> recordWriter=new DataFileWriter<GenericData.Record>(datum);
  Map<String,Double> minMap=new HashMap<String,Double>();
  Map<String,Double> maxMap=new HashMap<String,Double>();
  for (  DimensionSpec dimension : config.starTreeConfig.getDimensions()) {
    minMap.put(dimension.getName(),(double)0);
    maxMap.put(dimension.getName(),(double)(dimensionValues.get(dimension.getName()).size() - 1));
  }
  int recordNo=0;
  int fileNo=0;
  for (long time=config.startTime; time <= config.endTime; time++) {
    for (long record=0; record < config.numRecordsPerTimeUnit; record++) {
      if (recordNo % config.numRecordsPerFile == 0) {
        File avroFile=new File(PATH_JOINER.join(config.outputDataDirectory,"part-" + fileNo + ".avro"));
        if (avroFile.exists())         avroFile.delete();
        if (fileNo > 0)         recordWriter.close();
        recordWriter.create(schemaJson,avroFile);
        fileNo++;
      }
      recordNo++;
      GenericData.Record outRecord=new GenericData.Record(schemaJson);
      outRecord.put(config.starTreeConfig.getTime().getColumnName(),time);
      Random rand=new Random();
      for (      DimensionSpec dimensionSpec : config.starTreeConfig.getDimensions()) {
        String dimension=dimensionSpec.getName();
        int cardinality=dimensionValues.get(dimension).size();
        double mean=(cardinality) / 2;
        double variance=cardinality / 2;
        double gaussianPick=mean + rand.nextGaussian() * variance;
        if (gaussianPick < minMap.get(dimension))         minMap.put(dimension,gaussianPick);
 else         if (gaussianPick > maxMap.get(dimension))         maxMap.put(dimension,gaussianPick);
        int normalizedValue=(int)((cardinality - 1) / (maxMap.get(dimension) - minMap.get(dimension)) * (gaussianPick - maxMap.get(dimension)) + (cardinality - 1));
        outRecord.put(dimension,dimensionValues.get(dimension).get(normalizedValue));
      }
      for (      MetricSpec metricSpec : config.starTreeConfig.getMetrics()) {
        String metric=metricSpec.getName();
        long metricValue=rand.nextInt(100);
        outRecord.put(metric,metricValue);
      }
      recordWriter.append(outRecord);
    }
  }
  recordWriter.close();
}
