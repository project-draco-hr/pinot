{
  final List<BAggregationFunctionOperator> aggregationFunctionOperatorList=new ArrayList<BAggregationFunctionOperator>();
  final BReusableFilteredDocIdSetOperator docIdSetOperator=new BReusableFilteredDocIdSetOperator(null,_indexSegment.getSegmentMetadata().getTotalDocs(),5000);
  final Map<String,DataSource> dataSourceMap=getDataSourceMap();
  final MProjectionOperator projectionOperator=new MProjectionOperator(dataSourceMap,docIdSetOperator);
  for (int i=0; i < _numAggregations; ++i) {
    final BAggregationFunctionOperator aggregationFunctionOperator=new BAggregationFunctionOperator(_aggregationInfos.get(i),new UReplicatedProjectionOperator(projectionOperator));
    aggregationFunctionOperatorList.add(aggregationFunctionOperator);
  }
  final MAggregationOperator aggregationOperator=new MAggregationOperator(_indexSegment,_aggregationInfos,projectionOperator,aggregationFunctionOperatorList);
  final IntermediateResultsBlock block=(IntermediateResultsBlock)aggregationOperator.nextBlock();
  for (int i=0; i < _numAggregations; ++i) {
    System.out.println(block.getAggregationResult().get(i));
  }
}
