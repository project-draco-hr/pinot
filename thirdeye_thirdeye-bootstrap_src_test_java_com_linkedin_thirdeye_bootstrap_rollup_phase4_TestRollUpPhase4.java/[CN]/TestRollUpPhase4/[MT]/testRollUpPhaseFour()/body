{
  List<Pair<BytesWritable,List<BytesWritable>>> inputRecordsReducer=generateTestReducerData();
  reduceDriver.addAll(inputRecordsReducer);
  List<Pair<BytesWritable,BytesWritable>> result=reduceDriver.run();
  Assert.assertEquals(1,result.size());
  String[] combination={"?","?","C1"};
  DimensionKey expectedKey=new DimensionKey(combination);
  DimensionKey outputKey=DimensionKey.fromBytes(result.get(0).getFirst().getBytes());
  Assert.assertEquals(outputKey,expectedKey);
  MetricTimeSeries outputValue=MetricTimeSeries.fromBytes(result.get(0).getSecond().getBytes(),TestHelper.getMetricSchema(rollUpConfig));
  MetricTimeSeries expectedValue=TestHelper.generateMetricTimeSeries(rollUpConfig,30);
  Assert.assertEquals(expectedValue,outputValue);
}
