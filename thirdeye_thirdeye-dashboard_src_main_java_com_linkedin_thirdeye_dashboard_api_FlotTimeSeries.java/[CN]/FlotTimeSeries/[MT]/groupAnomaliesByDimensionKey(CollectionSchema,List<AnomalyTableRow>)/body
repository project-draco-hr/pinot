{
  Multimap<DimensionKey,AnomalyTableRow> anomaliesByDimensionKey=ArrayListMultimap.create();
  for (  AnomalyTableRow anomaly : anomalies) {
    String[] dimensionValues=new String[schema.getDimensions().size()];
    int dimensionIndex=0;
    for (    String dimension : schema.getDimensions()) {
      dimensionValues[dimensionIndex]=anomaly.getDimensions().get(dimension);
      dimensionIndex++;
    }
    DimensionKey dimensionKey=new DimensionKey(dimensionValues);
    anomaliesByDimensionKey.put(dimensionKey,anomaly);
  }
  return anomaliesByDimensionKey;
}
