{
  if (segmentMetadata == null || segmentMetadata.getResourceName() == null) {
    throw new RuntimeException("Error: adding invalid SegmentMetadata!");
  }
  LOGGER.info("Trying to add segment with name: " + segmentMetadata.getName());
  LOGGER.debug("Trying to add segment with Metadata: " + segmentMetadata.toString());
  String resourceName=segmentMetadata.getResourceName();
  if (!_resourceDataManagerMap.containsKey(resourceName)) {
    LOGGER.info("Trying to add ResourceDataManager for resource name: " + resourceName);
    addResourceIfNeed(resourceName);
  }
  _resourceDataManagerMap.get(resourceName).addSegment(segmentMetadata);
  LOGGER.info("Successfuly added a segment : " + segmentMetadata.getName() + " in HelixInstanceDataManager");
}
