{
  if (args.length != 2) {
    LOGGER.error("Incorrect arguments");
    LOGGER.info("Usage: <exec> <UntarredSegmentDir> <QueryFile");
    System.exit(1);
  }
  String segDir=args[0];
  String queryFile=args[1];
  String query;
  ScanBasedQueryProcessor scanBasedQueryProcessor=new ScanBasedQueryProcessor(segDir);
  BufferedReader bufferedReader=new BufferedReader(new FileReader(queryFile));
  while ((query=bufferedReader.readLine()) != null) {
    LOGGER.info("Processing Query: {}",query);
    ResultTable resultTable=scanBasedQueryProcessor.processQuery(query);
    if (resultTable != null) {
      resultTable.print();
    }
  }
  bufferedReader.close();
}
