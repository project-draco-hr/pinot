{
  _groupByColumns=groupByColumns;
  _numGroupByColumns=groupByColumns.length;
  _singleBlockValSets=new BlockValSet[_numGroupByColumns];
  _singleDictIds=new int[_numGroupByColumns][];
  _multiValIterators=new BlockMultiValIterator[_numGroupByColumns];
  _dictionaries=new Dictionary[_numGroupByColumns];
  _cardinalities=new int[_numGroupByColumns];
  _isSingleValueGroupByColumn=new boolean[_numGroupByColumns];
  int maxNumMultiValues=0;
  for (int i=0; i < _numGroupByColumns; i++) {
    DataSource dataSource=indexSegment.getDataSource(_groupByColumns[i]);
    _dictionaries[i]=dataSource.getDictionary();
    _cardinalities[i]=dataSource.getDataSourceMetadata().cardinality();
    _isSingleValueGroupByColumn[i]=dataSource.getDataSourceMetadata().isSingleValue();
    Block block=dataSource.nextBlock();
    if (_isSingleValueGroupByColumn[i]) {
      BlockValSet blockValSet=block.getBlockValueSet();
      _singleBlockValSets[i]=blockValSet;
      _singleDictIds[i]=new int[DocIdSetPlanNode.MAX_DOC_PER_CALL];
    }
 else {
      maxNumMultiValues=Math.max(maxNumMultiValues,block.getMetadata().getMaxNumberOfMultiValues());
      _multiValIterators[i]=(BlockMultiValIterator)block.getBlockValueSet().iterator();
    }
  }
  _reusableMultiValDictIdArray=new int[maxNumMultiValues];
  _numUniqueGroupKeys=0;
  if (maxNumGroupKeys <= ResultHolderFactory.MAX_INITIAL_RESULT_HOLDER_CAPACITY) {
    _storageType=STORAGE_TYPE.ARRAY_BASED;
    _uniqueGroupKeysFlag=new boolean[maxNumGroupKeys];
  }
 else {
    _storageType=STORAGE_TYPE.MAP_BASED;
    _groupKeyToId=new Long2IntOpenHashMap();
    _groupKeyToId.defaultReturnValue(INVALID_ID);
  }
  _reusableGroupByValuesArray=new int[_numGroupByColumns];
}
