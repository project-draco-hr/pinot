{
  final List<FilterQueryTree> childFilters=filterQueryTree.getChildren();
  final boolean isLeaf=(childFilters == null) || childFilters.isEmpty();
  if (isLeaf) {
    FilterOperator filterType=filterQueryTree.getOperator();
    String column=filterQueryTree.getColumn();
    final List<String> value=filterQueryTree.getValue();
    return getMatchingDocIds(indexSegment,metadata,filterType,column,value);
  }
  List<Integer> result=doFilter(childFilters.get(0),indexSegment,metadata);
  for (int i=1; i < childFilters.size(); ++i) {
    result=combine(result,doFilter(childFilters.get(i),indexSegment,metadata),filterQueryTree.getOperator());
  }
  return result;
}
