{
  if (metricNames == null || metricNames.isEmpty()) {
    throw new IllegalArgumentException("Must provide metric names");
  }
  if (dimensionNames == null || dimensionNames.isEmpty()) {
    throw new IllegalArgumentException("Must provide dimension names");
  }
  StarTreeRecordThresholdFunction tF=null;
  if (thresholdFunctionClass != null) {
    tF=(StarTreeRecordThresholdFunction)Class.forName(thresholdFunctionClass).newInstance();
    tF.init(thresholdFunctionConfig);
  }
  StarTreeRecordStoreFactory rF=(StarTreeRecordStoreFactory)Class.forName(recordStoreFactoryClass).newInstance();
  rF.init(dimensionNames,metricNames,recordStoreFactoryConfig);
  return new StarTreeConfig(rF,tF,maxRecordStoreEntries,dimensionNames,metricNames,timeColumnName);
}
