{
  if (collection == null) {
    throw new IllegalArgumentException("Must provide collection");
  }
  if (metricNames == null || metricNames.isEmpty()) {
    throw new IllegalArgumentException("Must provide metric names");
  }
  if (dimensionNames == null || dimensionNames.isEmpty()) {
    throw new IllegalArgumentException("Must provide dimension names");
  }
  if (metricTypes == null || metricTypes.isEmpty()) {
    throw new IllegalArgumentException("Must provide metric types");
  }
  return new StarTreeConfig(collection,recordStoreFactoryClass,recordStoreFactoryConfig,maxRecordStoreEntries,dimensionNames,metricNames,metricTypes,splitOrder,timeColumnName,timeBucketSize,timeBucketSizeUnit);
}
