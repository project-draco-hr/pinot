{
  StarTreeRecordImpl.Builder builder=new StarTreeRecordImpl.Builder();
  for (  String dimensionName : config.getDimensionNames()) {
    Object dimensionValue=record.get(dimensionName);
    if (dimensionValue == null) {
      throw new IllegalStateException("Record has no value for dimension " + dimensionName);
    }
    builder.setDimensionValue(dimensionName,dimensionValue.toString());
  }
  for (  String metricName : config.getMetricNames()) {
    Object metricValue=record.get(metricName);
    if (metricValue == null) {
      metricValue=0L;
    }
    builder.setMetricValue(metricName,((Number)metricValue).longValue());
  }
  Object time=record.get(config.getTimeColumnName());
  if (time == null) {
    throw new IllegalStateException("Record does not have time column " + config.getTimeColumnName() + ": "+ record);
  }
  builder.setTime(((Number)time).longValue());
  return builder.build();
}
