{
  Job job=Job.getInstance(getConf());
  job.setJobName(name);
  job.setJarByClass(TopKRollupPhaseThreeJob.class);
  job.setMapperClass(TopKRollupPhaseThreeMapper.class);
  job.setInputFormatClass(SequenceFileInputFormat.class);
  job.setMapOutputKeyClass(BytesWritable.class);
  job.setMapOutputValueClass(BytesWritable.class);
  job.setReducerClass(TopKRollupPhaseThreeReducer.class);
  job.setOutputKeyClass(BytesWritable.class);
  job.setOutputValueClass(BytesWritable.class);
  job.setOutputFormatClass(SequenceFileOutputFormat.class);
  String numReducers=props.getProperty("num.reducers");
  if (numReducers != null) {
    job.setNumReduceTasks(Integer.parseInt(numReducers));
  }
 else {
    job.setNumReduceTasks(10);
  }
  LOGGER.info("Setting number of reducers : " + job.getNumReduceTasks());
  Configuration configuration=job.getConfiguration();
  FileSystem fs=FileSystem.get(configuration);
  String inputPathDir=getAndSetConfiguration(configuration,TOPK_ROLLUP_PHASE3_INPUT_PATH);
  getAndSetConfiguration(configuration,TOPK_ROLLUP_PHASE3_CONFIG_PATH);
  Path outputPath=new Path(getAndSetConfiguration(configuration,TOPK_ROLLUP_PHASE3_OUTPUT_PATH));
  getAndSetConfiguration(configuration,TOPK_DIMENSIONS_PATH);
  LOGGER.info("Input path dir: " + inputPathDir);
  for (  String inputPath : inputPathDir.split(",")) {
    LOGGER.info("Adding input:" + inputPath);
    Path input=new Path(inputPath);
    FileInputFormat.addInputPath(job,input);
  }
  if (fs.exists(outputPath)) {
    fs.delete(outputPath,true);
  }
  FileOutputFormat.setOutputPath(job,outputPath);
  job.waitForCompletion(true);
  return job;
}
