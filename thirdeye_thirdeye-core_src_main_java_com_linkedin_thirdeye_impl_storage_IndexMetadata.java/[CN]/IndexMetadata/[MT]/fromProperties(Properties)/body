{
  IndexMetadata indexMetadata=new IndexMetadata();
  String minDataTime=properties.getProperty(StarTreeMetadataProperties.MIN_DATA_TIME);
  String maxDataTime=properties.getProperty(StarTreeMetadataProperties.MAX_DATA_TIME);
  String startTime=properties.getProperty(StarTreeMetadataProperties.START_TIME);
  String endTime=properties.getProperty(StarTreeMetadataProperties.END_TIME);
  String timeGranularity=properties.getProperty(StarTreeMetadataProperties.TIME_GRANULARITY);
  if (minDataTime == null || maxDataTime == null || startTime == null || endTime == null || timeGranularity == null) {
    throw new IllegalStateException("Cannot find required metadata properties");
  }
  indexMetadata.setMinDataTime(Long.valueOf(minDataTime));
  indexMetadata.setMaxDataTime(Long.valueOf(maxDataTime));
  indexMetadata.setStartTime(Long.valueOf(startTime));
  indexMetadata.setEndTime(Long.valueOf(endTime));
  indexMetadata.setTimeGranularity(timeGranularity);
  return indexMetadata;
}
