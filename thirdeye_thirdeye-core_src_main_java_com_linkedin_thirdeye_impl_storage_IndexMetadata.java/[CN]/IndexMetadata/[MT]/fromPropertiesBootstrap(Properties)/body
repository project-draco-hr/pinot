{
  IndexMetadata indexMetadata=new IndexMetadata();
  String minDataTime=properties.getProperty(StarTreeMetadataProperties.MIN_DATA_TIME);
  String maxDataTime=properties.getProperty(StarTreeMetadataProperties.MAX_DATA_TIME);
  String minDataTimeMillis=properties.getProperty(StarTreeMetadataProperties.MIN_DATA_TIME_MILLIS);
  String maxDataTimeMillis=properties.getProperty(StarTreeMetadataProperties.MAX_DATA_TIME_MILLIS);
  String aggregationGranularity=properties.getProperty(StarTreeMetadataProperties.AGGREGATION_GRANULARITY);
  String bucketSize=properties.getProperty(StarTreeMetadataProperties.BUCKET_SIZE);
  if (minDataTime == null || maxDataTime == null || minDataTimeMillis == null || maxDataTimeMillis == null || aggregationGranularity == null || bucketSize == null) {
    throw new IllegalStateException("Cannot find required metadata properties");
  }
  indexMetadata.setMinDataTime(Long.valueOf(minDataTime));
  indexMetadata.setMaxDataTime(Long.valueOf(maxDataTime));
  indexMetadata.setMinDataTimeMillis(Long.valueOf(minDataTimeMillis));
  indexMetadata.setMaxDataTimeMillis(Long.valueOf(maxDataTimeMillis));
  indexMetadata.setAggregationGranularity(aggregationGranularity);
  indexMetadata.setBucketSize(Integer.valueOf(bucketSize));
  return indexMetadata;
}
