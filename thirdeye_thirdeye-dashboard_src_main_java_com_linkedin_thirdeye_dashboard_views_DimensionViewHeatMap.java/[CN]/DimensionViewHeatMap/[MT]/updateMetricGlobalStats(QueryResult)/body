{
  Map<String,Number[]> totalForMetric=resultForTotal.getData().values().iterator().next();
  String minTimestamp=String.valueOf(baseline.getMillis());
  String maxTimestamp=String.valueOf(current.getMillis());
  List<String> metrics=resultForTotal.getMetrics();
  for (int i=0; i < metrics.size(); i++) {
    Map<String,Number> map=new HashMap<String,Number>();
    String metric=metrics.get(i);
    double baselineTotal=totalForMetric.get(minTimestamp)[i].doubleValue();
    double currentTotal=totalForMetric.get(maxTimestamp)[i].doubleValue();
    map.put(Stat.BASELINE_TOTAL.toString(),baselineTotal);
    map.put(Stat.CURRENT_TOTAL.toString(),currentTotal);
    double delta=currentTotal - baselineTotal;
    map.put(Stat.DELTA_ABSOLUTE_CHANGE.toString(),delta);
    if (baselineTotal > 0) {
      map.put(Stat.DELTA_PERCENT_CHANGE.toString(),(delta / baselineTotal) * 100.0);
    }
    metricGlobalStats.put(metric,map);
  }
  return metricGlobalStats;
}
