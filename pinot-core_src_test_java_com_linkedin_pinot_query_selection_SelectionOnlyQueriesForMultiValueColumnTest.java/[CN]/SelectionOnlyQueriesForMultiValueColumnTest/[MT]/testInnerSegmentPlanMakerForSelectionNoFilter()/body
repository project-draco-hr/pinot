{
  setupSegment();
  final BrokerRequest brokerRequest=getSelectionNoFilterBrokerRequest();
  final PlanMaker instancePlanMaker=new InstancePlanMakerImplV0();
  final PlanNode rootPlanNode=instancePlanMaker.makeInnerSegmentPlan(_indexSegment,brokerRequest);
  rootPlanNode.showTree("");
  final MSelectionOnlyOperator operator=(MSelectionOnlyOperator)rootPlanNode.run();
  final IntermediateResultsBlock resultBlock=(IntermediateResultsBlock)operator.nextBlock();
  System.out.println("RunningTime : " + resultBlock.getTimeUsedMs());
  System.out.println("NumDocsScanned : " + resultBlock.getNumDocsScanned());
  System.out.println("TotalDocs : " + resultBlock.getTotalRawDocs());
  final Map<ServerInstance,DataTable> instanceResponseMap=new HashMap<ServerInstance,DataTable>();
  instanceResponseMap.put(new ServerInstance("localhost:0000"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:1111"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:2222"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:3333"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:4444"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:5555"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:6666"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:7777"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:8888"),resultBlock.getDataTable());
  instanceResponseMap.put(new ServerInstance("localhost:9999"),resultBlock.getDataTable());
  final Collection<Serializable[]> reducedResults=SelectionOperatorUtils.reduce(instanceResponseMap,brokerRequest.getSelections().getSize());
  List<String> selectionColumns=SelectionOperatorUtils.getSelectionColumns(brokerRequest.getSelections().getSelectionColumns(),_indexSegment);
  DataSchema dataSchema=resultBlock.getSelectionDataSchema();
  final JSONObject jsonResult=SelectionOperatorUtils.render(reducedResults,selectionColumns,dataSchema);
  System.out.println(jsonResult);
  JsonAssert.assertEqualsIgnoreOrder(jsonResult.toString(),"{\"columns\":[\"column1\",\"column2\",\"column5\",\"column6\",\"column7\",\"count\"]," + "\"results\":[[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"]," + "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"890282370\",\"890662862\",\"AKXcXcIqsqOJFsdwxZ\",[\"2147483647\"],[\"2147483647\"],\"890662862\"],"+ "[\"972569181\",\"1458119540\",\"EOFxevm\",[\"593959\"],[\"225\"],\"890662862\"]]}");
}
