{
  JSONObject payload=ControllerRequestBuilderUtil.buildCreateOfflineResourceJSON(resourceName,instanceCount,replicaCount);
  if (timeColumnName != null && timeColumnType != null) {
    payload=payload.put(DataSource.TIME_COLUMN_NAME,timeColumnName).put(DataSource.TIME_TYPE,timeColumnType);
  }
  payload.put(DataSource.NUMBER_OF_BROKER_INSTANCES,Integer.toString(brokerCount));
  if (retentionTimeUnit != null) {
    payload.put(DataSource.RETENTION_TIME_UNIT,retentionTimeUnit);
    payload.put(DataSource.RETENTION_TIME_VALUE,retentionTimeValue);
  }
  String res=sendPostRequest(ControllerRequestURLBuilder.baseUrl(CONTROLLER_BASE_API_URL).forResourceCreate(),payload.toString().replaceAll("}$",", \"metadata\":{}}"));
  Assert.assertEquals(_success,new JSONObject(res).getString("status"));
}
