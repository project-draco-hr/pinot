{
  File collectionDir=new File(rootDir,collection);
  if (!collectionDir.exists()) {
    throw new NotFoundException("No collection " + collection);
  }
  StarTreeConfig config=manager.getConfig(collection);
  if (config == null) {
    throw new NotFoundException("No config for " + collection);
  }
  File[] dataDirs=collectionDir.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      return name.startsWith(StorageUtils.getDataDirPrefix());
    }
  }
);
  List<SegmentDescriptor> descriptors=new ArrayList<>();
  if (dataDirs != null) {
    for (    File dataDir : dataDirs) {
      File metadataFile=new File(dataDir,StarTreeConstants.METADATA_FILE_NAME);
      Properties properties=new Properties();
      InputStream inputStream=new FileInputStream(metadataFile);
      try {
        properties.load(inputStream);
      }
  finally {
        inputStream.close();
      }
      IndexMetadata indexMetadata=IndexMetadata.fromProperties(properties);
      DateTime startWallTime=new DateTime(indexMetadata.getStartTime());
      DateTime endWallTime=new DateTime(indexMetadata.getEndTime());
      descriptors.add(new SegmentDescriptor(dataDir,startWallTime,endWallTime,new DateTime(indexMetadata.getMinDataTime()),new DateTime(indexMetadata.getMaxDataTime())));
    }
  }
  return descriptors;
}
