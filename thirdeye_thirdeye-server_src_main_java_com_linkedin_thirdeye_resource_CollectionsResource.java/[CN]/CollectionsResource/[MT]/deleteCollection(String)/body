{
  StarTree starTree=manager.getStarTree(collection);
  if (starTree == null) {
    throw new NotFoundException("No tree for collection " + collection);
  }
  manager.remove(collection);
  File collectionDir=new File(rootDir,collection);
  if (!collectionDir.isAbsolute()) {
    throw new WebApplicationException(Response.Status.BAD_REQUEST);
  }
  try {
    FileUtils.forceDelete(collectionDir);
  }
 catch (  FileNotFoundException fe) {
    ResponseBuilderImpl builder=new ResponseBuilderImpl();
    builder.status(Response.Status.NOT_FOUND);
    builder.entity("Collection " + collection + " not found");
    throw new WebApplicationException(builder.build());
  }
  return Response.noContent().build();
}
