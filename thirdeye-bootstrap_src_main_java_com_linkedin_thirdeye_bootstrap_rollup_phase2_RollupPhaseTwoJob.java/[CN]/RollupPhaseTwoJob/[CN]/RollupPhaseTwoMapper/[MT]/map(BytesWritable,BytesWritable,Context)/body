{
  DimensionKey rawDimensionKey;
  rawDimensionKey=DimensionKey.fromBytes(dimensionKeyWritable.getBytes());
  MetricTimeSeries timeSeries;
  byte[] bytes=metricTimeSeriesWritable.getBytes();
  timeSeries=MetricTimeSeries.fromBytes(bytes,metricSchema);
  RollupPhaseTwoMapOutput wrapper;
  wrapper=new RollupPhaseTwoMapOutput(rawDimensionKey,timeSeries);
  BytesWritable wrapperBytesWritable=new BytesWritable(wrapper.toBytes());
  LOG.info("Map.key {}",rawDimensionKey);
  List<DimensionKey> combinations=generateCombinations(rawDimensionKey);
  LOG.info("combinations:{}",combinations);
  BytesWritable combinationBytesWritable;
  combinationBytesWritable=new BytesWritable();
  for (  DimensionKey combination : combinations) {
    byte[] combinationBytes=combination.toBytes();
    combinationBytesWritable.set(combinationBytes,0,combinationBytes.length);
    LOG.info("Map.combination:{}",combination);
    LOG.info("Map.raw Dimension:{}",wrapper.dimensionKey);
    context.write(combinationBytesWritable,wrapperBytesWritable);
  }
}
