{
  DimensionKey rawDimensionKey;
  rawDimensionKey=DimensionKey.fromBytes(dimensionKeyWritable.getBytes());
  MetricTimeSeries rawTimeSeries;
  byte[] bytes=metricTimeSeriesWritable.getBytes();
  rawTimeSeries=MetricTimeSeries.fromBytes(bytes,metricSchema);
  List<DimensionKey> combinations=generateCombinations(rawDimensionKey);
  for (  DimensionKey combination : combinations) {
    byte[] md5=combination.toMD5();
    keyWritable.set(md5,0,md5.length);
    RollupPhaseTwoMapOutput wrapper;
    wrapper=new RollupPhaseTwoMapOutput(combination,rawDimensionKey,rawTimeSeries);
    byte[] valBytes=wrapper.toBytes();
    valWritable.set(valBytes,0,valBytes.length);
    context.write(keyWritable,valWritable);
  }
}
