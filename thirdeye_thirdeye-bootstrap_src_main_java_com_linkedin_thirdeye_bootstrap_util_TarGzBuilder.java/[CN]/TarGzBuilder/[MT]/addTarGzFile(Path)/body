{
  TarArchiveInputStream debInputStream=null;
  InputStream is=null;
  TarArchiveEntry tarEntry;
  try {
    is=new GzipCompressorInputStream(inputFS.open(path));
    debInputStream=(TarArchiveInputStream)new ArchiveStreamFactory().createArchiveInputStream("tar",is);
    TarArchiveEntry entry=null;
    while ((entry=(TarArchiveEntry)debInputStream.getNextEntry()) != null) {
      if (entries.contains(entry.getName())) {
        LOG.info("Skipping entry:{} since it was already added",entry.getName());
        continue;
      }
      if (entry.getName().equals(StarTreeConstants.METADATA_FILE_NAME)) {
        continue;
      }
      LOG.info("Adding entry:" + entry.getName());
      if (entry.isDirectory()) {
        tarEntry=new TarArchiveEntry(entry.getName());
        tOut.setLongFileMode(TarArchiveOutputStream.LONGFILE_GNU);
        tOut.putArchiveEntry(tarEntry);
        tOut.closeArchiveEntry();
      }
 else {
        tOut.putArchiveEntry(entry);
        IOUtils.copy(debInputStream,tOut);
        tOut.closeArchiveEntry();
      }
      entries.add(entry.getName());
    }
  }
 catch (  Exception e) {
    throw e;
  }
 finally {
    IOUtils.closeQuietly(debInputStream);
    IOUtils.closeQuietly(is);
  }
}
