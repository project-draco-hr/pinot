{
  DateTime baseline=new DateTime(baselineMillis);
  DateTime current=new DateTime(currentMillis);
  Map<String,String> dimensionValues=UriUtils.extractDimensionValues(uriInfo.getQueryParameters());
  CollectionSchema schema=dataCache.getCollectionSchema(serverUri,collection);
  String sql=SqlUtils.getSql(metricFunction,collection,baseline,current,dimensionValues);
  QueryResult queryResult=queryCache.getQueryResult(serverUri,sql).checkEmpty();
  return FlotTimeSeries.fromQueryResult(schema,objectMapper,queryResult);
}
