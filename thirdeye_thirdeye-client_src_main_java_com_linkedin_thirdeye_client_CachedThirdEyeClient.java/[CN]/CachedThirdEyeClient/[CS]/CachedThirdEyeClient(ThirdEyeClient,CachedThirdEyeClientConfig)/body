{
  LOG.info("Initializing cache client for {} with config {}, using client",client,config);
  this.client=client;
  if (config != null) {
    config=new CachedThirdEyeClientConfig();
  }
  this.config=config;
  CacheBuilder builder=CacheBuilder.newBuilder();
  if (config.isExpireAfterAccess()) {
    builder.expireAfterAccess(config.getExpirationTime(),config.getExpirationUnit());
  }
 else {
    builder.expireAfterWrite(config.getExpirationTime(),config.getExpirationUnit());
  }
  this.resultCache=builder.build(new ResultCacheLoader());
  this.rawResultCache=builder.build(new RawResultCacheLoader());
  this.starTreeConfigCache=CacheBuilder.newBuilder().expireAfterWrite(DEFAULT_CACHE_DURATION,TimeUnit.SECONDS).build(new StarTreeConfigCacheLoader());
  CacheBuilder<Object,Object> readCacheBuilder=CacheBuilder.newBuilder().expireAfterAccess(DEFAULT_CACHE_DURATION,TimeUnit.MINUTES);
  this.segmentDescriptorCache=readCacheBuilder.build(new SegmentDescriptorCacheLoader());
  this.expectedTimeBucketCache=readCacheBuilder.build(new ExpectedTimeBucketsCacheLoader());
  this.expectedTimestampsCache=readCacheBuilder.build(new ExpectedTimestampsCacheLoader());
  this.collectionsSupplier=buildCollectionsSupplier();
}
