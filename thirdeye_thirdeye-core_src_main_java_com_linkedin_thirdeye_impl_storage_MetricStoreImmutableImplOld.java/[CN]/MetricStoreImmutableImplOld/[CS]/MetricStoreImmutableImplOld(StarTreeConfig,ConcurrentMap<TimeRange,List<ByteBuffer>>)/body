{
  this.config=config;
  this.buffers=buffers;
  this.metricSchema=MetricSchema.fromMetricSpecs(config.getMetrics());
  this.minTime=new AtomicReference<TimeRange>(EMPTY_TIME_RANGE);
  this.maxTime=new AtomicReference<TimeRange>(EMPTY_TIME_RANGE);
  this.timeRangeCount=new ConcurrentHashMap<>();
  if (!buffers.isEmpty()) {
    minTime.set(Collections.min(buffers.keySet()));
    maxTime.set(Collections.max(buffers.keySet()));
  }
}
